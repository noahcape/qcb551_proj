bow_functional
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0101
NMI = 0.0589
Jaccard macro (true → best cluster) = 0.1299
Jaccard macro (cluster → best true) = 0.0545
Jaccard macro (Hungarian-aligned pairs) = 0.0487
Mapping-based clustering accuracy = 0.1757

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.500   0.005 0.010      200
Endoplasmic reticulum      1.000   0.005 0.010      200
Extracellular              0.366   0.445 0.402      200
Golgi apparatus            0.500   0.008 0.016      126
Lysosome/Vacuole           1.000   0.005 0.010      200
Mitochondrion              0.250   0.005 0.010      200
Nucleus                    0.148   0.020 0.035      200
Peroxisome                 0.000   0.000 0.000      159
Plastid                    0.141   0.990 0.247      200

Contingency table (true x pred):
pred                   0   1   2  3  4  5  6    7  8
true                                                
Cytoplasm              1   3  29  1  0  0  0  166  0
Endoplasmic reticulum  1   0  20  0  1  0  0  177  1
Extracellular          1  14  89  0  0  0  1   95  0
Golgi apparatus        0   0  13  0  0  0  0  112  1
Lysosome/Vacuole       0   1  21  0  0  1  0  177  0
Mitochondrion          1   3  28  0  0  0  0  168  0
Nucleus                0   4  36  1  0  0  1  158  0
Peroxisome             0   2   5  0  0  0  0  152  0
Plastid                0   0   2  0  0  0  0  198  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      1                      0  ...           0      166
Endoplasmic reticulum          0                      1  ...           0      177
Extracellular                  0                      0  ...           1       95
Golgi apparatus                0                      0  ...           0      112
Lysosome/Vacuole               0                      0  ...           0      177
Mitochondrion                  0                      0  ...           0      168
Nucleus                        1                      0  ...           1      158
Peroxisome                     0                      0  ...           0      152
Plastid                        0                      0  ...           0      198

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              7  0.115518
Endoplasmic reticulum                  7  0.124123
Extracellular                          2  0.251412
Golgi apparatus                        7  0.079040
Lysosome/Vacuole                       7  0.124123
Mitochondrion                          7  0.117073
Nucleus                                7  0.109343
Peroxisome                             7  0.107801
Plastid                                7  0.140925

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0              Cytoplasm  0.004926
1          Extracellular  0.065728
2          Extracellular  0.251412
3              Cytoplasm  0.004975
4  Endoplasmic reticulum  0.005000
5       Lysosome/Vacuole  0.005000
6          Extracellular  0.004975
7                Plastid  0.140925
8        Golgi apparatus  0.007874

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.004975
4             Endoplasmic reticulum  0.005000
2                     Extracellular  0.251412
8                   Golgi apparatus  0.007874
5                  Lysosome/Vacuole  0.005000
0                     Mitochondrion  0.004926
1                           Nucleus  0.017937
6                        Peroxisome  0.000000
7                           Plastid  0.140925
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
bow_functional
Similarity.Cosine_Clustering.Kmeans
ARI = 0.0254
NMI = 0.0575
Jaccard macro (true → best cluster) = 0.1231
Jaccard macro (cluster → best true) = 0.0841
Jaccard macro (Hungarian-aligned pairs) = 0.0798
Mapping-based clustering accuracy = 0.1958

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.190   0.175 0.182      200
Endoplasmic reticulum      0.241   0.035 0.061      200
Extracellular              0.251   0.630 0.359      200
Golgi apparatus            0.600   0.024 0.046      126
Lysosome/Vacuole           0.167   0.005 0.010      200
Mitochondrion              0.067   0.005 0.009      200
Nucleus                    0.344   0.110 0.167      200
Peroxisome                 0.150   0.346 0.210      159
Plastid                    0.155   0.400 0.224      200

Contingency table (true x pred):
pred                     0   1  2   3  4  5   6  7   8
true                                                  
Cytoplasm               44  35  4  52  1  1  39  6  18
Endoplasmic reticulum   53  22  0  63  0  0  53  7   2
Extracellular          126   3  4  47  0  1  16  1   2
Golgi apparatus         25  33  3  22  3  1  30  3   6
Lysosome/Vacuole        52  26  1  58  1  1  44  6  11
Mitochondrion           84  11  1  65  0  0  36  2   1
Nucleus                 41  33  1  55  0  1  44  3  22
Peroxisome              24   5  0  73  0  1  55  1   0
Plastid                 52  16  1  80  0  0  49  0   2

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     35                      6  ...          39       52
Endoplasmic reticulum         22                      7  ...          53       63
Extracellular                  3                      1  ...          16       47
Golgi apparatus               33                      3  ...          30       22
Lysosome/Vacuole              26                      6  ...          44       58
Mitochondrion                 11                      2  ...          36       65
Nucleus                       33                      3  ...          44       55
Peroxisome                     5                      1  ...          55       73
Plastid                       16                      0  ...          49       80

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.100287
Endoplasmic reticulum                  6  0.103314
Extracellular                          0  0.219130
Golgi apparatus                        1  0.119134
Lysosome/Vacuole                       3  0.088280
Mitochondrion                          0  0.136143
Nucleus                                1  0.094017
Peroxisome                             3  0.121464
Plastid                                3  0.125984

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0          Extracellular  0.219130
1        Golgi apparatus  0.119134
2        Golgi apparatus  0.021739
3                Plastid  0.125984
4        Golgi apparatus  0.023438
5        Golgi apparatus  0.007634
6             Peroxisome  0.117021
7  Endoplasmic reticulum  0.031532
8                Nucleus  0.090909

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.100287
7             Endoplasmic reticulum  0.031532
0                     Extracellular  0.219130
4                   Golgi apparatus  0.023438
5                  Lysosome/Vacuole  0.004878
2                     Mitochondrion  0.004673
8                           Nucleus  0.090909
6                        Peroxisome  0.117021
3                           Plastid  0.125984
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
bow_functional
Similarity.Cosine_Clustering.Spectral
ARI = 0.0396
NMI = 0.0846
Jaccard macro (true → best cluster) = 0.1429
Jaccard macro (cluster → best true) = 0.1445
Jaccard macro (Hungarian-aligned pairs) = 0.1414
Mapping-based clustering accuracy = 0.2415

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.215   0.205 0.210      200
Endoplasmic reticulum      0.194   0.300 0.236      200
Extracellular              0.579   0.330 0.420      200
Golgi apparatus            0.126   0.262 0.170      126
Lysosome/Vacuole           0.304   0.170 0.218      200
Mitochondrion              0.196   0.175 0.185      200
Nucleus                    0.289   0.185 0.226      200
Peroxisome                 0.222   0.289 0.251      159
Plastid                    0.301   0.275 0.287      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              28  31  33   5  18   7  21  41  16
Endoplasmic reticulum   8  60  50   9  12   7  19  22  13
Extracellular           9  24  18  20  13  66   6  20  24
Golgi apparatus         9  22  33   4  15   5   7  26   5
Lysosome/Vacuole       15  47  36  34  17   4  16  23   8
Mitochondrion          15  29  34  13   6  13  35  13  42
Nucleus                37  17  20   8  37   8  20  40  13
Peroxisome              5  39  20  14  10   1  23   1  46
Plastid                 2  40  18   5  55   3  32   5  40

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     41                     31  ...          16       18
Endoplasmic reticulum         22                     60  ...          13       12
Extracellular                 20                     24  ...          24       13
Golgi apparatus               26                     22  ...           5       15
Lysosome/Vacuole              23                     47  ...           8       17
Mitochondrion                 13                     29  ...          42        6
Nucleus                       40                     17  ...          13       37
Peroxisome                     1                     39  ...          46       10
Plastid                        5                     40  ...          40       55

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              7  0.117143
Endoplasmic reticulum                  1  0.133630
Extracellular                          5  0.266129
Golgi apparatus                        2  0.092958
Lysosome/Vacuole                       3  0.122302
Mitochondrion                          8  0.115068
Nucleus                                0  0.127148
Peroxisome                             8  0.143750
Plastid                                4  0.167683

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0                Nucleus  0.127148
1  Endoplasmic reticulum  0.133630
2  Endoplasmic reticulum  0.121359
3       Lysosome/Vacuole  0.122302
4                Plastid  0.167683
5          Extracellular  0.266129
6          Mitochondrion  0.101744
7              Cytoplasm  0.117143
8             Peroxisome  0.143750

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
7                         Cytoplasm  0.117143
1             Endoplasmic reticulum  0.133630
5                     Extracellular  0.266129
2                   Golgi apparatus  0.092958
3                  Lysosome/Vacuole  0.122302
6                     Mitochondrion  0.101744
0                           Nucleus  0.127148
8                        Peroxisome  0.143750
4                           Plastid  0.167683
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
bow_functional
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0020
NMI = 0.0352
Jaccard macro (true → best cluster) = 0.1114
Jaccard macro (cluster → best true) = 0.0366
Jaccard macro (Hungarian-aligned pairs) = 0.0341
Mapping-based clustering accuracy = 0.1412

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.319   0.150 0.204      200
Endoplasmic reticulum      0.000   0.000 0.000      200
Extracellular              0.333   0.010 0.019      200
Golgi apparatus            0.231   0.024 0.043      126
Lysosome/Vacuole           0.294   0.025 0.046      200
Mitochondrion              0.000   0.000 0.000      200
Nucleus                    0.500   0.005 0.010      200
Peroxisome                 0.500   0.006 0.012      159
Plastid                    0.127   0.980 0.225      200

Contingency table (true x pred):
pred                     0  1   2  3  4  5  6  7  8
true                                               
Cytoplasm              161  0  30  4  0  2  0  1  2
Endoplasmic reticulum  188  0  11  0  0  1  0  0  0
Extracellular          192  0   2  1  0  1  1  1  2
Golgi apparatus        108  1   8  3  1  2  1  0  2
Lysosome/Vacuole       178  0  14  2  0  5  0  1  0
Mitochondrion          195  0   2  1  0  2  0  0  0
Nucleus                171  0  24  1  1  3  0  0  0
Peroxisome             157  1   0  0  0  1  0  0  0
Plastid                196  0   3  1  0  0  0  0  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     30                      0  ...           0      161
Endoplasmic reticulum         11                      0  ...           0      188
Extracellular                  2                      1  ...           0      192
Golgi apparatus                8                      1  ...           1      108
Lysosome/Vacuole              14                      0  ...           0      178
Mitochondrion                  2                      0  ...           0      195
Nucleus                       24                      0  ...           0      171
Peroxisome                     0                      0  ...           1      157
Plastid                        3                      0  ...           0      196

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.113636
Endoplasmic reticulum                  0  0.120668
Extracellular                          0  0.123552
Golgi apparatus                        0  0.069054
Lysosome/Vacuole                       0  0.113520
Mitochondrion                          0  0.125725
Nucleus                                0  0.108571
Peroxisome                             0  0.101421
Plastid                                0  0.126452

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Plastid  0.126452
1   Golgi apparatus  0.007874
2         Cytoplasm  0.113636
3   Golgi apparatus  0.022059
4   Golgi apparatus  0.007874
5  Lysosome/Vacuole  0.023585
6   Golgi apparatus  0.007874
7         Cytoplasm  0.004950
8   Golgi apparatus  0.015385

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
2                         Cytoplasm  0.113636
6             Endoplasmic reticulum  0.000000
8                     Extracellular  0.009804
3                   Golgi apparatus  0.022059
5                  Lysosome/Vacuole  0.023585
7                     Mitochondrion  0.000000
4                           Nucleus  0.004975
1                        Peroxisome  0.006250
0                           Plastid  0.126452
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
bow_functional
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.0254
NMI = 0.0575
Jaccard macro (true → best cluster) = 0.1231
Jaccard macro (cluster → best true) = 0.0841
Jaccard macro (Hungarian-aligned pairs) = 0.0798
Mapping-based clustering accuracy = 0.1958

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.190   0.175 0.182      200
Endoplasmic reticulum      0.241   0.035 0.061      200
Extracellular              0.251   0.630 0.359      200
Golgi apparatus            0.600   0.024 0.046      126
Lysosome/Vacuole           0.167   0.005 0.010      200
Mitochondrion              0.067   0.005 0.009      200
Nucleus                    0.344   0.110 0.167      200
Peroxisome                 0.150   0.346 0.210      159
Plastid                    0.155   0.400 0.224      200

Contingency table (true x pred):
pred                     0   1  2   3  4  5   6  7   8
true                                                  
Cytoplasm               44  35  4  52  1  1  39  6  18
Endoplasmic reticulum   53  22  0  63  0  0  53  7   2
Extracellular          126   3  4  47  0  1  16  1   2
Golgi apparatus         25  33  3  22  3  1  30  3   6
Lysosome/Vacuole        52  26  1  58  1  1  44  6  11
Mitochondrion           84  11  1  65  0  0  36  2   1
Nucleus                 41  33  1  55  0  1  44  3  22
Peroxisome              24   5  0  73  0  1  55  1   0
Plastid                 52  16  1  80  0  0  49  0   2

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     35                      6  ...          39       52
Endoplasmic reticulum         22                      7  ...          53       63
Extracellular                  3                      1  ...          16       47
Golgi apparatus               33                      3  ...          30       22
Lysosome/Vacuole              26                      6  ...          44       58
Mitochondrion                 11                      2  ...          36       65
Nucleus                       33                      3  ...          44       55
Peroxisome                     5                      1  ...          55       73
Plastid                       16                      0  ...          49       80

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.100287
Endoplasmic reticulum                  6  0.103314
Extracellular                          0  0.219130
Golgi apparatus                        1  0.119134
Lysosome/Vacuole                       3  0.088280
Mitochondrion                          0  0.136143
Nucleus                                1  0.094017
Peroxisome                             3  0.121464
Plastid                                3  0.125984

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0          Extracellular  0.219130
1        Golgi apparatus  0.119134
2        Golgi apparatus  0.021739
3                Plastid  0.125984
4        Golgi apparatus  0.023438
5        Golgi apparatus  0.007634
6             Peroxisome  0.117021
7  Endoplasmic reticulum  0.031532
8                Nucleus  0.090909

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.100287
7             Endoplasmic reticulum  0.031532
0                     Extracellular  0.219130
4                   Golgi apparatus  0.023438
5                  Lysosome/Vacuole  0.004878
2                     Mitochondrion  0.004673
8                           Nucleus  0.090909
6                        Peroxisome  0.117021
3                           Plastid  0.125984
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
bow_functional
Similarity.Euclidean_Clustering.Spectral
ARI = 0.0421
NMI = 0.0804
Jaccard macro (true → best cluster) = 0.1440
Jaccard macro (cluster → best true) = 0.1209
Jaccard macro (Hungarian-aligned pairs) = 0.1147
Mapping-based clustering accuracy = 0.2285

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.233   0.190 0.209      200
Endoplasmic reticulum      0.132   0.035 0.055      200
Extracellular              0.354   0.540 0.428      200
Golgi apparatus            0.175   0.167 0.171      126
Lysosome/Vacuole           0.148   0.095 0.116      200
Mitochondrion              0.000   0.000 0.000      200
Nucleus                    0.372   0.240 0.292      200
Peroxisome                 0.194   0.365 0.253      159
Plastid                    0.179   0.430 0.253      200

Contingency table (true x pred):
pred                    0    1   2  3   4   5   6   7   8
true                                                     
Cytoplasm              19   26  15  1  22  20  19  40  38
Endoplasmic reticulum  53   29   7  0  12  14   8  52  25
Extracellular          33  108   3  1   3   1  14  33   4
Golgi apparatus        14    8   8  2  21   9  15  23  26
Lysosome/Vacuole       41   25   9  1  17  19  12  65  11
Mitochondrion          27   53   3  0   7  16   2  75  17
Nucleus                12   23   6  1  22  18  48  41  29
Peroxisome             58    9   1  1   2  18   3  66   1
Plastid                42   24   1  0  14  13   8  86  12

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     38                     15  ...          19       40
Endoplasmic reticulum         25                      7  ...          53       52
Extracellular                  4                      3  ...          33       33
Golgi apparatus               26                      8  ...          14       23
Lysosome/Vacuole              11                      9  ...          41       65
Mitochondrion                 17                      3  ...          27       75
Nucleus                       29                      6  ...          12       41
Peroxisome                     1                      1  ...          58       66
Plastid                       12                      1  ...          42       86

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.116923
Endoplasmic reticulum                  0  0.118834
Extracellular                          1  0.272040
Golgi apparatus                        8  0.098859
Lysosome/Vacuole                       7  0.105519
Mitochondrion                          7  0.123762
Nucleus                                6  0.170819
Peroxisome                             0  0.145000
Plastid                                7  0.144538

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0       Peroxisome  0.145000
1    Extracellular  0.272040
2        Cytoplasm  0.063025
3  Golgi apparatus  0.015267
4  Golgi apparatus  0.093333
5       Peroxisome  0.066914
6          Nucleus  0.170819
7          Plastid  0.144538
8        Cytoplasm  0.116923

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
8                         Cytoplasm  0.116923
2             Endoplasmic reticulum  0.028455
1                     Extracellular  0.272040
4                   Golgi apparatus  0.093333
5                  Lysosome/Vacuole  0.061489
3                     Mitochondrion  0.000000
6                           Nucleus  0.170819
0                        Peroxisome  0.145000
7                           Plastid  0.144538
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
bow_functional
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0111
NMI = 0.0430
Jaccard macro (true → best cluster) = 0.1199
Jaccard macro (cluster → best true) = 0.0497
Jaccard macro (Hungarian-aligned pairs) = 0.0473
Mapping-based clustering accuracy = 0.1650

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.187   0.320 0.236      200
Endoplasmic reticulum      0.000   0.000 0.000      200
Extracellular              0.148   0.910 0.255      200
Golgi apparatus            0.267   0.032 0.057      126
Lysosome/Vacuole           0.308   0.020 0.038      200
Mitochondrion              0.000   0.000 0.000      200
Nucleus                    0.307   0.115 0.167      200
Peroxisome                 0.500   0.006 0.012      159
Plastid                    0.000   0.000 0.000      200

Contingency table (true x pred):
pred                    0   1  2  3  4  5    6  7  8
true                                                
Cytoplasm              18  64  5  0  0  2  110  1  0
Endoplasmic reticulum   8  39  0  0  0  1  152  0  0
Extracellular           1  11  3  0  0  1  182  1  1
Golgi apparatus         6  47  4  1  1  2   64  0  1
Lysosome/Vacuole       14  39  1  0  0  4  141  1  0
Mitochondrion           2  25  1  0  0  1  171  0  0
Nucleus                23  49  1  1  0  1  125  0  0
Peroxisome              1  32  0  0  1  0  125  0  0
Plastid                 2  37  0  0  0  1  160  0  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     64                      0  ...           0        0
Endoplasmic reticulum         39                      0  ...           0        0
Extracellular                 11                      0  ...           0        1
Golgi apparatus               47                      1  ...           1        1
Lysosome/Vacuole              39                      0  ...           0        0
Mitochondrion                 25                      0  ...           0        0
Nucleus                       49                      1  ...           0        0
Peroxisome                    32                      0  ...           1        0
Plastid                       37                      0  ...           0        0

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.133612
Endoplasmic reticulum                  6  0.118936
Extracellular                          6  0.145833
Golgi apparatus                        1  0.111374
Lysosome/Vacuole                       6  0.109387
Mitochondrion                          6  0.135822
Nucleus                                1  0.099190
Peroxisome                             6  0.098892
Plastid                                6  0.125984

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.091270
1         Cytoplasm  0.133612
2   Golgi apparatus  0.029197
3   Golgi apparatus  0.007874
4   Golgi apparatus  0.007874
5  Lysosome/Vacuole  0.019139
6     Extracellular  0.145833
7         Cytoplasm  0.004950
8   Golgi apparatus  0.007874

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.133612
3             Endoplasmic reticulum  0.000000
6                     Extracellular  0.145833
2                   Golgi apparatus  0.029197
5                  Lysosome/Vacuole  0.019139
7                     Mitochondrion  0.000000
0                           Nucleus  0.091270
4                        Peroxisome  0.006250
8                           Plastid  0.000000
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
bow_functional
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.0254
NMI = 0.0575
Jaccard macro (true → best cluster) = 0.1231
Jaccard macro (cluster → best true) = 0.0841
Jaccard macro (Hungarian-aligned pairs) = 0.0798
Mapping-based clustering accuracy = 0.1958

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.190   0.175 0.182      200
Endoplasmic reticulum      0.241   0.035 0.061      200
Extracellular              0.251   0.630 0.359      200
Golgi apparatus            0.600   0.024 0.046      126
Lysosome/Vacuole           0.167   0.005 0.010      200
Mitochondrion              0.067   0.005 0.009      200
Nucleus                    0.344   0.110 0.167      200
Peroxisome                 0.150   0.346 0.210      159
Plastid                    0.155   0.400 0.224      200

Contingency table (true x pred):
pred                     0   1  2   3  4  5   6  7   8
true                                                  
Cytoplasm               44  35  4  52  1  1  39  6  18
Endoplasmic reticulum   53  22  0  63  0  0  53  7   2
Extracellular          126   3  4  47  0  1  16  1   2
Golgi apparatus         25  33  3  22  3  1  30  3   6
Lysosome/Vacuole        52  26  1  58  1  1  44  6  11
Mitochondrion           84  11  1  65  0  0  36  2   1
Nucleus                 41  33  1  55  0  1  44  3  22
Peroxisome              24   5  0  73  0  1  55  1   0
Plastid                 52  16  1  80  0  0  49  0   2

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     35                      6  ...          39       52
Endoplasmic reticulum         22                      7  ...          53       63
Extracellular                  3                      1  ...          16       47
Golgi apparatus               33                      3  ...          30       22
Lysosome/Vacuole              26                      6  ...          44       58
Mitochondrion                 11                      2  ...          36       65
Nucleus                       33                      3  ...          44       55
Peroxisome                     5                      1  ...          55       73
Plastid                       16                      0  ...          49       80

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.100287
Endoplasmic reticulum                  6  0.103314
Extracellular                          0  0.219130
Golgi apparatus                        1  0.119134
Lysosome/Vacuole                       3  0.088280
Mitochondrion                          0  0.136143
Nucleus                                1  0.094017
Peroxisome                             3  0.121464
Plastid                                3  0.125984

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0          Extracellular  0.219130
1        Golgi apparatus  0.119134
2        Golgi apparatus  0.021739
3                Plastid  0.125984
4        Golgi apparatus  0.023438
5        Golgi apparatus  0.007634
6             Peroxisome  0.117021
7  Endoplasmic reticulum  0.031532
8                Nucleus  0.090909

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.100287
7             Endoplasmic reticulum  0.031532
0                     Extracellular  0.219130
4                   Golgi apparatus  0.023438
5                  Lysosome/Vacuole  0.004878
2                     Mitochondrion  0.004673
8                           Nucleus  0.090909
6                        Peroxisome  0.117021
3                           Plastid  0.125984
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
bow_functional
Similarity.Geodesic_Clustering.Spectral
ARI = 0.0412
NMI = 0.0741
Jaccard macro (true → best cluster) = 0.1376
Jaccard macro (cluster → best true) = 0.1219
Jaccard macro (Hungarian-aligned pairs) = 0.1098
Mapping-based clustering accuracy = 0.2184

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.227   0.160 0.188      200
Endoplasmic reticulum      0.095   0.035 0.051      200
Extracellular              0.367   0.550 0.440      200
Golgi apparatus            0.150   0.175 0.161      126
Lysosome/Vacuole           0.141   0.100 0.117      200
Mitochondrion              0.000   0.000 0.000      200
Nucleus                    0.235   0.195 0.213      200
Peroxisome                 0.238   0.396 0.297      159
Plastid                    0.171   0.375 0.235      200

Contingency table (true x pred):
pred                    0   1    2   3  4   5   6   7   8
true                                                     
Cytoplasm              36  27   26  32  1  25  24  17  12
Endoplasmic reticulum  56  19   26  20  0  13  12   7  47
Extracellular          33   5  110   3  3   3  16   1  26
Golgi apparatus        23  22    8  21  4  14  16   9   9
Lysosome/Vacuole       62  17   23  10  1  20  20  13  34
Mitochondrion          64  11   53  15  0  12  12   4  29
Nucleus                35  19   23  26  1  29  39  19   9
Peroxisome             55  10    9   1  1  14   5   1  63
Plastid                75  17   22  13  0  12  22   3  36

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     32                     17  ...          12       36
Endoplasmic reticulum         20                      7  ...          47       56
Extracellular                  3                      1  ...          26       33
Golgi apparatus               21                      9  ...           9       23
Lysosome/Vacuole              10                     13  ...          34       62
Mitochondrion                 15                      4  ...          29       64
Nucleus                       26                     19  ...           9       35
Peroxisome                     1                      1  ...          63       55
Plastid                       13                      3  ...          36       75

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              3  0.103560
Endoplasmic reticulum                  8  0.112440
Extracellular                          2  0.282051
Golgi apparatus                        1  0.087649
Lysosome/Vacuole                       0  0.107452
Mitochondrion                          2  0.118568
Nucleus                                6  0.119266
Peroxisome                             8  0.174515
Plastid                                0  0.132979

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0          Plastid  0.132979
1  Golgi apparatus  0.087649
2    Extracellular  0.282051
3        Cytoplasm  0.103560
4  Golgi apparatus  0.030075
5          Nucleus  0.092652
6          Nucleus  0.119266
7          Nucleus  0.074510
8       Peroxisome  0.174515

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.103560
7             Endoplasmic reticulum  0.026217
2                     Extracellular  0.282051
1                   Golgi apparatus  0.087649
5                  Lysosome/Vacuole  0.062112
4                     Mitochondrion  0.000000
6                           Nucleus  0.119266
8                        Peroxisome  0.174515
0                           Plastid  0.132979
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_8M_functional
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0046
NMI = 0.0297
Jaccard macro (true → best cluster) = 0.1159
Jaccard macro (cluster → best true) = 0.0513
Jaccard macro (Hungarian-aligned pairs) = 0.0480
Mapping-based clustering accuracy = 0.1525

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.500   0.005 0.010      200
Endoplasmic reticulum      0.333   0.010 0.019      200
Extracellular              0.206   0.245 0.224      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.250   0.005 0.010      200
Mitochondrion              1.000   0.005 0.010      200
Nucleus                    0.243   0.045 0.076      200
Peroxisome                 0.301   0.157 0.207      159
Plastid                    0.129   0.845 0.224      200

Contingency table (true x pred):
pred                    0  1  2   3  4    5  6  7  8
true                                                
Cytoplasm               8  1  0  30  0  158  0  0  3
Endoplasmic reticulum   8  0  2  33  1  152  0  0  4
Extracellular           9  0  2  49  0  129  0  2  9
Golgi apparatus         9  0  0  15  0   98  0  0  4
Lysosome/Vacuole       15  1  0  17  0  163  0  1  3
Mitochondrion           4  0  1  24  0  169  1  0  1
Nucleus                 1  0  1  19  0  169  0  1  9
Peroxisome             25  0  0  27  4  101  0  0  2
Plastid                 4  0  0  24  1  169  0  0  2

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      1                      0  ...           8      158
Endoplasmic reticulum          0                      2  ...           8      152
Extracellular                  0                      2  ...           9      129
Golgi apparatus                0                      0  ...           9       98
Lysosome/Vacuole               1                      0  ...          15      163
Mitochondrion                  0                      1  ...           4      169
Nucleus                        0                      1  ...           1      169
Peroxisome                     0                      0  ...          25      101
Plastid                        0                      0  ...           4      169

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              5  0.117037
Endoplasmic reticulum                  5  0.112094
Extracellular                          3  0.125964
Golgi apparatus                        5  0.073353
Lysosome/Vacuole                       5  0.121190
Mitochondrion                          5  0.126214
Nucleus                                5  0.126214
Peroxisome                             0  0.115207
Plastid                                5  0.126214

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0             Peroxisome  0.115207
1              Cytoplasm  0.004975
2  Endoplasmic reticulum  0.009804
3          Extracellular  0.125964
4             Peroxisome  0.024845
5          Mitochondrion  0.126214
6          Mitochondrion  0.005000
7          Extracellular  0.009901
8          Extracellular  0.039474

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.004975
2             Endoplasmic reticulum  0.009804
3                     Extracellular  0.125964
4                   Golgi apparatus  0.000000
7                  Lysosome/Vacuole  0.004926
6                     Mitochondrion  0.005000
8                           Nucleus  0.039474
0                        Peroxisome  0.115207
5                           Plastid  0.126214
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_8M_functional
Similarity.Cosine_Clustering.Kmeans
ARI = 0.0567
NMI = 0.1271
Jaccard macro (true → best cluster) = 0.1594
Jaccard macro (cluster → best true) = 0.1631
Jaccard macro (Hungarian-aligned pairs) = 0.1488
Mapping-based clustering accuracy = 0.2534

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.220   0.165 0.189      200
Endoplasmic reticulum      0.154   0.280 0.199      200
Extracellular              0.703   0.415 0.522      200
Golgi apparatus            0.175   0.349 0.233      126
Lysosome/Vacuole           0.167   0.045 0.071      200
Mitochondrion              0.270   0.405 0.324      200
Nucleus                    0.378   0.155 0.220      200
Peroxisome                 0.259   0.314 0.284      159
Plastid                    0.233   0.200 0.215      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              33   0  21  18  14  37  17  15  45
Endoplasmic reticulum  10  10  26   4   7  56  36  33  18
Extracellular           9  83  11   0  16  24  17  26  14
Golgi apparatus        12   1  13  17   5  17  12   5  44
Lysosome/Vacuole       23  23  21   9   5  49  30   5  35
Mitochondrion           9   1  21   3   2  36  81  25  22
Nucleus                46   0   6   2  31  31  11  20  53
Peroxisome              7   0  50   0   1  52  41   3   5
Plastid                 1   0  24   1   1  62  55  40  16

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     33                     37  ...          21       15
Endoplasmic reticulum         10                     56  ...          26       33
Extracellular                  9                     24  ...          11       26
Golgi apparatus               12                     17  ...          13        5
Lysosome/Vacuole              23                     49  ...          21        5
Mitochondrion                  9                     36  ...          21       25
Nucleus                       46                     31  ...           6       20
Peroxisome                     7                     52  ...          50        3
Plastid                        1                     62  ...          24       40

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.110565
Endoplasmic reticulum                  5  0.110236
Extracellular                          1  0.353191
Golgi apparatus                        8  0.131737
Lysosome/Vacuole                       5  0.095146
Mitochondrion                          6  0.193317
Nucleus                                0  0.151316
Peroxisome                             2  0.165563
Plastid                                6  0.123596

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0          Nucleus  0.151316
1    Extracellular  0.353191
2       Peroxisome  0.165563
3  Golgi apparatus  0.104294
4          Nucleus  0.123506
5          Plastid  0.123506
6    Mitochondrion  0.193317
7          Plastid  0.120482
8          Nucleus  0.132832

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.104101
5             Endoplasmic reticulum  0.110236
1                     Extracellular  0.353191
8                   Golgi apparatus  0.131737
3                  Lysosome/Vacuole  0.036735
6                     Mitochondrion  0.193317
4                           Nucleus  0.123506
2                        Peroxisome  0.165563
7                           Plastid  0.120482
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_8M_functional
Similarity.Cosine_Clustering.Spectral
ARI = 0.0858
NMI = 0.1573
Jaccard macro (true → best cluster) = 0.1891
Jaccard macro (cluster → best true) = 0.1765
Jaccard macro (Hungarian-aligned pairs) = 0.1706
Mapping-based clustering accuracy = 0.2819

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.172   0.165 0.168      200
Endoplasmic reticulum      0.285   0.265 0.275      200
Extracellular              0.622   0.445 0.519      200
Golgi apparatus            0.134   0.278 0.180      126
Lysosome/Vacuole           0.221   0.170 0.192      200
Mitochondrion              0.268   0.390 0.318      200
Nucleus                    0.433   0.305 0.358      200
Peroxisome                 0.376   0.465 0.416      159
Plastid                    0.151   0.090 0.113      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              25  15   3  33   1  31  22  28  42
Endoplasmic reticulum   5  19  53  22  12  15   7  42  25
Extracellular          14   0  47   7  89   6  10  18   9
Golgi apparatus        15   8   7  10   2  28  16   5  35
Lysosome/Vacuole       10   4  54  19  26  34  14   6  33
Mitochondrion           3  36   2  32   4  15   5  78  25
Nucleus                61   1   1  33   0  11  20  20  53
Peroxisome              2  74  10  22   0   2   7  30  12
Plastid                 6  40   9  14   9  12  18  64  28

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     33                      3  ...          15       22
Endoplasmic reticulum         22                     53  ...          19        7
Extracellular                  7                     47  ...           0       10
Golgi apparatus               10                      7  ...           8       16
Lysosome/Vacuole              19                     54  ...           4       14
Mitochondrion                 32                      2  ...          36        5
Nucleus                       33                      1  ...           1       20
Peroxisome                    22                     10  ...          74        7
Plastid                       14                      9  ...          40       18

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.100000
Endoplasmic reticulum                  2  0.159159
Extracellular                          4  0.350394
Golgi apparatus                        5  0.111111
Lysosome/Vacuole                       2  0.162651
Mitochondrion                          7  0.188862
Nucleus                                0  0.217857
Peroxisome                             1  0.262411
Plastid                                7  0.149883

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.217857
1        Peroxisome  0.262411
2  Lysosome/Vacuole  0.162651
3         Cytoplasm  0.091922
4     Extracellular  0.350394
5   Golgi apparatus  0.111111
6         Cytoplasm  0.074074
7     Mitochondrion  0.188862
8           Nucleus  0.129584

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.091922
2             Endoplasmic reticulum  0.159159
4                     Extracellular  0.350394
8                   Golgi apparatus  0.099150
5                  Lysosome/Vacuole  0.106250
7                     Mitochondrion  0.188862
0                           Nucleus  0.217857
1                        Peroxisome  0.262411
6                           Plastid  0.059801
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_8M_functional
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0080
NMI = 0.0377
Jaccard macro (true → best cluster) = 0.1154
Jaccard macro (cluster → best true) = 0.0658
Jaccard macro (Hungarian-aligned pairs) = 0.0592
Mapping-based clustering accuracy = 0.1579

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.130   0.230 0.166      200
Endoplasmic reticulum      0.222   0.010 0.019      200
Extracellular              0.416   0.160 0.231      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           1.000   0.005 0.010      200
Mitochondrion              0.133   0.665 0.222      200
Nucleus                    0.200   0.030 0.052      200
Peroxisome                 0.217   0.283 0.246      159
Plastid                    0.167   0.005 0.010      200

Contingency table (true x pred):
pred                    0  1    2   3  4  5  6   7   8
true                                                  
Cytoplasm              24  1  115  46  0  0  0  11   3
Endoplasmic reticulum  31  2  118  43  0  0  1   4   1
Extracellular          14  3  120  21  0  0  0  32  10
Golgi apparatus        13  0   75  31  0  0  0   3   4
Lysosome/Vacuole       26  0  127  39  0  1  0   4   3
Mitochondrion          21  1  133  37  1  0  0   6   1
Nucleus                 8  2  124  47  0  0  1  12   6
Peroxisome             45  0   56  47  4  0  1   5   1
Plastid                25  0  130  43  1  0  0   0   1

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     46                      1  ...          24        0
Endoplasmic reticulum         43                      2  ...          31        0
Extracellular                 21                      3  ...          14        0
Golgi apparatus               31                      0  ...          13        0
Lysosome/Vacuole              39                      0  ...          26        0
Mitochondrion                 37                      1  ...          21        1
Nucleus                       47                      2  ...           8        0
Peroxisome                    47                      0  ...          45        4
Plastid                       43                      0  ...          25        1

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.106187
Endoplasmic reticulum                  2  0.109259
Extracellular                          7  0.130612
Golgi apparatus                        2  0.071497
Lysosome/Vacuole                       2  0.118581
Mitochondrion                          2  0.124883
Nucleus                                2  0.115456
Peroxisome                             0  0.140187
Plastid                                2  0.121723

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0        Peroxisome  0.140187
1     Extracellular  0.014563
2     Mitochondrion  0.124883
3        Peroxisome  0.100858
4        Peroxisome  0.024845
5  Lysosome/Vacuole  0.005000
6        Peroxisome  0.006211
7     Extracellular  0.130612
8     Extracellular  0.045455

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.090551
1             Endoplasmic reticulum  0.009662
7                     Extracellular  0.130612
6                   Golgi apparatus  0.000000
5                  Lysosome/Vacuole  0.005000
2                     Mitochondrion  0.124883
8                           Nucleus  0.026786
0                        Peroxisome  0.140187
4                           Plastid  0.004878
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_8M_functional
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.0567
NMI = 0.1271
Jaccard macro (true → best cluster) = 0.1594
Jaccard macro (cluster → best true) = 0.1631
Jaccard macro (Hungarian-aligned pairs) = 0.1488
Mapping-based clustering accuracy = 0.2534

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.220   0.165 0.189      200
Endoplasmic reticulum      0.154   0.280 0.199      200
Extracellular              0.703   0.415 0.522      200
Golgi apparatus            0.175   0.349 0.233      126
Lysosome/Vacuole           0.167   0.045 0.071      200
Mitochondrion              0.270   0.405 0.324      200
Nucleus                    0.378   0.155 0.220      200
Peroxisome                 0.259   0.314 0.284      159
Plastid                    0.233   0.200 0.215      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              33   0  21  18  14  37  17  15  45
Endoplasmic reticulum  10  10  26   4   7  56  36  33  18
Extracellular           9  83  11   0  16  24  17  26  14
Golgi apparatus        12   1  13  17   5  17  12   5  44
Lysosome/Vacuole       23  23  21   9   5  49  30   5  35
Mitochondrion           9   1  21   3   2  36  81  25  22
Nucleus                46   0   6   2  31  31  11  20  53
Peroxisome              7   0  50   0   1  52  41   3   5
Plastid                 1   0  24   1   1  62  55  40  16

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     33                     37  ...          21       15
Endoplasmic reticulum         10                     56  ...          26       33
Extracellular                  9                     24  ...          11       26
Golgi apparatus               12                     17  ...          13        5
Lysosome/Vacuole              23                     49  ...          21        5
Mitochondrion                  9                     36  ...          21       25
Nucleus                       46                     31  ...           6       20
Peroxisome                     7                     52  ...          50        3
Plastid                        1                     62  ...          24       40

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.110565
Endoplasmic reticulum                  5  0.110236
Extracellular                          1  0.353191
Golgi apparatus                        8  0.131737
Lysosome/Vacuole                       5  0.095146
Mitochondrion                          6  0.193317
Nucleus                                0  0.151316
Peroxisome                             2  0.165563
Plastid                                6  0.123596

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0          Nucleus  0.151316
1    Extracellular  0.353191
2       Peroxisome  0.165563
3  Golgi apparatus  0.104294
4          Nucleus  0.123506
5          Plastid  0.123506
6    Mitochondrion  0.193317
7          Plastid  0.120482
8          Nucleus  0.132832

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.104101
5             Endoplasmic reticulum  0.110236
1                     Extracellular  0.353191
8                   Golgi apparatus  0.131737
3                  Lysosome/Vacuole  0.036735
6                     Mitochondrion  0.193317
4                           Nucleus  0.123506
2                        Peroxisome  0.165563
7                           Plastid  0.120482
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_8M_functional
Similarity.Euclidean_Clustering.Spectral
ARI = 0.0936
NMI = 0.1636
Jaccard macro (true → best cluster) = 0.1899
Jaccard macro (cluster → best true) = 0.1763
Jaccard macro (Hungarian-aligned pairs) = 0.1655
Mapping-based clustering accuracy = 0.2819

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.258   0.200 0.225      200
Endoplasmic reticulum      0.186   0.120 0.146      200
Extracellular              0.623   0.405 0.491      200
Golgi apparatus            0.159   0.246 0.193      126
Lysosome/Vacuole           0.289   0.295 0.292      200
Mitochondrion              0.286   0.420 0.340      200
Nucleus                    0.360   0.335 0.347      200
Peroxisome                 0.305   0.491 0.376      159
Plastid                    0.081   0.055 0.065      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              26   2  27  40  14  30   5  35  21
Endoplasmic reticulum  27  11  13  17  24  14  51  11  32
Extracellular           8  81  18   4  31   5  46   7   0
Golgi apparatus         9   2  16  31   8  31   7  13   9
Lysosome/Vacuole        7  27  15  31   8  25  59  23   5
Mitochondrion          84   1   4  17  10  26   3  13  42
Nucleus                24   1  24   5  25  44   5  67   5
Peroxisome             37   0   8   1   1   5  18  11  78
Plastid                72   5  11   9   8  15  10   6  64

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     40                     14  ...          21       27
Endoplasmic reticulum         17                     24  ...          32       13
Extracellular                  4                     31  ...           0       18
Golgi apparatus               31                      8  ...           9       16
Lysosome/Vacuole              31                      8  ...           5       15
Mitochondrion                 17                     10  ...          42        4
Nucleus                        5                     25  ...           5       24
Peroxisome                     1                      1  ...          78        8
Plastid                        9                      8  ...          64       11

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              3  0.126984
Endoplasmic reticulum                  6  0.144476
Extracellular                          1  0.325301
Golgi apparatus                        3  0.124000
Lysosome/Vacuole                       6  0.171014
Mitochondrion                          0  0.204878
Nucleus                                7  0.210031
Peroxisome                             8  0.231454
Plastid                                0  0.170616

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0     Mitochondrion  0.204878
1     Extracellular  0.325301
2         Cytoplasm  0.087379
3         Cytoplasm  0.126984
4     Extracellular  0.104027
5           Nucleus  0.125356
6  Lysosome/Vacuole  0.171014
7           Nucleus  0.210031
8        Peroxisome  0.231454

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.126984
4             Endoplasmic reticulum  0.078689
1                     Extracellular  0.325301
5                   Golgi apparatus  0.106897
6                  Lysosome/Vacuole  0.171014
0                     Mitochondrion  0.204878
7                           Nucleus  0.210031
8                        Peroxisome  0.231454
2                           Plastid  0.033846
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_8M_functional
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0268
NMI = 0.1207
Jaccard macro (true → best cluster) = 0.1544
Jaccard macro (cluster → best true) = 0.1192
Jaccard macro (Hungarian-aligned pairs) = 0.1114
Mapping-based clustering accuracy = 0.2231

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.223   0.165 0.190      200
Endoplasmic reticulum      0.333   0.010 0.019      200
Extracellular              0.809   0.360 0.498      200
Golgi apparatus            0.455   0.040 0.073      126
Lysosome/Vacuole           0.303   0.050 0.086      200
Mitochondrion              0.091   0.005 0.009      200
Nucleus                    0.153   0.735 0.253      200
Peroxisome                 0.373   0.258 0.305      159
Plastid                    0.206   0.325 0.252      200

Contingency table (true x pred):
pred                    0  1    2   3   4  5   6  7   8
true                                                   
Cytoplasm               2  0  130   2  33  0  10  0  23
Endoplasmic reticulum   1  2   98   5  11  6  18  0  59
Extracellular          10  1   84  72  13  0   5  0  15
Golgi apparatus         8  0   87   0  21  5   2  0   3
Lysosome/Vacuole       10  1  122   8  19  0   4  1  35
Mitochondrion           0  1  133   0   3  0  18  1  44
Nucleus                 0  1  147   0  36  0   0  0  16
Peroxisome              1  0   49   1   3  0  41  9  55
Plastid                 1  0  112   1   9  0  12  0  65

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     33                      0  ...          10       23
Endoplasmic reticulum         11                      2  ...          18       59
Extracellular                 13                      1  ...           5       15
Golgi apparatus               21                      0  ...           2        3
Lysosome/Vacuole              19                      1  ...           4       35
Mitochondrion                  3                      1  ...          18       44
Nucleus                       36                      1  ...           0       16
Peroxisome                     3                      0  ...          41       55
Plastid                        9                      0  ...          12       65

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.125969
Endoplasmic reticulum                  8  0.129386
Extracellular                          3  0.331797
Golgi apparatus                        2  0.086913
Lysosome/Vacuole                       2  0.117308
Mitochondrion                          2  0.129252
Nucleus                                2  0.144828
Peroxisome                             6  0.179825
Plastid                                8  0.144444

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0        Golgi apparatus  0.052980
1  Endoplasmic reticulum  0.009804
2                Nucleus  0.144828
3          Extracellular  0.331797
4                Nucleus  0.115385
5        Golgi apparatus  0.037879
6             Peroxisome  0.179825
7             Peroxisome  0.055901
8                Plastid  0.144444

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
4                         Cytoplasm  0.104762
1             Endoplasmic reticulum  0.009804
3                     Extracellular  0.331797
5                   Golgi apparatus  0.037879
0                  Lysosome/Vacuole  0.044843
7                     Mitochondrion  0.004762
2                           Nucleus  0.144828
6                        Peroxisome  0.179825
8                           Plastid  0.144444
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_8M_functional
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.0567
NMI = 0.1271
Jaccard macro (true → best cluster) = 0.1594
Jaccard macro (cluster → best true) = 0.1631
Jaccard macro (Hungarian-aligned pairs) = 0.1488
Mapping-based clustering accuracy = 0.2534

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.220   0.165 0.189      200
Endoplasmic reticulum      0.154   0.280 0.199      200
Extracellular              0.703   0.415 0.522      200
Golgi apparatus            0.175   0.349 0.233      126
Lysosome/Vacuole           0.167   0.045 0.071      200
Mitochondrion              0.270   0.405 0.324      200
Nucleus                    0.378   0.155 0.220      200
Peroxisome                 0.259   0.314 0.284      159
Plastid                    0.233   0.200 0.215      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              33   0  21  18  14  37  17  15  45
Endoplasmic reticulum  10  10  26   4   7  56  36  33  18
Extracellular           9  83  11   0  16  24  17  26  14
Golgi apparatus        12   1  13  17   5  17  12   5  44
Lysosome/Vacuole       23  23  21   9   5  49  30   5  35
Mitochondrion           9   1  21   3   2  36  81  25  22
Nucleus                46   0   6   2  31  31  11  20  53
Peroxisome              7   0  50   0   1  52  41   3   5
Plastid                 1   0  24   1   1  62  55  40  16

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     33                     37  ...          21       15
Endoplasmic reticulum         10                     56  ...          26       33
Extracellular                  9                     24  ...          11       26
Golgi apparatus               12                     17  ...          13        5
Lysosome/Vacuole              23                     49  ...          21        5
Mitochondrion                  9                     36  ...          21       25
Nucleus                       46                     31  ...           6       20
Peroxisome                     7                     52  ...          50        3
Plastid                        1                     62  ...          24       40

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.110565
Endoplasmic reticulum                  5  0.110236
Extracellular                          1  0.353191
Golgi apparatus                        8  0.131737
Lysosome/Vacuole                       5  0.095146
Mitochondrion                          6  0.193317
Nucleus                                0  0.151316
Peroxisome                             2  0.165563
Plastid                                6  0.123596

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0          Nucleus  0.151316
1    Extracellular  0.353191
2       Peroxisome  0.165563
3  Golgi apparatus  0.104294
4          Nucleus  0.123506
5          Plastid  0.123506
6    Mitochondrion  0.193317
7          Plastid  0.120482
8          Nucleus  0.132832

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.104101
5             Endoplasmic reticulum  0.110236
1                     Extracellular  0.353191
8                   Golgi apparatus  0.131737
3                  Lysosome/Vacuole  0.036735
6                     Mitochondrion  0.193317
4                           Nucleus  0.123506
2                        Peroxisome  0.165563
7                           Plastid  0.120482
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_8M_functional
Similarity.Geodesic_Clustering.Spectral
ARI = 0.0865
NMI = 0.1537
Jaccard macro (true → best cluster) = 0.1816
Jaccard macro (cluster → best true) = 0.1729
Jaccard macro (Hungarian-aligned pairs) = 0.1654
Mapping-based clustering accuracy = 0.2920

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.240   0.245 0.243      200
Endoplasmic reticulum      0.187   0.250 0.214      200
Extracellular              0.608   0.450 0.517      200
Golgi apparatus            0.024   0.008 0.012      126
Lysosome/Vacuole           0.254   0.175 0.207      200
Mitochondrion              0.286   0.455 0.351      200
Nucleus                    0.406   0.475 0.438      200
Peroxisome                 0.261   0.289 0.275      159
Plastid                    0.222   0.175 0.196      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm               9  43  27  49  10  44   0  12   6
Endoplasmic reticulum  31  50  33  16  22  10  16  15   7
Extracellular          22  10  12  17  36  12  90   1   0
Golgi apparatus         3  41   9  30   6  24   3   9   1
Lysosome/Vacuole       35  36  16  40   4  26  35   7   1
Mitochondrion           6  22  91  11  17  13   1  34   5
Nucleus                 0  28  18  25  25  95   1   7   1
Peroxisome             14  24  47   5   3   7   0  46  13
Plastid                18  14  65  11  35   3   2  45   7

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     49                     43  ...          12       10
Endoplasmic reticulum         16                     50  ...          15       22
Extracellular                 17                     10  ...           1       36
Golgi apparatus               30                     41  ...           9        6
Lysosome/Vacuole              40                     36  ...           7        4
Mitochondrion                 11                     22  ...          34       17
Nucleus                       25                     28  ...           7       25
Peroxisome                     5                     24  ...          46        3
Plastid                       11                     14  ...          45       35

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              3  0.138028
Endoplasmic reticulum                  1  0.119617
Extracellular                          6  0.348837
Golgi apparatus                        1  0.116147
Lysosome/Vacuole                       0  0.115512
Mitochondrion                          2  0.213115
Nucleus                                5  0.280236
Peroxisome                             7  0.159170
Plastid                                2  0.143488

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0       Lysosome/Vacuole  0.115512
1  Endoplasmic reticulum  0.119617
2          Mitochondrion  0.213115
3              Cytoplasm  0.138028
4          Extracellular  0.111801
5                Nucleus  0.280236
6          Extracellular  0.348837
7             Peroxisome  0.159170
8             Peroxisome  0.069519

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.138028
1             Endoplasmic reticulum  0.119617
6                     Extracellular  0.348837
8                   Golgi apparatus  0.006024
0                  Lysosome/Vacuole  0.115512
2                     Mitochondrion  0.213115
5                           Nucleus  0.280236
7                        Peroxisome  0.159170
4                           Plastid  0.108359
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_35M_functional
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0003
NMI = 0.0217
Jaccard macro (true → best cluster) = 0.1097
Jaccard macro (cluster → best true) = 0.0322
Jaccard macro (Hungarian-aligned pairs) = 0.0298
Mapping-based clustering accuracy = 0.1323

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.124   0.935 0.219      200
Endoplasmic reticulum      0.000   0.000 0.000      200
Extracellular              0.500   0.020 0.038      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.227   0.025 0.045      200
Mitochondrion              0.500   0.005 0.010      200
Nucleus                    0.250   0.040 0.069      200
Peroxisome                 0.000   0.000 0.000      159
Plastid                    0.164   0.090 0.116      200

Contingency table (true x pred):
pred                     0  1  2   3  4  5  6  7  8
true                                               
Cytoplasm              187  5  1   5  1  0  0  1  0
Endoplasmic reticulum  180  4  0  11  3  0  2  0  0
Extracellular          175  3  0  13  5  0  4  0  0
Golgi apparatus        116  0  0   7  3  0  0  0  0
Lysosome/Vacuole       169  5  0  19  5  0  1  0  1
Mitochondrion          174  4  1  18  2  1  0  0  0
Nucleus                188  8  0   2  0  1  1  0  0
Peroxisome             137  2  0  17  3  0  0  0  0
Plastid                180  1  1  18  0  0  0  0  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                    187                      1  ...           1        5
Endoplasmic reticulum        180                      0  ...           0       11
Extracellular                175                      0  ...           0       13
Golgi apparatus              116                      0  ...           0        7
Lysosome/Vacuole             169                      0  ...           0       19
Mitochondrion                174                      1  ...           0       18
Nucleus                      188                      0  ...           0        2
Peroxisome                   137                      0  ...           0       17
Plastid                      180                      1  ...           0       18

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              0  0.123107
Endoplasmic reticulum                  0  0.117955
Extracellular                          0  0.114304
Golgi apparatus                        0  0.076517
Lysosome/Vacuole                       0  0.109954
Mitochondrion                          0  0.113577
Nucleus                                0  0.123847
Peroxisome                             0  0.089660
Plastid                                0  0.117955

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.123847
1           Nucleus  0.035714
2         Cytoplasm  0.004950
3        Peroxisome  0.067460
4     Extracellular  0.023041
5     Mitochondrion  0.004975
6     Extracellular  0.019608
7         Cytoplasm  0.005000
8  Lysosome/Vacuole  0.005000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.123107
2             Endoplasmic reticulum  0.000000
6                     Extracellular  0.019608
8                   Golgi apparatus  0.000000
4                  Lysosome/Vacuole  0.023041
5                     Mitochondrion  0.004975
1                           Nucleus  0.035714
7                        Peroxisome  0.000000
3                           Plastid  0.061644
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_35M_functional
Similarity.Cosine_Clustering.Kmeans
ARI = 0.0723
NMI = 0.1548
Jaccard macro (true → best cluster) = 0.1821
Jaccard macro (cluster → best true) = 0.1719
Jaccard macro (Hungarian-aligned pairs) = 0.1703
Mapping-based clustering accuracy = 0.2813

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.229   0.135 0.170      200
Endoplasmic reticulum      0.191   0.305 0.235      200
Extracellular              0.837   0.435 0.572      200
Golgi apparatus            0.182   0.349 0.239      126
Lysosome/Vacuole           0.371   0.245 0.295      200
Mitochondrion              0.255   0.355 0.297      200
Nucleus                    0.412   0.175 0.246      200
Peroxisome                 0.215   0.164 0.186      159
Plastid                    0.259   0.370 0.305      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              27   0  50  14  41  25   1  30  12
Endoplasmic reticulum  11  36  12  13  61  30   9  24   4
Extracellular           6  39  10   5  13  27  87   1  12
Golgi apparatus        10   3  44  12  22  20   1   7   7
Lysosome/Vacuole       18  49  41  18  35  26   4   5   4
Mitochondrion          10   0  18  19  27  71   1  49   5
Nucleus                31   0  49   1  25  29   0  30  35
Peroxisome              5   2   3  26  38  18   0  66   1
Plastid                 0   3  15  13  57  32   1  74   5

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     27                     41  ...          14       30
Endoplasmic reticulum         11                     61  ...          13       24
Extracellular                  6                     13  ...           5        1
Golgi apparatus               10                     22  ...          12        7
Lysosome/Vacuole              18                     35  ...          18        5
Mitochondrion                 10                     27  ...          19       49
Nucleus                       31                     25  ...           1       30
Peroxisome                     5                     38  ...          26       66
Plastid                        0                     57  ...          13       74

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.127551
Endoplasmic reticulum                  4  0.133188
Extracellular                          6  0.400922
Golgi apparatus                        2  0.135802
Lysosome/Vacuole                       1  0.173145
Mitochondrion                          5  0.174447
Nucleus                                8  0.140000
Peroxisome                             7  0.174142
Plastid                                7  0.179612

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0                Nucleus  0.108014
1       Lysosome/Vacuole  0.173145
2        Golgi apparatus  0.135802
3             Peroxisome  0.102362
4  Endoplasmic reticulum  0.133188
5          Mitochondrion  0.174447
6          Extracellular  0.400922
7                Plastid  0.179612
8                Nucleus  0.140000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.092784
4             Endoplasmic reticulum  0.133188
6                     Extracellular  0.400922
2                   Golgi apparatus  0.135802
1                  Lysosome/Vacuole  0.173145
5                     Mitochondrion  0.174447
8                           Nucleus  0.140000
3                        Peroxisome  0.102362
7                           Plastid  0.179612
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_35M_functional
Similarity.Cosine_Clustering.Spectral
ARI = 0.1186
NMI = 0.1931
Jaccard macro (true → best cluster) = 0.2126
Jaccard macro (cluster → best true) = 0.2020
Jaccard macro (Hungarian-aligned pairs) = 0.1889
Mapping-based clustering accuracy = 0.3098

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.232   0.370 0.285      200
Endoplasmic reticulum      0.213   0.175 0.192      200
Extracellular              0.356   0.315 0.334      200
Golgi apparatus            0.099   0.079 0.088      126
Lysosome/Vacuole           0.160   0.125 0.140      200
Mitochondrion              0.243   0.305 0.271      200
Nucleus                    0.369   0.225 0.280      200
Peroxisome                 0.386   0.553 0.455      159
Plastid                    0.725   0.605 0.659      200

Contingency table (true x pred):
pred                    0   1    2   3   4   5   6   7   8
true                                                      
Cytoplasm              74   1    6   6  32  14  20  24  23
Endoplasmic reticulum  19  36    8  13  23  35  11  35  20
Extracellular           9  63   10   5   9  65  18  19   2
Golgi apparatus        58  10    0  10  11   7  11  17   2
Lysosome/Vacuole       49  59    0  15  25  20  12  10  10
Mitochondrion          28   1   17  12  18  61   2  17  44
Nucleus                70   0    2   8  33   7  45  26   9
Peroxisome              9   3    3  29   4  16   2   5  88
Plastid                 3   4  121   3   1  26   1  11  30

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     74                     24  ...          23        6
Endoplasmic reticulum         19                     35  ...          20        8
Extracellular                  9                     19  ...           2       10
Golgi apparatus               58                     17  ...           2        0
Lysosome/Vacuole              49                     10  ...          10        0
Mitochondrion                 28                     17  ...          44       17
Nucleus                       70                     26  ...           9        2
Peroxisome                     9                      5  ...          88        3
Plastid                        3                     11  ...          30      121

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              0  0.166292
Endoplasmic reticulum                  7  0.106383
Extracellular                          1  0.200637
Golgi apparatus                        0  0.149871
Lysosome/Vacuole                       1  0.185535
Mitochondrion                          5  0.156410
Nucleus                                6  0.162455
Peroxisome                             8  0.294314
Plastid                                2  0.491870

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0              Cytoplasm  0.166292
1          Extracellular  0.200637
2                Plastid  0.491870
3             Peroxisome  0.125541
4                Nucleus  0.102167
5          Extracellular  0.168394
6                Nucleus  0.162455
7  Endoplasmic reticulum  0.106383
8             Peroxisome  0.294314

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.166292
7             Endoplasmic reticulum  0.106383
1                     Extracellular  0.200637
3                   Golgi apparatus  0.046083
4                  Lysosome/Vacuole  0.075529
5                     Mitochondrion  0.156410
6                           Nucleus  0.162455
8                        Peroxisome  0.294314
2                           Plastid  0.491870
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_35M_functional
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0261
NMI = 0.0574
Jaccard macro (true → best cluster) = 0.1271
Jaccard macro (cluster → best true) = 0.0719
Jaccard macro (Hungarian-aligned pairs) = 0.0639
Mapping-based clustering accuracy = 0.1846

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.190   0.040 0.066      200
Endoplasmic reticulum      0.250   0.010 0.019      200
Extracellular              0.194   0.590 0.292      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.194   0.030 0.052      200
Mitochondrion              0.250   0.005 0.010      200
Nucleus                    0.267   0.040 0.070      200
Peroxisome                 0.174   0.478 0.255      159
Plastid                    0.176   0.460 0.255      200

Contingency table (true x pred):
pred                     0  1   2  3  4   5  6  7   8
true                                                 
Cytoplasm               74  1   8  3  0  33  4  0  77
Endoplasmic reticulum   54  0   3  3  1  62  4  2  71
Extracellular          118  0  20  5  0  38  3  4  12
Golgi apparatus         60  0   3  3  0  18  1  0  41
Lysosome/Vacuole        65  1   2  6  0  64  4  1  57
Mitochondrion           88  1   2  4  1  54  3  0  47
Nucleus                 92  1   3  0  1  23  8  1  71
Peroxisome              21  0   1  4  1  76  2  0  54
Plastid                 36  0   0  3  0  68  1  0  92

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      8                      0  ...          33       77
Endoplasmic reticulum          3                      2  ...          62       71
Extracellular                 20                      4  ...          38       12
Golgi apparatus                3                      0  ...          18       41
Lysosome/Vacuole               2                      1  ...          64       57
Mitochondrion                  2                      0  ...          54       47
Nucleus                        3                      1  ...          23       71
Peroxisome                     1                      0  ...          76       54
Plastid                        0                      0  ...          68       92

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.119380
Endoplasmic reticulum                  8  0.109063
Extracellular                          0  0.171014
Golgi apparatus                        0  0.089021
Lysosome/Vacuole                       5  0.111888
Mitochondrion                          0  0.122222
Nucleus                                0  0.128492
Peroxisome                             5  0.146435
Plastid                                8  0.146032

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0     Extracellular  0.171014
1         Cytoplasm  0.004926
2     Extracellular  0.090090
3  Lysosome/Vacuole  0.026667
4        Peroxisome  0.006173
5        Peroxisome  0.146435
6           Nucleus  0.036036
7     Extracellular  0.019608
8           Plastid  0.146032

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
2                         Cytoplasm  0.034188
7             Endoplasmic reticulum  0.009709
0                     Extracellular  0.171014
4                   Golgi apparatus  0.000000
3                  Lysosome/Vacuole  0.026667
1                     Mitochondrion  0.004926
6                           Nucleus  0.036036
5                        Peroxisome  0.146435
8                           Plastid  0.146032
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_35M_functional
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.0723
NMI = 0.1548
Jaccard macro (true → best cluster) = 0.1821
Jaccard macro (cluster → best true) = 0.1719
Jaccard macro (Hungarian-aligned pairs) = 0.1703
Mapping-based clustering accuracy = 0.2813

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.229   0.135 0.170      200
Endoplasmic reticulum      0.191   0.305 0.235      200
Extracellular              0.837   0.435 0.572      200
Golgi apparatus            0.182   0.349 0.239      126
Lysosome/Vacuole           0.371   0.245 0.295      200
Mitochondrion              0.255   0.355 0.297      200
Nucleus                    0.412   0.175 0.246      200
Peroxisome                 0.215   0.164 0.186      159
Plastid                    0.259   0.370 0.305      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              27   0  50  14  41  25   1  30  12
Endoplasmic reticulum  11  36  12  13  61  30   9  24   4
Extracellular           6  39  10   5  13  27  87   1  12
Golgi apparatus        10   3  44  12  22  20   1   7   7
Lysosome/Vacuole       18  49  41  18  35  26   4   5   4
Mitochondrion          10   0  18  19  27  71   1  49   5
Nucleus                31   0  49   1  25  29   0  30  35
Peroxisome              5   2   3  26  38  18   0  66   1
Plastid                 0   3  15  13  57  32   1  74   5

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     27                     41  ...          14       30
Endoplasmic reticulum         11                     61  ...          13       24
Extracellular                  6                     13  ...           5        1
Golgi apparatus               10                     22  ...          12        7
Lysosome/Vacuole              18                     35  ...          18        5
Mitochondrion                 10                     27  ...          19       49
Nucleus                       31                     25  ...           1       30
Peroxisome                     5                     38  ...          26       66
Plastid                        0                     57  ...          13       74

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.127551
Endoplasmic reticulum                  4  0.133188
Extracellular                          6  0.400922
Golgi apparatus                        2  0.135802
Lysosome/Vacuole                       1  0.173145
Mitochondrion                          5  0.174447
Nucleus                                8  0.140000
Peroxisome                             7  0.174142
Plastid                                7  0.179612

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0                Nucleus  0.108014
1       Lysosome/Vacuole  0.173145
2        Golgi apparatus  0.135802
3             Peroxisome  0.102362
4  Endoplasmic reticulum  0.133188
5          Mitochondrion  0.174447
6          Extracellular  0.400922
7                Plastid  0.179612
8                Nucleus  0.140000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.092784
4             Endoplasmic reticulum  0.133188
6                     Extracellular  0.400922
2                   Golgi apparatus  0.135802
1                  Lysosome/Vacuole  0.173145
5                     Mitochondrion  0.174447
8                           Nucleus  0.140000
3                        Peroxisome  0.102362
7                           Plastid  0.179612
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_35M_functional
Similarity.Euclidean_Clustering.Spectral
ARI = 0.0983
NMI = 0.1763
Jaccard macro (true → best cluster) = 0.1920
Jaccard macro (cluster → best true) = 0.1874
Jaccard macro (Hungarian-aligned pairs) = 0.1718
Mapping-based clustering accuracy = 0.2855

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.191   0.135 0.158      200
Endoplasmic reticulum      0.207   0.195 0.201      200
Extracellular              0.358   0.335 0.346      200
Golgi apparatus            0.203   0.333 0.252      126
Lysosome/Vacuole           0.102   0.100 0.101      200
Mitochondrion              0.274   0.275 0.274      200
Nucleus                    0.381   0.240 0.294      200
Peroxisome                 0.304   0.491 0.375      159
Plastid                    0.577   0.525 0.550      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5    6   7   8
true                                                      
Cytoplasm              41  43  23   2  14  27    4  27  19
Endoplasmic reticulum  12  39   7  43  27  30    6  17  19
Extracellular           8  13  19  67  33   3   44   7   6
Golgi apparatus        42  24  11  10   8   4    0  11  16
Lysosome/Vacuole       31  19  12  60  17  15    2  24  20
Mitochondrion          15  16   3   1  55  43   19  16  32
Nucleus                48  28  48   0  16  13    0  34  13
Peroxisome              6   0   3   2  16  78    2   4  48
Plastid                 4   6   0   2  15  44  105   1  23

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     27                     43  ...          27        4
Endoplasmic reticulum         17                     39  ...          30        6
Extracellular                  7                     13  ...           3       44
Golgi apparatus               11                     24  ...           4        0
Lysosome/Vacuole              24                     19  ...          15        2
Mitochondrion                 16                     16  ...          43       19
Nucleus                       34                     28  ...          13        0
Peroxisome                     4                      0  ...          78        2
Plastid                        1                      6  ...          44      105

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.124638
Endoplasmic reticulum                  3  0.125000
Extracellular                          3  0.209375
Golgi apparatus                        0  0.144330
Lysosome/Vacuole                       3  0.183486
Mitochondrion                          4  0.158960
Nucleus                                2  0.172662
Peroxisome                             5  0.230769
Plastid                                6  0.379061

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0  Golgi apparatus  0.144330
1        Cytoplasm  0.124638
2          Nucleus  0.172662
3    Extracellular  0.209375
4    Mitochondrion  0.158960
5       Peroxisome  0.230769
6          Plastid  0.379061
7          Nucleus  0.110749
8       Peroxisome  0.156352

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
7                         Cytoplasm  0.085987
1             Endoplasmic reticulum  0.111748
3                     Extracellular  0.209375
0                   Golgi apparatus  0.144330
8                  Lysosome/Vacuole  0.053191
4                     Mitochondrion  0.158960
2                           Nucleus  0.172662
5                        Peroxisome  0.230769
6                           Plastid  0.379061
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_35M_functional
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0679
NMI = 0.1652
Jaccard macro (true → best cluster) = 0.1806
Jaccard macro (cluster → best true) = 0.1304
Jaccard macro (Hungarian-aligned pairs) = 0.1253
Mapping-based clustering accuracy = 0.2552

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.250   0.015 0.028      200
Endoplasmic reticulum      0.154   0.010 0.019      200
Extracellular              0.915   0.375 0.532      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.409   0.235 0.298      200
Mitochondrion              0.173   0.445 0.249      200
Nucleus                    0.194   0.475 0.275      200
Peroxisome                 0.214   0.057 0.090      159
Plastid                    0.264   0.550 0.357      200

Contingency table (true x pred):
pred                     0   1  2  3   4  5   6   7   8
true                                                   
Cytoplasm               35  74  3  2   0  0   1  83   2
Endoplasmic reticulum   53  48  1  2   5  0  21  69   1
Extracellular            2  48  5  4  75  0  39  22   5
Golgi apparatus          9  54  0  2   0  0   1  52   8
Lysosome/Vacuole        14  53  1  0   1  1  47  70  13
Mitochondrion           72  89  1  1   0  0   0  35   2
Nucleus                 14  88  1  1   1  0   0  95   0
Peroxisome             107  23  0  1   0  0   3  16   9
Plastid                110  37  0  0   0  0   3  48   2

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      3                      2  ...           2       35
Endoplasmic reticulum          1                      2  ...           1       53
Extracellular                  5                      4  ...           5        2
Golgi apparatus                0                      2  ...           8        9
Lysosome/Vacuole               1                      0  ...          13       14
Mitochondrion                  1                      1  ...           2       72
Nucleus                        1                      1  ...           0       14
Peroxisome                     0                      1  ...           9      107
Plastid                        0                      0  ...           2      110

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              7  0.136738
Endoplasmic reticulum                  7  0.111111
Extracellular                          4  0.362319
Golgi apparatus                        7  0.092199
Lysosome/Vacuole                       6  0.175373
Mitochondrion                          1  0.142400
Nucleus                                7  0.159664
Peroxisome                             0  0.228632
Plastid                                0  0.217391

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0        Peroxisome  0.228632
1     Mitochondrion  0.142400
2     Extracellular  0.024155
3     Extracellular  0.019139
4     Extracellular  0.362319
5  Lysosome/Vacuole  0.005000
6  Lysosome/Vacuole  0.175373
7           Nucleus  0.159664
8  Lysosome/Vacuole  0.056769

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
2                         Cytoplasm  0.014354
3             Endoplasmic reticulum  0.009479
4                     Extracellular  0.362319
5                   Golgi apparatus  0.000000
6                  Lysosome/Vacuole  0.175373
1                     Mitochondrion  0.142400
7                           Nucleus  0.159664
8                        Peroxisome  0.046875
0                           Plastid  0.217391
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_35M_functional
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.0723
NMI = 0.1548
Jaccard macro (true → best cluster) = 0.1821
Jaccard macro (cluster → best true) = 0.1719
Jaccard macro (Hungarian-aligned pairs) = 0.1703
Mapping-based clustering accuracy = 0.2813

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.229   0.135 0.170      200
Endoplasmic reticulum      0.191   0.305 0.235      200
Extracellular              0.837   0.435 0.572      200
Golgi apparatus            0.182   0.349 0.239      126
Lysosome/Vacuole           0.371   0.245 0.295      200
Mitochondrion              0.255   0.355 0.297      200
Nucleus                    0.412   0.175 0.246      200
Peroxisome                 0.215   0.164 0.186      159
Plastid                    0.259   0.370 0.305      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              27   0  50  14  41  25   1  30  12
Endoplasmic reticulum  11  36  12  13  61  30   9  24   4
Extracellular           6  39  10   5  13  27  87   1  12
Golgi apparatus        10   3  44  12  22  20   1   7   7
Lysosome/Vacuole       18  49  41  18  35  26   4   5   4
Mitochondrion          10   0  18  19  27  71   1  49   5
Nucleus                31   0  49   1  25  29   0  30  35
Peroxisome              5   2   3  26  38  18   0  66   1
Plastid                 0   3  15  13  57  32   1  74   5

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     27                     41  ...          14       30
Endoplasmic reticulum         11                     61  ...          13       24
Extracellular                  6                     13  ...           5        1
Golgi apparatus               10                     22  ...          12        7
Lysosome/Vacuole              18                     35  ...          18        5
Mitochondrion                 10                     27  ...          19       49
Nucleus                       31                     25  ...           1       30
Peroxisome                     5                     38  ...          26       66
Plastid                        0                     57  ...          13       74

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.127551
Endoplasmic reticulum                  4  0.133188
Extracellular                          6  0.400922
Golgi apparatus                        2  0.135802
Lysosome/Vacuole                       1  0.173145
Mitochondrion                          5  0.174447
Nucleus                                8  0.140000
Peroxisome                             7  0.174142
Plastid                                7  0.179612

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0                Nucleus  0.108014
1       Lysosome/Vacuole  0.173145
2        Golgi apparatus  0.135802
3             Peroxisome  0.102362
4  Endoplasmic reticulum  0.133188
5          Mitochondrion  0.174447
6          Extracellular  0.400922
7                Plastid  0.179612
8                Nucleus  0.140000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.092784
4             Endoplasmic reticulum  0.133188
6                     Extracellular  0.400922
2                   Golgi apparatus  0.135802
1                  Lysosome/Vacuole  0.173145
5                     Mitochondrion  0.174447
8                           Nucleus  0.140000
3                        Peroxisome  0.102362
7                           Plastid  0.179612
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_35M_functional
Similarity.Geodesic_Clustering.Spectral
ARI = 0.1047
NMI = 0.1889
Jaccard macro (true → best cluster) = 0.2155
Jaccard macro (cluster → best true) = 0.2116
Jaccard macro (Hungarian-aligned pairs) = 0.2097
Mapping-based clustering accuracy = 0.3359

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.194   0.155 0.172      200
Endoplasmic reticulum      0.138   0.090 0.109      200
Extracellular              0.787   0.425 0.552      200
Golgi apparatus            0.164   0.373 0.228      126
Lysosome/Vacuole           0.446   0.290 0.352      200
Mitochondrion              0.338   0.360 0.349      200
Nucleus                    0.395   0.405 0.400      200
Peroxisome                 0.433   0.465 0.448      159
Plastid                    0.356   0.500 0.416      200

Contingency table (true x pred):
pred                    0    1   2   3   4   5   6   7   8
true                                                      
Cytoplasm              48   33   0   1  15  31  35  23  14
Endoplasmic reticulum  42   28  25  15  21  23  12  18  16
Extracellular          15    3  35  85   0  11  12  15  24
Golgi apparatus        47    9   4   1   4   9  32  14   6
Lysosome/Vacuole       52    8  58   4   3  25  15  23  12
Mitochondrion          22   39   0   1  32  16  12   6  72
Nucleus                40   30   0   1   1  25  81  15   7
Peroxisome             15   31   2   0  74  19   3   1  14
Plastid                 6  100   6   0  21   1   3  15  48

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     31                     23  ...          15       33
Endoplasmic reticulum         23                     18  ...          21       28
Extracellular                 11                     15  ...           0        3
Golgi apparatus                9                     14  ...           4        9
Lysosome/Vacuole              25                     23  ...           3        8
Mitochondrion                 16                      6  ...          32       39
Nucleus                       25                     15  ...           1       30
Peroxisome                    19                      1  ...          74       31
Plastid                        1                     15  ...          21      100

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              0  0.109339
Endoplasmic reticulum                  0  0.094382
Extracellular                          3  0.381166
Golgi apparatus                        0  0.128415
Lysosome/Vacuole                       2  0.213235
Mitochondrion                          8  0.211144
Nucleus                                6  0.250000
Peroxisome                             4  0.289062
Plastid                                1  0.262467

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0   Golgi apparatus  0.128415
1           Plastid  0.262467
2  Lysosome/Vacuole  0.213235
3     Extracellular  0.381166
4        Peroxisome  0.289062
5         Cytoplasm  0.094225
6           Nucleus  0.250000
7         Cytoplasm  0.074919
8     Mitochondrion  0.211144

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
5                         Cytoplasm  0.094225
7             Endoplasmic reticulum  0.057692
3                     Extracellular  0.381166
0                   Golgi apparatus  0.128415
2                  Lysosome/Vacuole  0.213235
8                     Mitochondrion  0.211144
6                           Nucleus  0.250000
4                        Peroxisome  0.289062
1                           Plastid  0.262467
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_150M_functional
Similarity.Cosine_Clustering.Hierarchical
ARI = -0.0003
NMI = 0.0218
Jaccard macro (true → best cluster) = 0.1100
Jaccard macro (cluster → best true) = 0.0322
Jaccard macro (Hungarian-aligned pairs) = 0.0305
Mapping-based clustering accuracy = 0.1371

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  1.000   0.005 0.010      200
Endoplasmic reticulum      0.250   0.015 0.028      200
Extracellular              0.429   0.030 0.056      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.175   0.050 0.078      200
Mitochondrion              0.000   0.000 0.000      200
Nucleus                    0.264   0.070 0.111      200
Peroxisome                 0.000   0.000 0.000      159
Plastid                    0.128   0.985 0.226      200

Contingency table (true x pred):
pred                   0    1   2  3  4  5  6  7   8
true                                                
Cytoplasm              2  175  10  0  0  1  1  0  11
Endoplasmic reticulum  3  179  10  2  1  0  1  0   4
Extracellular          1  177   5  6  0  0  0  0  11
Golgi apparatus        0  119   2  0  0  0  0  0   5
Lysosome/Vacuole       2  182  10  1  1  0  1  0   3
Mitochondrion          1  188   8  1  0  0  0  0   2
Nucleus                2  174   4  4  1  0  0  1  14
Peroxisome             1  150   5  0  0  0  0  0   3
Plastid                0  197   3  0  0  0  0  0   0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      1                      2  ...           1      175
Endoplasmic reticulum          0                      3  ...           1      179
Extracellular                  0                      1  ...           0      177
Golgi apparatus                0                      0  ...           0      119
Lysosome/Vacuole               0                      2  ...           1      182
Mitochondrion                  0                      1  ...           0      188
Nucleus                        0                      2  ...           0      174
Peroxisome                     0                      1  ...           0      150
Plastid                        0                      0  ...           0      197

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.111750
Endoplasmic reticulum                  1  0.114597
Extracellular                          1  0.113171
Golgi apparatus                        1  0.076873
Lysosome/Vacuole                       1  0.116742
Mitochondrion                          1  0.121056
Nucleus                                1  0.111040
Peroxisome                             1  0.096774
Plastid                                1  0.127591

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0  Endoplasmic reticulum  0.014354
1                Plastid  0.127591
2              Cytoplasm  0.040486
3          Extracellular  0.028846
4  Endoplasmic reticulum  0.004950
5              Cytoplasm  0.005000
6              Cytoplasm  0.004950
7                Nucleus  0.005000
8                Nucleus  0.058577

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
5                         Cytoplasm  0.005000
0             Endoplasmic reticulum  0.014354
3                     Extracellular  0.028846
4                   Golgi apparatus  0.000000
2                  Lysosome/Vacuole  0.040486
7                     Mitochondrion  0.000000
8                           Nucleus  0.058577
6                        Peroxisome  0.000000
1                           Plastid  0.127591
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_150M_functional
Similarity.Cosine_Clustering.Kmeans
ARI = 0.1008
NMI = 0.1884
Jaccard macro (true → best cluster) = 0.2119
Jaccard macro (cluster → best true) = 0.2104
Jaccard macro (Hungarian-aligned pairs) = 0.2025
Mapping-based clustering accuracy = 0.3187

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.197   0.320 0.244      200
Endoplasmic reticulum      0.174   0.240 0.202      200
Extracellular              0.733   0.330 0.455      200
Golgi apparatus            0.082   0.071 0.076      126
Lysosome/Vacuole           0.373   0.310 0.339      200
Mitochondrion              0.234   0.230 0.232      200
Nucleus                    0.401   0.315 0.353      200
Peroxisome                 0.319   0.434 0.368      159
Plastid                    0.743   0.550 0.632      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6    7   8
true                                                      
Cytoplasm              29  64  30   0  25  20   3   12  17
Endoplasmic reticulum   8  40  48  40  18  17   8    4  17
Extracellular          11   9  12  53   3  10  66    0  36
Golgi apparatus        21  46  18   8   8   9   1    1  14
Lysosome/Vacuole       14  37  33  62   9  18   5    0  22
Mitochondrion           5  42  39   0  44  15   4    5  46
Nucleus                63  61  20   0   9  17   2   12  16
Peroxisome              4   7  58   1  69   4   0    4  12
Plastid                 2  19  18   2  31   0   1  110  17

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     64                     30  ...          25       12
Endoplasmic reticulum         40                     48  ...          18        4
Extracellular                  9                     12  ...           3        0
Golgi apparatus               46                     18  ...           8        1
Lysosome/Vacuole              37                     33  ...           9        0
Mitochondrion                 42                     39  ...          44        5
Nucleus                       61                     20  ...           9       12
Peroxisome                     7                     58  ...          69        4
Plastid                       19                     18  ...          31      110

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.138829
Endoplasmic reticulum                  3  0.122699
Extracellular                          6  0.294643
Golgi apparatus                        1  0.113580
Lysosome/Vacuole                       3  0.203947
Mitochondrion                          8  0.131054
Nucleus                                0  0.214286
Peroxisome                             4  0.225490
Plastid                                7  0.462185

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.214286
1         Cytoplasm  0.138829
2        Peroxisome  0.153846
3  Lysosome/Vacuole  0.203947
4        Peroxisome  0.225490
5         Cytoplasm  0.068966
6     Extracellular  0.294643
7           Plastid  0.462185
8     Mitochondrion  0.131054

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.138829
2             Endoplasmic reticulum  0.112150
6                     Extracellular  0.294643
5                   Golgi apparatus  0.039648
3                  Lysosome/Vacuole  0.203947
8                     Mitochondrion  0.131054
0                           Nucleus  0.214286
4                        Peroxisome  0.225490
7                           Plastid  0.462185
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_150M_functional
Similarity.Cosine_Clustering.Spectral
ARI = 0.1518
NMI = 0.2172
Jaccard macro (true → best cluster) = 0.2435
Jaccard macro (cluster → best true) = 0.2413
Jaccard macro (Hungarian-aligned pairs) = 0.2368
Mapping-based clustering accuracy = 0.3585

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.158   0.190 0.173      200
Endoplasmic reticulum      0.132   0.095 0.110      200
Extracellular              0.725   0.580 0.644      200
Golgi apparatus            0.166   0.214 0.187      126
Lysosome/Vacuole           0.353   0.330 0.341      200
Mitochondrion              0.438   0.300 0.356      200
Nucleus                    0.375   0.345 0.359      200
Peroxisome                 0.214   0.358 0.268      159
Plastid                    0.745   0.760 0.752      200

Contingency table (true x pred):
pred                    0   1    2   3    4   5   6   7   8
true                                                       
Cytoplasm              49  23    1  27    6   2  39  38  15
Endoplasmic reticulum  28  27   24  19   12  34  11  28  17
Extracellular           3   3  116  10    1  41  11  11   4
Golgi apparatus        30  27    5   9    1   8  19  26   1
Lysosome/Vacuole       25  21   11  21    2  66  25  28   1
Mitochondrion          41  13    0  25   10   3   5  43  60
Nucleus                22  27    3  25    8   0  69  34  12
Peroxisome             57  19    0   8   12  25   3  21  14
Plastid                11   3    0   0  152   8   2  11  13

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     38                     27  ...          49        6
Endoplasmic reticulum         28                     19  ...          28       12
Extracellular                 11                     10  ...           3        1
Golgi apparatus               26                      9  ...          30        1
Lysosome/Vacuole              28                     21  ...          25        2
Mitochondrion                 43                     25  ...          41       10
Nucleus                       34                     25  ...          22        8
Peroxisome                    21                      8  ...          57       12
Plastid                       11                      0  ...          11      152

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              0  0.117506
Endoplasmic reticulum                  5  0.096317
Extracellular                          2  0.475410
Golgi apparatus                        1  0.103053
Lysosome/Vacuole                       5  0.205607
Mitochondrion                          8  0.216606
Nucleus                                6  0.219048
Peroxisome                             0  0.154891
Plastid                                4  0.603175

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0        Peroxisome  0.154891
1   Golgi apparatus  0.103053
2     Extracellular  0.475410
3         Cytoplasm  0.085174
4           Plastid  0.603175
5  Lysosome/Vacuole  0.205607
6           Nucleus  0.219048
7     Mitochondrion  0.108312
8     Mitochondrion  0.216606

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
7                         Cytoplasm  0.094527
3             Endoplasmic reticulum  0.058462
2                     Extracellular  0.475410
1                   Golgi apparatus  0.103053
5                  Lysosome/Vacuole  0.205607
8                     Mitochondrion  0.216606
6                           Nucleus  0.219048
0                        Peroxisome  0.154891
4                           Plastid  0.603175
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_150M_functional
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0211
NMI = 0.0585
Jaccard macro (true → best cluster) = 0.1322
Jaccard macro (cluster → best true) = 0.0591
Jaccard macro (Hungarian-aligned pairs) = 0.0554
Mapping-based clustering accuracy = 0.1911

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.320   0.040 0.071      200
Endoplasmic reticulum      0.200   0.050 0.080      200
Extracellular              0.277   0.595 0.378      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.167   0.015 0.028      200
Mitochondrion              0.100   0.005 0.010      200
Nucleus                    0.300   0.015 0.029      200
Peroxisome                 0.000   0.000 0.000      159
Plastid                    0.157   0.890 0.266      200

Contingency table (true x pred):
pred                   0    1    2  3  4  5  6   7  8
true                                                 
Cytoplasm              1   48  130  1  1  1  8   8  2
Endoplasmic reticulum  3   27  152  3  1  0  3  10  1
Extracellular          1  119   65  6  0  0  1   6  2
Golgi apparatus        0   38   82  0  0  0  3   2  1
Lysosome/Vacuole       1   36  147  3  1  0  3   9  0
Mitochondrion          1   57  133  1  0  0  1   7  0
Nucleus                2   76  108  4  1  0  3   3  3
Peroxisome             1   10  142  0  0  0  3   2  1
Plastid                0   19  178  0  0  0  0   3  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      8                      8  ...           1      130
Endoplasmic reticulum          3                     10  ...           1      152
Extracellular                  1                      6  ...           0       65
Golgi apparatus                3                      2  ...           0       82
Lysosome/Vacuole               3                      9  ...           1      147
Mitochondrion                  1                      7  ...           0      133
Nucleus                        3                      3  ...           1      108
Peroxisome                     3                      2  ...           0      142
Plastid                        0                      3  ...           0      178

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.107705
Endoplasmic reticulum                  2  0.128270
Extracellular                          1  0.232877
Golgi apparatus                        1  0.073359
Lysosome/Vacuole                       2  0.123529
Mitochondrion                          2  0.110465
Nucleus                                1  0.137184
Peroxisome                             2  0.123050
Plastid                                2  0.153581

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0  Endoplasmic reticulum  0.014493
1          Extracellular  0.232877
2                Plastid  0.153581
3          Extracellular  0.028302
4              Cytoplasm  0.004926
5              Cytoplasm  0.005000
6              Cytoplasm  0.036866
7  Endoplasmic reticulum  0.041667
8                Nucleus  0.014493

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
6                         Cytoplasm  0.036866
7             Endoplasmic reticulum  0.041667
1                     Extracellular  0.232877
5                   Golgi apparatus  0.000000
3                  Lysosome/Vacuole  0.013953
0                     Mitochondrion  0.004785
8                           Nucleus  0.014493
4                        Peroxisome  0.000000
2                           Plastid  0.153581
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_150M_functional
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.1008
NMI = 0.1884
Jaccard macro (true → best cluster) = 0.2119
Jaccard macro (cluster → best true) = 0.2104
Jaccard macro (Hungarian-aligned pairs) = 0.2025
Mapping-based clustering accuracy = 0.3187

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.197   0.320 0.244      200
Endoplasmic reticulum      0.174   0.240 0.202      200
Extracellular              0.733   0.330 0.455      200
Golgi apparatus            0.082   0.071 0.076      126
Lysosome/Vacuole           0.373   0.310 0.339      200
Mitochondrion              0.234   0.230 0.232      200
Nucleus                    0.401   0.315 0.353      200
Peroxisome                 0.319   0.434 0.368      159
Plastid                    0.743   0.550 0.632      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6    7   8
true                                                      
Cytoplasm              29  64  30   0  25  20   3   12  17
Endoplasmic reticulum   8  40  48  40  18  17   8    4  17
Extracellular          11   9  12  53   3  10  66    0  36
Golgi apparatus        21  46  18   8   8   9   1    1  14
Lysosome/Vacuole       14  37  33  62   9  18   5    0  22
Mitochondrion           5  42  39   0  44  15   4    5  46
Nucleus                63  61  20   0   9  17   2   12  16
Peroxisome              4   7  58   1  69   4   0    4  12
Plastid                 2  19  18   2  31   0   1  110  17

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     64                     30  ...          25       12
Endoplasmic reticulum         40                     48  ...          18        4
Extracellular                  9                     12  ...           3        0
Golgi apparatus               46                     18  ...           8        1
Lysosome/Vacuole              37                     33  ...           9        0
Mitochondrion                 42                     39  ...          44        5
Nucleus                       61                     20  ...           9       12
Peroxisome                     7                     58  ...          69        4
Plastid                       19                     18  ...          31      110

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.138829
Endoplasmic reticulum                  3  0.122699
Extracellular                          6  0.294643
Golgi apparatus                        1  0.113580
Lysosome/Vacuole                       3  0.203947
Mitochondrion                          8  0.131054
Nucleus                                0  0.214286
Peroxisome                             4  0.225490
Plastid                                7  0.462185

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.214286
1         Cytoplasm  0.138829
2        Peroxisome  0.153846
3  Lysosome/Vacuole  0.203947
4        Peroxisome  0.225490
5         Cytoplasm  0.068966
6     Extracellular  0.294643
7           Plastid  0.462185
8     Mitochondrion  0.131054

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.138829
2             Endoplasmic reticulum  0.112150
6                     Extracellular  0.294643
5                   Golgi apparatus  0.039648
3                  Lysosome/Vacuole  0.203947
8                     Mitochondrion  0.131054
0                           Nucleus  0.214286
4                        Peroxisome  0.225490
7                           Plastid  0.462185
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_150M_functional
Similarity.Euclidean_Clustering.Spectral
ARI = 0.1453
NMI = 0.2201
Jaccard macro (true → best cluster) = 0.2331
Jaccard macro (cluster → best true) = 0.2247
Jaccard macro (Hungarian-aligned pairs) = 0.2171
Mapping-based clustering accuracy = 0.3436

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.236   0.305 0.266      200
Endoplasmic reticulum      0.143   0.110 0.124      200
Extracellular              0.475   0.380 0.422      200
Golgi apparatus            0.097   0.103 0.100      126
Lysosome/Vacuole           0.326   0.355 0.340      200
Mitochondrion              0.329   0.255 0.287      200
Nucleus                    0.407   0.330 0.365      200
Peroxisome                 0.288   0.472 0.358      159
Plastid                    0.783   0.720 0.750      200

Contingency table (true x pred):
pred                    0   1   2   3   4    5   6   7   8
true                                                      
Cytoplasm               1  30  11  61  37    7  16   8  29
Endoplasmic reticulum  46  32  16  28   8    8   7  33  22
Extracellular          76   7  18   1   8    2   2  76  10
Golgi apparatus        13  18  13  47  18    1   6   2   8
Lysosome/Vacuole       71  21  16  43  16    0   4   6  23
Mitochondrion           3  39  25  25   5    9  51  17  26
Nucleus                 0  18  23  41  66    6   4  14  28
Peroxisome              4  75  10   9   3    7  42   1   8
Plastid                 4  20   2   3   1  144  23   3   0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     61                     29  ...          30        7
Endoplasmic reticulum         28                     22  ...          32        8
Extracellular                  1                     10  ...           7        2
Golgi apparatus               47                      8  ...          18        1
Lysosome/Vacuole              43                     23  ...          21        0
Mitochondrion                 25                     26  ...          39        9
Nucleus                       41                     28  ...          18        6
Peroxisome                     9                      8  ...          75        7
Plastid                        3                      0  ...          20      144

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              3  0.153652
Endoplasmic reticulum                  0  0.123656
Extracellular                          7  0.267606
Golgi apparatus                        3  0.139466
Lysosome/Vacuole                       0  0.204611
Mitochondrion                          6  0.167763
Nucleus                                4  0.222973
Peroxisome                             1  0.218023
Plastid                                5  0.600000

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0   Extracellular  0.222222
1      Peroxisome  0.218023
2   Mitochondrion  0.080906
3       Cytoplasm  0.153652
4         Nucleus  0.222973
5         Plastid  0.600000
6   Mitochondrion  0.167763
7   Extracellular  0.267606
8       Cytoplasm  0.089231

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.153652
8             Endoplasmic reticulum  0.066265
7                     Extracellular  0.267606
2                   Golgi apparatus  0.052632
0                  Lysosome/Vacuole  0.204611
6                     Mitochondrion  0.167763
4                           Nucleus  0.222973
1                        Peroxisome  0.218023
5                           Plastid  0.600000
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_150M_functional
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0547
NMI = 0.1581
Jaccard macro (true → best cluster) = 0.1752
Jaccard macro (cluster → best true) = 0.1232
Jaccard macro (Hungarian-aligned pairs) = 0.1196
Mapping-based clustering accuracy = 0.2427

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.148   0.020 0.035      200
Endoplasmic reticulum      0.294   0.025 0.046      200
Extracellular              0.857   0.390 0.536      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.391   0.250 0.305      200
Mitochondrion              0.219   0.265 0.240      200
Nucleus                    0.154   0.560 0.241      200
Peroxisome                 0.240   0.673 0.354      159
Plastid                    0.000   0.000 0.000      200

Contingency table (true x pred):
pred                   0   1   2   3  4    5  6  7    8
true                                                   
Cytoplasm              4  33   3   1  1  108  0  1   49
Endoplasmic reticulum  3  19   6  32  1   87  5  0   47
Extracellular          5  27  78  41  1   46  1  0    1
Golgi apparatus        2  18   0   0  0   84  4  0   18
Lysosome/Vacuole       4  24   1  50  0   94  3  1   23
Mitochondrion          2  53   1   0  0   61  1  0   82
Nucleus                4  57   2   0  1  112  1  0   23
Peroxisome             3   9   0   2  1   35  2  0  107
Plastid                0   2   0   2  0  101  0  0   95

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      4                      0  ...          49        1
Endoplasmic reticulum          3                      5  ...          47        1
Extracellular                  5                      1  ...           1        1
Golgi apparatus                2                      4  ...          18        0
Lysosome/Vacuole               4                      3  ...          23        0
Mitochondrion                  2                      1  ...          82        0
Nucleus                        4                      1  ...          23        1
Peroxisome                     3                      2  ...         107        1
Plastid                        0                      0  ...          95        0

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              5  0.131707
Endoplasmic reticulum                  3  0.108108
Extracellular                          2  0.366197
Golgi apparatus                        5  0.109091
Lysosome/Vacuole                       3  0.179856
Mitochondrion                          8  0.145648
Nucleus                                1  0.148052
Peroxisome                             8  0.215292
Plastid                                8  0.172727

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0     Extracellular  0.022523
1           Nucleus  0.148052
2     Extracellular  0.366197
3  Lysosome/Vacuole  0.179856
4        Peroxisome  0.006135
5           Nucleus  0.137255
6   Golgi apparatus  0.028777
7         Cytoplasm  0.004975
8        Peroxisome  0.215292

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
0                         Cytoplasm  0.017937
6             Endoplasmic reticulum  0.023585
2                     Extracellular  0.366197
7                   Golgi apparatus  0.000000
3                  Lysosome/Vacuole  0.179856
1                     Mitochondrion  0.136247
5                           Nucleus  0.137255
8                        Peroxisome  0.215292
4                           Plastid  0.000000
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_150M_functional
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.1008
NMI = 0.1884
Jaccard macro (true → best cluster) = 0.2119
Jaccard macro (cluster → best true) = 0.2104
Jaccard macro (Hungarian-aligned pairs) = 0.2025
Mapping-based clustering accuracy = 0.3187

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.197   0.320 0.244      200
Endoplasmic reticulum      0.174   0.240 0.202      200
Extracellular              0.733   0.330 0.455      200
Golgi apparatus            0.082   0.071 0.076      126
Lysosome/Vacuole           0.373   0.310 0.339      200
Mitochondrion              0.234   0.230 0.232      200
Nucleus                    0.401   0.315 0.353      200
Peroxisome                 0.319   0.434 0.368      159
Plastid                    0.743   0.550 0.632      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6    7   8
true                                                      
Cytoplasm              29  64  30   0  25  20   3   12  17
Endoplasmic reticulum   8  40  48  40  18  17   8    4  17
Extracellular          11   9  12  53   3  10  66    0  36
Golgi apparatus        21  46  18   8   8   9   1    1  14
Lysosome/Vacuole       14  37  33  62   9  18   5    0  22
Mitochondrion           5  42  39   0  44  15   4    5  46
Nucleus                63  61  20   0   9  17   2   12  16
Peroxisome              4   7  58   1  69   4   0    4  12
Plastid                 2  19  18   2  31   0   1  110  17

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     64                     30  ...          25       12
Endoplasmic reticulum         40                     48  ...          18        4
Extracellular                  9                     12  ...           3        0
Golgi apparatus               46                     18  ...           8        1
Lysosome/Vacuole              37                     33  ...           9        0
Mitochondrion                 42                     39  ...          44        5
Nucleus                       61                     20  ...           9       12
Peroxisome                     7                     58  ...          69        4
Plastid                       19                     18  ...          31      110

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.138829
Endoplasmic reticulum                  3  0.122699
Extracellular                          6  0.294643
Golgi apparatus                        1  0.113580
Lysosome/Vacuole                       3  0.203947
Mitochondrion                          8  0.131054
Nucleus                                0  0.214286
Peroxisome                             4  0.225490
Plastid                                7  0.462185

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Nucleus  0.214286
1         Cytoplasm  0.138829
2        Peroxisome  0.153846
3  Lysosome/Vacuole  0.203947
4        Peroxisome  0.225490
5         Cytoplasm  0.068966
6     Extracellular  0.294643
7           Plastid  0.462185
8     Mitochondrion  0.131054

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.138829
2             Endoplasmic reticulum  0.112150
6                     Extracellular  0.294643
5                   Golgi apparatus  0.039648
3                  Lysosome/Vacuole  0.203947
8                     Mitochondrion  0.131054
0                           Nucleus  0.214286
4                        Peroxisome  0.225490
7                           Plastid  0.462185
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_150M_functional
Similarity.Geodesic_Clustering.Spectral
ARI = 0.1692
NMI = 0.2573
Jaccard macro (true → best cluster) = 0.2518
Jaccard macro (cluster → best true) = 0.2564
Jaccard macro (Hungarian-aligned pairs) = 0.2447
Mapping-based clustering accuracy = 0.3668

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.213   0.295 0.247      200
Endoplasmic reticulum      0.196   0.220 0.208      200
Extracellular              0.880   0.440 0.587      200
Golgi apparatus            0.097   0.135 0.113      126
Lysosome/Vacuole           0.368   0.355 0.361      200
Mitochondrion              0.289   0.240 0.262      200
Nucleus                    0.403   0.310 0.350      200
Peroxisome                 0.375   0.434 0.402      159
Plastid                    0.755   0.800 0.777      200

Contingency table (true x pred):
pred                     0   1   2   3   4   5   6   7   8
true                                                      
Cytoplasm               10  32  29  20   0   2  59  28  20
Endoplasmic reticulum    6  16  44  12  42   8  47  10  15
Extracellular            0  10   2   2  65  88   5  12  16
Golgi apparatus          0  17  16   6   9   0  43  21  14
Lysosome/Vacuole         1  32  20   5  71   2  38  10  21
Mitochondrion           22  25  30  50   0   0  19   6  48
Nucleus                  8  37  17   4   0   0  54  62  18
Peroxisome               5   6  56  69   2   0   8   3  10
Plastid                160   0  10  16   4   0   4   2   4

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     59                     29  ...          20       10
Endoplasmic reticulum         47                     44  ...          12        6
Extracellular                  5                      2  ...           2        0
Golgi apparatus               43                     16  ...           6        0
Lysosome/Vacuole              38                     20  ...           5        1
Mitochondrion                 19                     30  ...          50       22
Nucleus                       54                     17  ...           4        8
Peroxisome                     8                     56  ...          69        5
Plastid                        4                     10  ...          16      160

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              6  0.141148
Endoplasmic reticulum                  4  0.119658
Extracellular                          5  0.415094
Golgi apparatus                        6  0.119444
Lysosome/Vacuole                       4  0.220497
Mitochondrion                          8  0.150943
Nucleus                                7  0.212329
Peroxisome                             3  0.251825
Plastid                                0  0.634921

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Plastid  0.634921
1           Nucleus  0.109467
2        Peroxisome  0.171254
3        Peroxisome  0.251825
4  Lysosome/Vacuole  0.220497
5     Extracellular  0.415094
6         Cytoplasm  0.141148
7           Nucleus  0.212329
8     Mitochondrion  0.150943

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
6                         Cytoplasm  0.141148
2             Endoplasmic reticulum  0.115789
5                     Extracellular  0.415094
1                   Golgi apparatus  0.059859
4                  Lysosome/Vacuole  0.220497
8                     Mitochondrion  0.150943
7                           Nucleus  0.212329
3                        Peroxisome  0.251825
0                           Plastid  0.634921
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
prot_bert_functional
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0141
NMI = 0.0446
Jaccard macro (true → best cluster) = 0.1137
Jaccard macro (cluster → best true) = 0.0606
Jaccard macro (Hungarian-aligned pairs) = 0.0582
Mapping-based clustering accuracy = 0.1828

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.296   0.040 0.070      200
Endoplasmic reticulum      0.193   0.085 0.118      200
Extracellular              0.179   0.855 0.296      200
Golgi apparatus            0.500   0.008 0.016      126
Lysosome/Vacuole           0.000   0.000 0.000      200
Mitochondrion              0.174   0.145 0.158      200
Nucleus                    0.273   0.015 0.028      200
Peroxisome                 0.000   0.000 0.000      159
Plastid                    0.184   0.395 0.251      200

Contingency table (true x pred):
pred                   0  1    2   3   4  5  6  7   8
true                                                 
Cytoplasm              1  8  112  12  24  1  0  1  41
Endoplasmic reticulum  4  3   99  17  22  0  0  0  55
Extracellular          1  0  171   3   8  0  0  0  17
Golgi apparatus        0  6   66  13  14  0  1  0  26
Lysosome/Vacuole       1  5   97  15  25  0  1  0  56
Mitochondrion          1  0   98  12  29  0  0  1  59
Nucleus                3  4  122  14  23  0  0  0  34
Peroxisome             0  0   74   2  20  0  0  0  63
Plastid                0  1  118   0   2  0  0  0  79

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      8                     12  ...           1       41
Endoplasmic reticulum          3                     17  ...           0       55
Extracellular                  0                      3  ...           0       17
Golgi apparatus                6                     13  ...           0       26
Lysosome/Vacuole               5                     15  ...           0       56
Mitochondrion                  0                     12  ...           0       59
Nucleus                        4                     14  ...           0       34
Peroxisome                     0                      2  ...           0       63
Plastid                        1                      0  ...           0       79

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.107177
Endoplasmic reticulum                  8  0.095652
Extracellular                          2  0.173428
Golgi apparatus                        2  0.064897
Lysosome/Vacuole                       8  0.097561
Mitochondrion                          8  0.103327
Nucleus                                2  0.117874
Peroxisome                             8  0.119772
Plastid                                8  0.143376

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0  Endoplasmic reticulum  0.019324
1        Golgi apparatus  0.040816
2          Extracellular  0.173428
3        Golgi apparatus  0.064677
4          Mitochondrion  0.085799
5              Cytoplasm  0.005000
6        Golgi apparatus  0.007874
7              Cytoplasm  0.004975
8                Plastid  0.143376

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
1                         Cytoplasm  0.036530
3             Endoplasmic reticulum  0.062731
2                     Extracellular  0.173428
6                   Golgi apparatus  0.007874
7                  Lysosome/Vacuole  0.000000
4                     Mitochondrion  0.085799
0                           Nucleus  0.014423
5                        Peroxisome  0.000000
8                           Plastid  0.143376
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
prot_bert_functional
Similarity.Cosine_Clustering.Kmeans
ARI = 0.0336
NMI = 0.0757
Jaccard macro (true → best cluster) = 0.1173
Jaccard macro (cluster → best true) = 0.1270
Jaccard macro (Hungarian-aligned pairs) = 0.1136
Mapping-based clustering accuracy = 0.2042

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.129   0.100 0.113      200
Endoplasmic reticulum      0.167   0.195 0.180      200
Extracellular              0.395   0.160 0.228      200
Golgi apparatus            0.171   0.159 0.165      126
Lysosome/Vacuole           0.170   0.180 0.175      200
Mitochondrion              0.176   0.170 0.173      200
Nucleus                    0.181   0.230 0.203      200
Peroxisome                 0.223   0.314 0.261      159
Plastid                    0.312   0.335 0.323      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              26  33  32  16  16  20  26  26   5
Endoplasmic reticulum  25  29  13  20  29  12  39  31   2
Extracellular          11  53  17   4   7  43  28   5  32
Golgi apparatus        21  25  10  20   5  19  11  11   4
Lysosome/Vacuole       36  29  25  21  26  16  18  20   9
Mitochondrion          33  31  15   9  27  15  28  34   8
Nucleus                24  46  18  26  11  24  23  11  17
Peroxisome             18   5  18   1  50   3  24  37   3
Plastid                18   3  67   0  53   3  37  18   1

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     20                     26  ...          16       32
Endoplasmic reticulum         12                     39  ...          29       13
Extracellular                 43                     28  ...           7       17
Golgi apparatus               19                     11  ...           5       10
Lysosome/Vacuole              16                     18  ...          26       25
Mitochondrion                 15                     28  ...          27       15
Nucleus                       24                     23  ...          11       18
Peroxisome                     3                     24  ...          50       18
Plastid                        3                     37  ...          53       67

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.083551
Endoplasmic reticulum                  6  0.098734
Extracellular                          5  0.137821
Golgi apparatus                        3  0.089686
Lysosome/Vacuole                       0  0.095745
Mitochondrion                          7  0.094708
Nucleus                                1  0.112745
Peroxisome                             4  0.150150
Plastid                                2  0.192529

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0       Lysosome/Vacuole  0.095745
1          Extracellular  0.132170
2                Plastid  0.192529
3        Golgi apparatus  0.089686
4             Peroxisome  0.150150
5          Extracellular  0.137821
6  Endoplasmic reticulum  0.098734
7             Peroxisome  0.117460
8          Extracellular  0.128514

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
5                         Cytoplasm  0.059701
6             Endoplasmic reticulum  0.098734
8                     Extracellular  0.128514
3                   Golgi apparatus  0.089686
0                  Lysosome/Vacuole  0.095745
7                     Mitochondrion  0.094708
1                           Nucleus  0.112745
4                        Peroxisome  0.150150
2                           Plastid  0.192529
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
prot_bert_functional
Similarity.Cosine_Clustering.Spectral
ARI = 0.0692
NMI = 0.1123
Jaccard macro (true → best cluster) = 0.1587
Jaccard macro (cluster → best true) = 0.1496
Jaccard macro (Hungarian-aligned pairs) = 0.1432
Mapping-based clustering accuracy = 0.2540

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.188   0.120 0.146      200
Endoplasmic reticulum      0.190   0.155 0.171      200
Extracellular              0.314   0.440 0.367      200
Golgi apparatus            0.226   0.238 0.232      126
Lysosome/Vacuole           0.176   0.115 0.139      200
Mitochondrion              0.176   0.315 0.226      200
Nucleus                    0.150   0.100 0.120      200
Peroxisome                 0.210   0.164 0.184      159
Plastid                    0.523   0.615 0.566      200

Contingency table (true x pred):
pred                     0   1   2   3   4   5   6   7   8
true                                                      
Cytoplasm               10  38  41  12  35  10  16  14  24
Endoplasmic reticulum   12  23  58  21  11  18  11  31  15
Extracellular            1  88  27   4   2   3  35  34   6
Golgi apparatus          7  28  26  14  30   4   4   5   8
Lysosome/Vacuole         6  27  36  15  27  11  23  32  23
Mitochondrion           21  16  63  15   5  22  23  16  19
Nucleus                 32  50  35  20  22   9  11   4  17
Peroxisome              23   6  49  18   0  26   7  21   9
Plastid                123   4  23  14   1  21   1   6   7

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     24                     14  ...          10       10
Endoplasmic reticulum         15                     31  ...          18       12
Extracellular                  6                     34  ...           3        1
Golgi apparatus                8                      5  ...           4        7
Lysosome/Vacuole              23                     32  ...          11        6
Mitochondrion                 19                     16  ...          22       21
Nucleus                       17                      4  ...           9       32
Peroxisome                     9                     21  ...          26       23
Plastid                        7                      6  ...          21      123

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              4  0.117450
Endoplasmic reticulum                  2  0.116000
Extracellular                          1  0.224490
Golgi apparatus                        4  0.131004
Lysosome/Vacuole                       7  0.096677
Mitochondrion                          2  0.127273
Nucleus                                1  0.116279
Peroxisome                             2  0.104701
Plastid                                0  0.394231

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0                Plastid  0.394231
1          Extracellular  0.224490
2          Mitochondrion  0.127273
3  Endoplasmic reticulum  0.067308
4        Golgi apparatus  0.131004
5             Peroxisome  0.101167
6          Extracellular  0.118243
7          Extracellular  0.103343
8              Cytoplasm  0.078947

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
8                         Cytoplasm  0.078947
7             Endoplasmic reticulum  0.093373
1                     Extracellular  0.224490
4                   Golgi apparatus  0.131004
6                  Lysosome/Vacuole  0.074675
2                     Mitochondrion  0.127273
3                           Nucleus  0.063898
5                        Peroxisome  0.101167
0                           Plastid  0.394231
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
prot_bert_functional
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0238
NMI = 0.0566
Jaccard macro (true → best cluster) = 0.1178
Jaccard macro (cluster → best true) = 0.0931
Jaccard macro (Hungarian-aligned pairs) = 0.0833
Mapping-based clustering accuracy = 0.1834

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.145   0.115 0.128      200
Endoplasmic reticulum      0.165   0.235 0.194      200
Extracellular              0.251   0.240 0.246      200
Golgi apparatus            0.111   0.008 0.015      126
Lysosome/Vacuole           0.000   0.000 0.000      200
Mitochondrion              0.200   0.005 0.010      200
Nucleus                    0.148   0.260 0.188      200
Peroxisome                 0.143   0.371 0.207      159
Plastid                    0.295   0.390 0.336      200

Contingency table (true x pred):
pred                   0   1   2   3  4  5   6   7   8
true                                                  
Cytoplasm              1  44  36  23  3  1  39  26  27
Endoplasmic reticulum  1  47  54  13  0  2  45  18  20
Extracellular          1   9  20  39  0  2  56  48  25
Golgi apparatus        0  32  26  20  1  0  20  18   9
Lysosome/Vacuole       1  38  57  17  1  0  32  20  34
Mitochondrion          1  36  58  16  1  0  39  25  24
Nucleus                0  36  34  26  3  2  52  30  17
Peroxisome             0  36  59   2  0  1  26   5  30
Plastid                0   7  68   3  0  0  43   1  78

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     23                     44  ...          36       27
Endoplasmic reticulum         13                     47  ...          54       20
Extracellular                 39                      9  ...          20       25
Golgi apparatus               20                     32  ...          26        9
Lysosome/Vacuole              17                     38  ...          57       34
Mitochondrion                 16                     36  ...          58       24
Nucleus                       26                     36  ...          34       17
Peroxisome                     2                     36  ...          59       30
Plastid                        3                      7  ...          68       78

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              1  0.099773
Endoplasmic reticulum                  1  0.107306
Extracellular                          7  0.139942
Golgi apparatus                        1  0.084433
Lysosome/Vacuole                       2  0.102703
Mitochondrion                          2  0.104693
Nucleus                                6  0.104000
Peroxisome                             2  0.115234
Plastid                                8  0.202073

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0              Cytoplasm  0.004902
1  Endoplasmic reticulum  0.107306
2                Plastid  0.125000
3          Extracellular  0.121875
4              Cytoplasm  0.014563
5  Endoplasmic reticulum  0.009709
6          Extracellular  0.112903
7          Extracellular  0.139942
8                Plastid  0.202073

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.068452
1             Endoplasmic reticulum  0.107306
7                     Extracellular  0.139942
4                   Golgi apparatus  0.007463
5                  Lysosome/Vacuole  0.000000
0                     Mitochondrion  0.004902
6                           Nucleus  0.104000
2                        Peroxisome  0.115234
8                           Plastid  0.202073
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
prot_bert_functional
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.0336
NMI = 0.0757
Jaccard macro (true → best cluster) = 0.1173
Jaccard macro (cluster → best true) = 0.1270
Jaccard macro (Hungarian-aligned pairs) = 0.1136
Mapping-based clustering accuracy = 0.2042

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.129   0.100 0.113      200
Endoplasmic reticulum      0.167   0.195 0.180      200
Extracellular              0.395   0.160 0.228      200
Golgi apparatus            0.171   0.159 0.165      126
Lysosome/Vacuole           0.170   0.180 0.175      200
Mitochondrion              0.176   0.170 0.173      200
Nucleus                    0.181   0.230 0.203      200
Peroxisome                 0.223   0.314 0.261      159
Plastid                    0.312   0.335 0.323      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              26  33  32  16  16  20  26  26   5
Endoplasmic reticulum  25  29  13  20  29  12  39  31   2
Extracellular          11  53  17   4   7  43  28   5  32
Golgi apparatus        21  25  10  20   5  19  11  11   4
Lysosome/Vacuole       36  29  25  21  26  16  18  20   9
Mitochondrion          33  31  15   9  27  15  28  34   8
Nucleus                24  46  18  26  11  24  23  11  17
Peroxisome             18   5  18   1  50   3  24  37   3
Plastid                18   3  67   0  53   3  37  18   1

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     20                     26  ...          16       32
Endoplasmic reticulum         12                     39  ...          29       13
Extracellular                 43                     28  ...           7       17
Golgi apparatus               19                     11  ...           5       10
Lysosome/Vacuole              16                     18  ...          26       25
Mitochondrion                 15                     28  ...          27       15
Nucleus                       24                     23  ...          11       18
Peroxisome                     3                     24  ...          50       18
Plastid                        3                     37  ...          53       67

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.083551
Endoplasmic reticulum                  6  0.098734
Extracellular                          5  0.137821
Golgi apparatus                        3  0.089686
Lysosome/Vacuole                       0  0.095745
Mitochondrion                          7  0.094708
Nucleus                                1  0.112745
Peroxisome                             4  0.150150
Plastid                                2  0.192529

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0       Lysosome/Vacuole  0.095745
1          Extracellular  0.132170
2                Plastid  0.192529
3        Golgi apparatus  0.089686
4             Peroxisome  0.150150
5          Extracellular  0.137821
6  Endoplasmic reticulum  0.098734
7             Peroxisome  0.117460
8          Extracellular  0.128514

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
5                         Cytoplasm  0.059701
6             Endoplasmic reticulum  0.098734
8                     Extracellular  0.128514
3                   Golgi apparatus  0.089686
0                  Lysosome/Vacuole  0.095745
7                     Mitochondrion  0.094708
1                           Nucleus  0.112745
4                        Peroxisome  0.150150
2                           Plastid  0.192529
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
prot_bert_functional
Similarity.Euclidean_Clustering.Spectral
ARI = 0.0405
NMI = 0.0871
Jaccard macro (true → best cluster) = 0.1261
Jaccard macro (cluster → best true) = 0.1283
Jaccard macro (Hungarian-aligned pairs) = 0.1180
Mapping-based clustering accuracy = 0.2119

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.191   0.200 0.196      200
Endoplasmic reticulum      0.164   0.220 0.188      200
Extracellular              0.347   0.255 0.294      200
Golgi apparatus            0.150   0.206 0.174      126
Lysosome/Vacuole           0.201   0.140 0.165      200
Mitochondrion              0.147   0.130 0.138      200
Nucleus                    0.246   0.145 0.182      200
Peroxisome                 0.195   0.252 0.220      159
Plastid                    0.293   0.365 0.325      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              24  24  10  12  15  21  31  23  40
Endoplasmic reticulum  17  31  26   8  12  32  44  17  13
Extracellular          43   6  15  51  35   4  29   4  13
Golgi apparatus        19  26   1   7   9  12  17  11  24
Lysosome/Vacuole       20  27  33  18  10  14  28  28  22
Mitochondrion          26  19  26  20   5  35  33  26  10
Nucleus                24  29   4  16  29  16  27  19  36
Peroxisome              1   9  61   4   2  40  29   7   6
Plastid                 3   2  73  11   1  31  30   4  45

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     40                     31  ...          21       10
Endoplasmic reticulum         13                     44  ...          32       26
Extracellular                 13                     29  ...           4       15
Golgi apparatus               24                     17  ...          12        1
Lysosome/Vacuole              22                     28  ...          14       33
Mitochondrion                 10                     33  ...          35       26
Nucleus                       36                     27  ...          16        4
Peroxisome                     6                     29  ...          40       61
Plastid                       45                     30  ...          31       73

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              8  0.108401
Endoplasmic reticulum                  6  0.103774
Extracellular                          3  0.172297
Golgi apparatus                        1  0.095238
Lysosome/Vacuole                       7  0.090032
Mitochondrion                          5  0.094595
Nucleus                                4  0.100346
Peroxisome                             2  0.175793
Plastid                                2  0.194149

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0          Extracellular  0.128743
1        Golgi apparatus  0.095238
2                Plastid  0.194149
3          Extracellular  0.172297
4          Extracellular  0.123675
5             Peroxisome  0.123457
6  Endoplasmic reticulum  0.103774
7       Lysosome/Vacuole  0.090032
8                Plastid  0.123626

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
8                         Cytoplasm  0.108401
6             Endoplasmic reticulum  0.103774
3                     Extracellular  0.172297
1                   Golgi apparatus  0.095238
7                  Lysosome/Vacuole  0.090032
0                     Mitochondrion  0.074074
4                           Nucleus  0.100346
5                        Peroxisome  0.123457
2                           Plastid  0.194149
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
prot_bert_functional
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0334
NMI = 0.0720
Jaccard macro (true → best cluster) = 0.1316
Jaccard macro (cluster → best true) = 0.1058
Jaccard macro (Hungarian-aligned pairs) = 0.0967
Mapping-based clustering accuracy = 0.2136

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  1.000   0.010 0.020      200
Endoplasmic reticulum      0.133   0.190 0.156      200
Extracellular              0.304   0.380 0.338      200
Golgi apparatus            0.000   0.000 0.000      126
Lysosome/Vacuole           0.190   0.175 0.182      200
Mitochondrion              0.143   0.010 0.019      200
Nucleus                    0.247   0.210 0.227      200
Peroxisome                 0.179   0.358 0.238      159
Plastid                    0.240   0.540 0.332      200

Contingency table (true x pred):
pred                     0  1   2   3   4  5   6   7  8
true                                                   
Cytoplasm               43  0  22  34  32  1  31  35  2
Endoplasmic reticulum   39  0  15  25  28  3  52  38  0
Extracellular           40  9  20  76   5  5  10  35  0
Golgi apparatus         18  0  19  24  24  0  25  16  0
Lysosome/Vacuole        64  1  25  22  35  0  27  26  0
Mitochondrion           42  0  22  27  21  2  57  29  0
Nucleus                 35  0  42  33  32  2  24  32  0
Peroxisome              61  0   2   5   5  1  57  28  0
Plastid                108  0   3   4   2  0  36  47  0

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                      2                     35  ...          31       43
Endoplasmic reticulum          0                     38  ...          52       39
Extracellular                  0                     35  ...          10       40
Golgi apparatus                0                     16  ...          25       18
Lysosome/Vacuole               0                     26  ...          27       64
Mitochondrion                  0                     29  ...          57       42
Nucleus                        0                     32  ...          24       35
Peroxisome                     0                     28  ...          57       61
Plastid                        0                     47  ...          36      108

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              4  0.090909
Endoplasmic reticulum                  6  0.111349
Extracellular                          3  0.203209
Golgi apparatus                        4  0.083916
Lysosome/Vacuole                       0  0.109215
Mitochondrion                          6  0.123377
Nucleus                                2  0.128049
Peroxisome                             6  0.135392
Plastid                                0  0.199262

Best true class for each predicted cluster (by Jaccard):
    best_true_class   jaccard
0           Plastid  0.199262
1     Extracellular  0.044776
2           Nucleus  0.128049
3     Extracellular  0.203209
4  Lysosome/Vacuole  0.100287
5     Extracellular  0.023923
6        Peroxisome  0.135392
7           Plastid  0.107062
8         Cytoplasm  0.010000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
8                         Cytoplasm  0.010000
7             Endoplasmic reticulum  0.084821
3                     Extracellular  0.203209
1                   Golgi apparatus  0.000000
4                  Lysosome/Vacuole  0.100287
5                     Mitochondrion  0.009434
2                           Nucleus  0.128049
6                        Peroxisome  0.135392
0                           Plastid  0.199262
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
prot_bert_functional
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.0336
NMI = 0.0757
Jaccard macro (true → best cluster) = 0.1173
Jaccard macro (cluster → best true) = 0.1270
Jaccard macro (Hungarian-aligned pairs) = 0.1136
Mapping-based clustering accuracy = 0.2042

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.129   0.100 0.113      200
Endoplasmic reticulum      0.167   0.195 0.180      200
Extracellular              0.395   0.160 0.228      200
Golgi apparatus            0.171   0.159 0.165      126
Lysosome/Vacuole           0.170   0.180 0.175      200
Mitochondrion              0.176   0.170 0.173      200
Nucleus                    0.181   0.230 0.203      200
Peroxisome                 0.223   0.314 0.261      159
Plastid                    0.312   0.335 0.323      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              26  33  32  16  16  20  26  26   5
Endoplasmic reticulum  25  29  13  20  29  12  39  31   2
Extracellular          11  53  17   4   7  43  28   5  32
Golgi apparatus        21  25  10  20   5  19  11  11   4
Lysosome/Vacuole       36  29  25  21  26  16  18  20   9
Mitochondrion          33  31  15   9  27  15  28  34   8
Nucleus                24  46  18  26  11  24  23  11  17
Peroxisome             18   5  18   1  50   3  24  37   3
Plastid                18   3  67   0  53   3  37  18   1

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     20                     26  ...          16       32
Endoplasmic reticulum         12                     39  ...          29       13
Extracellular                 43                     28  ...           7       17
Golgi apparatus               19                     11  ...           5       10
Lysosome/Vacuole              16                     18  ...          26       25
Mitochondrion                 15                     28  ...          27       15
Nucleus                       24                     23  ...          11       18
Peroxisome                     3                     24  ...          50       18
Plastid                        3                     37  ...          53       67

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              2  0.083551
Endoplasmic reticulum                  6  0.098734
Extracellular                          5  0.137821
Golgi apparatus                        3  0.089686
Lysosome/Vacuole                       0  0.095745
Mitochondrion                          7  0.094708
Nucleus                                1  0.112745
Peroxisome                             4  0.150150
Plastid                                2  0.192529

Best true class for each predicted cluster (by Jaccard):
         best_true_class   jaccard
0       Lysosome/Vacuole  0.095745
1          Extracellular  0.132170
2                Plastid  0.192529
3        Golgi apparatus  0.089686
4             Peroxisome  0.150150
5          Extracellular  0.137821
6  Endoplasmic reticulum  0.098734
7             Peroxisome  0.117460
8          Extracellular  0.128514

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
5                         Cytoplasm  0.059701
6             Endoplasmic reticulum  0.098734
8                     Extracellular  0.128514
3                   Golgi apparatus  0.089686
0                  Lysosome/Vacuole  0.095745
7                     Mitochondrion  0.094708
1                           Nucleus  0.112745
4                        Peroxisome  0.150150
2                           Plastid  0.192529
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
prot_bert_functional
Similarity.Geodesic_Clustering.Spectral
ARI = 0.0591
NMI = 0.1163
Jaccard macro (true → best cluster) = 0.1510
Jaccard macro (cluster → best true) = 0.1538
Jaccard macro (Hungarian-aligned pairs) = 0.1454
Mapping-based clustering accuracy = 0.2415

Per-class metrics (after mapping):
                       precision  recall    f1  support
Cytoplasm                  0.206   0.160 0.180      200
Endoplasmic reticulum      0.167   0.135 0.149      200
Extracellular              0.592   0.465 0.521      200
Golgi apparatus            0.211   0.214 0.213      126
Lysosome/Vacuole           0.113   0.165 0.134      200
Mitochondrion              0.201   0.190 0.195      200
Nucleus                    0.188   0.200 0.194      200
Peroxisome                 0.210   0.258 0.232      159
Plastid                    0.392   0.380 0.386      200

Contingency table (true x pred):
pred                    0   1   2   3   4   5   6   7   8
true                                                     
Cytoplasm              33  22   8  32  34  20  15  22  14
Endoplasmic reticulum  41  29  12  22  21  10  32   6  27
Extracellular          26   2  93  11  43   4   7   5   9
Golgi apparatus        24  10   1  14  25  27  10   6   9
Lysosome/Vacuole       33  11  29  27  22  29  24  12  13
Mitochondrion          47  38   8  20  22   5  18  14  28
Nucleus                34  11   1  19  40  33  13  43   6
Peroxisome             25  40   3  10   3   0  41  10  27
Plastid                29  26   2   0   3   0  35  76  29

Contingency after mapping (true x pred_mapped):
pred_mapped            Cytoplasm  Endoplasmic reticulum  ...  Peroxisome  Plastid
true                                                     ...                     
Cytoplasm                     32                     14  ...          15       22
Endoplasmic reticulum         22                     27  ...          32        6
Extracellular                 11                      9  ...           7        5
Golgi apparatus               14                      9  ...          10        6
Lysosome/Vacuole              27                     13  ...          24       12
Mitochondrion                 20                     28  ...          18       14
Nucleus                       19                      6  ...          13       43
Peroxisome                    10                     27  ...          41       10
Plastid                        0                     29  ...          35       76

[9 rows x 9 columns]

Best predicted cluster for each true class (by Jaccard):
                       best_pred_cluster   jaccard
Cytoplasm                              3  0.099071
Endoplasmic reticulum                  0  0.090909
Extracellular                          2  0.352273
Golgi apparatus                        5  0.118943
Lysosome/Vacuole                       5  0.096990
Mitochondrion                          1  0.108262
Nucleus                                7  0.122507
Peroxisome                             6  0.130990
Plastid                                7  0.238994

Best true class for each predicted cluster (by Jaccard):
   best_true_class   jaccard
0    Mitochondrion  0.105618
1       Peroxisome  0.129870
2    Extracellular  0.352273
3        Cytoplasm  0.099071
4    Extracellular  0.116216
5  Golgi apparatus  0.118943
6       Peroxisome  0.130990
7          Plastid  0.238994
8       Peroxisome  0.091837

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
                         true_class   jaccard
pred_cluster                                 
3                         Cytoplasm  0.099071
8             Endoplasmic reticulum  0.080597
2                     Extracellular  0.352273
5                   Golgi apparatus  0.118943
0                  Lysosome/Vacuole  0.071895
1                     Mitochondrion  0.108262
4                           Nucleus  0.107239
6                        Peroxisome  0.130990
7                           Plastid  0.238994
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
