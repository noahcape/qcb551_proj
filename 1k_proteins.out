bag_of_words
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0683
NMI = 0.2278
Jaccard macro (true → best cluster) = 0.2282
Jaccard macro (cluster → best true) = 0.1448
Jaccard macro (Hungarian-aligned pairs) = 0.1284
Mapping-based clustering accuracy = 0.2679

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.000   0.000 0.000      200
b      0.000   0.000 0.000      200
c      0.174   1.000 0.297      200
d      0.000   0.000 0.000      200
e      0.000   0.000 0.000      200
f      0.741   0.100 0.176      200
g      0.767   0.775 0.771      200

Contingency table (true x pred):
pred    0  1   2    3   4  5  6
true                           
a      15  0   0  178   7  0  0
b      14  0   0  186   0  0  0
c       0  0   0  200   0  0  0
d      13  0   0  187   0  0  0
e       3  0   0  197   0  0  0
f       2  2   0  176  20  0  0
g     155  1  17   23   0  2  2

Contingency after mapping (true x pred_mapped):
pred_mapped  a  b    c   d  e   f    g
true                                  
a            0  0  178   0  0   7   15
b            0  0  186   0  0   0   14
c            0  0  200   0  0   0    0
d            0  0  187   0  0   0   13
e            0  0  197   0  0   0    3
f            0  0  176   0  2  20    2
g            2  2   23  17  1   0  155

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.152267
b                  3  0.160207
c                  3  0.174368
d                  3  0.161207
e                  3  0.171304
f                  3  0.150299
g                  0  0.627530

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.627530
1               f  0.009950
2               g  0.085000
3               c  0.174368
4               f  0.096618
5               g  0.010000
6               g  0.010000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.000000
5                     b  0.000000
3                     c  0.174368
2                     d  0.000000
1                     e  0.000000
4                     f  0.096618
0                     g  0.627530
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
bag_of_words
Similarity.Cosine_Clustering.Kmeans
ARI = 0.1584
NMI = 0.2315
Jaccard macro (true → best cluster) = 0.2253
Jaccard macro (cluster → best true) = 0.2085
Jaccard macro (Hungarian-aligned pairs) = 0.1786
Mapping-based clustering accuracy = 0.3357

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.138   0.085 0.105      200
b      0.296   0.620 0.401      200
c      0.252   0.360 0.296      200
d      0.000   0.000 0.000      200
e      0.623   0.190 0.291      200
f      0.223   0.135 0.168      200
g      0.519   0.960 0.674      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a     22   2   8   86  17   0   65
b     45   2   1  124   5   0   23
c     72   5  34   55  30   2    2
d     44   3  10  105   6   0   32
e     62  38  41    4  44  11    0
f     41  11  27   37  21   7   56
g      0   0   0    8   0   0  192

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c   d   e   f    g
true                                     
a            17   86  22   0   2   8   65
b             5  124  45   0   2   1   23
c            30   55  72   2   5  34    2
d             6  105  44   0   3  10   32
e            44    4  62  11  38  41    0
f            21   37  41   7  11  27   56
g             0    8   0   0   0   0  192

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.161351
b                  3  0.250505
c                  0  0.173913
d                  3  0.204280
e                  1  0.170404
f                  6  0.108949
g                  6  0.507937

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.173913
1               e  0.170404
2               e  0.146429
3               b  0.250505
4               e  0.157706
5               e  0.052632
6               g  0.507937

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
4                     a  0.055556
3                     b  0.250505
0                     c  0.173913
5                     d  0.000000
1                     e  0.170404
2                     f  0.091837
6                     g  0.507937
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
bag_of_words
Similarity.Cosine_Clustering.Spectral
ARI = 0.1549
NMI = 0.2259
Jaccard macro (true → best cluster) = 0.2967
Jaccard macro (cluster → best true) = 0.2977
Jaccard macro (Hungarian-aligned pairs) = 0.2913
Mapping-based clustering accuracy = 0.4043

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.327   0.320 0.323      200
b      0.619   0.545 0.580      200
c      0.200   0.315 0.245      200
d      0.216   0.205 0.210      200
e      0.252   0.295 0.272      200
f      0.658   0.520 0.581      200
g      0.962   0.630 0.761      200

Contingency table (true x pred):
pred    0   1    2    3   4   5   6
true                               
a       8  79    3    3  29  64  14
b     109  29   12    0  11  10  29
c       5  63   16    0  60  24  32
d      14  61   17    1  39  27  41
e      11  57    5    1  59  31  36
f      20   8  104    0  33  19  16
g       9  18    1  126   3  21  22

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c   d   e    f    g
true                                      
a            64    8  79  14  29    3    3
b            10  109  29  29  11   12    0
c            24    5  63  32  60   16    0
d            27   14  61  41  39   17    1
e            31   11  57  36  59    5    1
f            19   20   8  16  33  104    0
g            21    9  18  22   3    1  126

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.192771
b                  0  0.408240
c                  4  0.160428
d                  1  0.134361
e                  4  0.157333
f                  2  0.409449
g                  3  0.614634

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.408240
1               a  0.181193
2               f  0.409449
3               g  0.614634
4               c  0.160428
5               a  0.192771
6               d  0.117479

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.192771
0                     b  0.408240
1                     c  0.139381
6                     d  0.117479
4                     e  0.157333
2                     f  0.409449
3                     g  0.614634
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
bag_of_words
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0815
NMI = 0.1727
Jaccard macro (true → best cluster) = 0.1928
Jaccard macro (cluster → best true) = 0.1114
Jaccard macro (Hungarian-aligned pairs) = 0.0936
Mapping-based clustering accuracy = 0.2564

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.000   0.000 0.000      200
b      0.000   0.000 0.000      200
c      0.252   0.545 0.345      200
d      0.000   0.000 0.000      200
e      0.536   0.225 0.317      200
f      0.385   0.025 0.047      200
g      0.235   1.000 0.380      200

Contingency table (true x pred):
pred    0   1   2  3    4  5  6
true                           
a      34   7   0  0  159  0  0
b      43   3   0  0  154  0  0
c     109   7   2  1   81  0  0
d      44   3   0  0  153  0  0
e     128  45  11  7    6  2  1
f      74  19   3  5   99  0  0
g       0   0   0  0  200  0  0

Contingency after mapping (true x pred_mapped):
pred_mapped  a   b    c  d   e  f    g
true                                  
a            0   0   34  0   7  0  159
b            0   0   43  0   3  0  154
c            0   2  109  0   7  1   81
d            0   0   44  0   3  0  153
e            1  11  128  2  45  7    6
f            0   3   74  0  19  5   99
g            0   0    0  0   0  0  200

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  4  0.178052
b                  4  0.171492
c                  0  0.208413
d                  4  0.170189
e                  0  0.253968
f                  0  0.132616
g                  4  0.234742

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.253968
1               e  0.188285
2               e  0.053659
3               e  0.033981
4               g  0.234742
5               e  0.010000
6               e  0.005000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.000000
2                     b  0.000000
0                     c  0.208413
5                     d  0.000000
1                     e  0.188285
3                     f  0.024038
4                     g  0.234742
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
bag_of_words
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.1584
NMI = 0.2315
Jaccard macro (true → best cluster) = 0.2253
Jaccard macro (cluster → best true) = 0.2085
Jaccard macro (Hungarian-aligned pairs) = 0.1786
Mapping-based clustering accuracy = 0.3357

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.138   0.085 0.105      200
b      0.296   0.620 0.401      200
c      0.252   0.360 0.296      200
d      0.000   0.000 0.000      200
e      0.623   0.190 0.291      200
f      0.223   0.135 0.168      200
g      0.519   0.960 0.674      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a     22   2   8   86  17   0   65
b     45   2   1  124   5   0   23
c     72   5  34   55  30   2    2
d     44   3  10  105   6   0   32
e     62  38  41    4  44  11    0
f     41  11  27   37  21   7   56
g      0   0   0    8   0   0  192

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c   d   e   f    g
true                                     
a            17   86  22   0   2   8   65
b             5  124  45   0   2   1   23
c            30   55  72   2   5  34    2
d             6  105  44   0   3  10   32
e            44    4  62  11  38  41    0
f            21   37  41   7  11  27   56
g             0    8   0   0   0   0  192

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.161351
b                  3  0.250505
c                  0  0.173913
d                  3  0.204280
e                  1  0.170404
f                  6  0.108949
g                  6  0.507937

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.173913
1               e  0.170404
2               e  0.146429
3               b  0.250505
4               e  0.157706
5               e  0.052632
6               g  0.507937

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
4                     a  0.055556
3                     b  0.250505
0                     c  0.173913
5                     d  0.000000
1                     e  0.170404
2                     f  0.091837
6                     g  0.507937
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
bag_of_words
Similarity.Euclidean_Clustering.Spectral
ARI = 0.1868
NMI = 0.2423
Jaccard macro (true → best cluster) = 0.2585
Jaccard macro (cluster → best true) = 0.2540
Jaccard macro (Hungarian-aligned pairs) = 0.2437
Mapping-based clustering accuracy = 0.4007

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.209   0.160 0.181      200
b      0.573   0.630 0.600      200
c      0.284   0.260 0.272      200
d      0.285   0.430 0.343      200
e      0.703   0.225 0.341      200
f      0.250   0.135 0.175      200
g      0.522   0.965 0.677      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a     32  65   1   18   4  15   65
b      8  27   1  126   9   5   24
c     31  76   5   12  21  52    3
d     20  86   1   31   9  23   30
e     41  30  45    3  37  44    0
f     21  14  11   28  27  44   55
g      0   4   0    2   1   0  193

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c   d   e   f    g
true                                     
a            32   18  15  65   1   4   65
b             8  126   5  27   1   9   24
c            31   12  52  76   5  21    3
d            20   31  23  86   1   9   30
e            41    3  44  30  45  37    0
f            21   28  44  14  11  27   55
g             0    2   0   4   0   1  193

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.148741
b                  3  0.428571
c                  1  0.178404
d                  1  0.206731
e                  2  0.205479
f                  5  0.129794
g                  6  0.511936

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.131410
1               d  0.206731
2               e  0.205479
3               b  0.428571
4               e  0.136531
5               c  0.157100
6               g  0.511936

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
0                     a  0.099688
3                     b  0.428571
5                     c  0.157100
1                     d  0.206731
2                     e  0.205479
4                     f  0.096085
6                     g  0.511936
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
bag_of_words
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0908
NMI = 0.1737
Jaccard macro (true → best cluster) = 0.1873
Jaccard macro (cluster → best true) = 0.1443
Jaccard macro (Hungarian-aligned pairs) = 0.1154
Mapping-based clustering accuracy = 0.2750

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.045   0.010 0.016      200
b      0.190   0.110 0.139      200
c      0.279   0.510 0.360      200
d      0.000   0.000 0.000      200
e      0.455   0.255 0.327      200
f      0.308   0.040 0.071      200
g      0.273   1.000 0.429      200

Contingency table (true x pred):
pred   0   1    2  3    4   5   6
true                             
a      0  12   36  0  140   2  10
b      0  22   32  0  140   2   4
c      2  29  102  0   45   3  19
d      0   9   62  0  124   1   4
e     16  23   75  3    4  28  51
f      8  21   59  0   80   8  24
g      0   0    0  0  200   0   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c  d   e   f    g
true                                    
a             2  12   36  0  10   0  140
b             2  22   32  0   4   0  140
c             3  29  102  0  19   2   45
d             1   9   62  0   4   0  124
e            28  23   75  3  51  16    4
f             8  21   59  0  24   8   80
g             0   0    0  0   0   0  200

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  4  0.176545
b                  4  0.176545
c                  2  0.219828
d                  4  0.153276
e                  6  0.195402
f                  2  0.116371
g                  4  0.272851

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.076190
1               c  0.101045
2               c  0.219828
3               e  0.015000
4               g  0.272851
5               e  0.129630
6               e  0.195402

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.008264
1                     b  0.074830
2                     c  0.219828
3                     d  0.000000
6                     e  0.195402
0                     f  0.036697
4                     g  0.272851
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
bag_of_words
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.1584
NMI = 0.2315
Jaccard macro (true → best cluster) = 0.2253
Jaccard macro (cluster → best true) = 0.2085
Jaccard macro (Hungarian-aligned pairs) = 0.1786
Mapping-based clustering accuracy = 0.3357

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.138   0.085 0.105      200
b      0.296   0.620 0.401      200
c      0.252   0.360 0.296      200
d      0.000   0.000 0.000      200
e      0.623   0.190 0.291      200
f      0.223   0.135 0.168      200
g      0.519   0.960 0.674      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a     22   2   8   86  17   0   65
b     45   2   1  124   5   0   23
c     72   5  34   55  30   2    2
d     44   3  10  105   6   0   32
e     62  38  41    4  44  11    0
f     41  11  27   37  21   7   56
g      0   0   0    8   0   0  192

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c   d   e   f    g
true                                     
a            17   86  22   0   2   8   65
b             5  124  45   0   2   1   23
c            30   55  72   2   5  34    2
d             6  105  44   0   3  10   32
e            44    4  62  11  38  41    0
f            21   37  41   7  11  27   56
g             0    8   0   0   0   0  192

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.161351
b                  3  0.250505
c                  0  0.173913
d                  3  0.204280
e                  1  0.170404
f                  6  0.108949
g                  6  0.507937

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.173913
1               e  0.170404
2               e  0.146429
3               b  0.250505
4               e  0.157706
5               e  0.052632
6               g  0.507937

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
4                     a  0.055556
3                     b  0.250505
0                     c  0.173913
5                     d  0.000000
1                     e  0.170404
2                     f  0.091837
6                     g  0.507937
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
bag_of_words
Similarity.Geodesic_Clustering.Spectral
ARI = 0.2312
NMI = 0.3302
Jaccard macro (true → best cluster) = 0.3306
Jaccard macro (cluster → best true) = 0.3271
Jaccard macro (Hungarian-aligned pairs) = 0.3078
Mapping-based clustering accuracy = 0.4521

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.122   0.120 0.121      200
b      0.755   0.585 0.659      200
c      0.324   0.350 0.337      200
d      0.299   0.545 0.387      200
e      0.779   0.265 0.396      200
f      0.947   0.355 0.516      200
g      0.582   0.945 0.720      200

Contingency table (true x pred):
pred    0   1   2   3    4   5    6
true                               
a     103  17   3  24    4   0   49
b      45   7   1  13  117   1   16
c      69  70   5  51    2   1    2
d     109  29   2  21   21   1   17
e      10  77  53  59    0   1    0
f      23  16   4  29    5  71   52
g       5   0   0   0    6   0  189

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b   c    d   e   f    g
true                                      
a            24    4  17  103   3   0   49
b            13  117   7   45   1   1   16
c            51    2  70   69   5   1    2
d            21   21  29  109   2   1   17
e            59    0  77   10  53   1    0
f            29    5  16   23   4  71   52
g             0    6   0    5   0   0  189

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  0  0.223427
b                  4  0.491597
c                  1  0.202312
d                  0  0.239560
e                  2  0.246512
f                  5  0.348039
g                  6  0.562500

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               d  0.239560
1               e  0.227139
2               e  0.246512
3               e  0.174556
4               b  0.491597
5               f  0.348039
6               g  0.562500

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.064343
4                     b  0.491597
1                     c  0.202312
0                     d  0.239560
2                     e  0.246512
5                     f  0.348039
6                     g  0.562500
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_8M_embeddings
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0308
NMI = 0.1296
Jaccard macro (true → best cluster) = 0.1882
Jaccard macro (cluster → best true) = 0.1217
Jaccard macro (Hungarian-aligned pairs) = 0.1138
Mapping-based clustering accuracy = 0.2364

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.171   0.065 0.094      200
b      0.679   0.475 0.559      200
c      0.274   0.305 0.288      200
d      1.000   0.005 0.010      200
e      0.000   0.000 0.000      200
f      0.375   0.030 0.056      200
g      0.165   0.775 0.271      200

Contingency table (true x pred):
pred   0   1  2  3    4  5   6
true                          
a      0  13  1  0  153  0  33
b     95   4  0  0   81  0  20
c      0  24  7  0  107  1  61
d      4   8  2  1  153  0  32
e      0  11  0  0  143  0  46
f      0  12  6  0  150  1  31
g     41   4  0  0  155  0   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c  d  e  f    g
true                                 
a            13   0  33  0  0  1  153
b             4  95  20  0  0  0   81
c            24   0  61  0  1  7  107
d             8   4  32  1  0  2  153
e            11   0  46  0  0  0  143
f            12   0  31  0  1  6  150
g             4  41   0  0  0  0  155

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  4  0.154702
b                  0  0.387755
c                  6  0.168508
d                  4  0.154702
e                  4  0.143143
f                  4  0.151210
g                  4  0.157042

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.387755
1               c  0.095238
2               c  0.033493
3               d  0.005000
4               g  0.157042
5               c  0.004975
6               c  0.168508

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.049430
0                     b  0.387755
6                     c  0.168508
3                     d  0.005000
5                     e  0.000000
2                     f  0.028571
4                     g  0.157042
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_8M_embeddings
Similarity.Cosine_Clustering.Kmeans
ARI = 0.1610
NMI = 0.2803
Jaccard macro (true → best cluster) = 0.3268
Jaccard macro (cluster → best true) = 0.3323
Jaccard macro (Hungarian-aligned pairs) = 0.3263
Mapping-based clustering accuracy = 0.4371

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.262   0.480 0.339      200
b      0.853   0.495 0.627      200
c      0.314   0.385 0.346      200
d      0.258   0.320 0.286      200
e      0.270   0.255 0.262      200
f      0.984   0.605 0.749      200
g      0.920   0.520 0.665      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a      0  37  40    3  23  96    1
b     99  19  30    2   4  46    0
c      0  35  77    0  63  25    0
d      3  64  27    3  26  77    0
e      0  60  18    0  51  70    1
f      0  18  20    1  19  21  121
g     14  15  33  104   3  31    0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e    f    g
true                                     
a            96   0  40  37  23    1    3
b            46  99  30  19   4    0    2
c            25   0  77  35  63    0    0
d            77   3  27  64  26    0    3
e            70   0  18  60  51    1    0
f            21   0  20  18  19  121    1
g            31  14  33  15   3    0  104

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.204255
b                  0  0.456221
c                  2  0.209239
d                  1  0.166667
e                  1  0.154639
f                  6  0.599010
g                  3  0.497608

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.456221
1               d  0.166667
2               c  0.209239
3               g  0.497608
4               c  0.193252
5               a  0.204255
6               f  0.599010

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.204255
0                     b  0.456221
2                     c  0.209239
1                     d  0.166667
4                     e  0.150888
6                     f  0.599010
3                     g  0.497608
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_8M_embeddings
Similarity.Cosine_Clustering.Spectral
ARI = 0.2444
NMI = 0.3472
Jaccard macro (true → best cluster) = 0.3884
Jaccard macro (cluster → best true) = 0.3779
Jaccard macro (Hungarian-aligned pairs) = 0.3757
Mapping-based clustering accuracy = 0.4914

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.265   0.545 0.357      200
b      0.911   0.510 0.654      200
c      0.500   0.430 0.462      200
d      0.228   0.245 0.236      200
e      0.279   0.205 0.236      200
f      0.898   0.660 0.761      200
g      0.862   0.845 0.854      200

Contingency table (true x pred):
pred   0    1    2   3   4    5    6
true                                
a     31    8    4  36  12  109    0
b     14    2   11   4  32   35  102
c     43    1    0  86  17   52    1
d     49    2    8  29  10   97    5
e     54    2    2  13  41   88    0
f     13  132    2   0  35   18    0
g     11    0  169   4   0   12    4

Contingency after mapping (true x pred_mapped):
pred_mapped    a    b   c   d   e    f    g
true                                       
a            109    0  36  31  12    8    4
b             35  102   4  14  32    2   11
c             52    1  86  43  17    1    0
d             97    5  29  49  10    2    8
e             88    0  13  54  41    2    2
f             18    0   0  13  35  132    2
g             12    4   4  11   0    0  169

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.217131
b                  6  0.485714
c                  3  0.300699
d                  5  0.188716
e                  5  0.168260
f                  1  0.613953
g                  2  0.744493

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.149584
1               f  0.613953
2               g  0.744493
3               c  0.300699
4               e  0.133987
5               a  0.217131
6               b  0.485714

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.217131
6                     b  0.485714
3                     c  0.300699
0                     d  0.133880
4                     e  0.133987
1                     f  0.613953
2                     g  0.744493
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_8M_embeddings
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0608
NMI = 0.1741
Jaccard macro (true → best cluster) = 0.2403
Jaccard macro (cluster → best true) = 0.2012
Jaccard macro (Hungarian-aligned pairs) = 0.1875
Mapping-based clustering accuracy = 0.2986

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.144   0.155 0.149      200
b      1.000   0.475 0.644      200
c      0.321   0.360 0.340      200
d      0.183   0.055 0.085      200
e      0.000   0.000 0.000      200
f      0.194   0.710 0.304      200
g      0.944   0.335 0.494      200

Contingency table (true x pred):
pred   0   1   2  3    4   5   6
true                            
a     36   3  31  0  129   1   0
b     27   4  12  0   60   2  95
c     72  21  47  0   60   0   0
d     25  11  23  1  139   1   0
e     34   9  29  0  128   0   0
f     16   9  32  1  142   0   0
g     14   3  41  0   75  67   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d  e    f   g
true                                   
a            31   0  36   3  0  129   1
b            12  95  27   4  0   60   2
c            47   0  72  21  0   60   0
d            23   0  25  11  1  139   1
e            29   0  34   9  0  128   0
f            32   0  16   9  1  142   0
g            41   0  14   3  0   75  67

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  4  0.160448
b                  6  0.475000
c                  0  0.204545
d                  4  0.175063
e                  4  0.159006
f                  4  0.179520
g                  5  0.328431

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.204545
1               c  0.087866
2               c  0.127717
3               d  0.004975
4               f  0.179520
5               g  0.328431
6               b  0.475000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
2                     a  0.080729
6                     b  0.475000
0                     c  0.204545
1                     d  0.044177
3                     e  0.000000
4                     f  0.179520
5                     g  0.328431
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_8M_embeddings
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.1610
NMI = 0.2803
Jaccard macro (true → best cluster) = 0.3268
Jaccard macro (cluster → best true) = 0.3323
Jaccard macro (Hungarian-aligned pairs) = 0.3263
Mapping-based clustering accuracy = 0.4371

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.262   0.480 0.339      200
b      0.853   0.495 0.627      200
c      0.314   0.385 0.346      200
d      0.258   0.320 0.286      200
e      0.270   0.255 0.262      200
f      0.984   0.605 0.749      200
g      0.920   0.520 0.665      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a      0  37  40    3  23  96    1
b     99  19  30    2   4  46    0
c      0  35  77    0  63  25    0
d      3  64  27    3  26  77    0
e      0  60  18    0  51  70    1
f      0  18  20    1  19  21  121
g     14  15  33  104   3  31    0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e    f    g
true                                     
a            96   0  40  37  23    1    3
b            46  99  30  19   4    0    2
c            25   0  77  35  63    0    0
d            77   3  27  64  26    0    3
e            70   0  18  60  51    1    0
f            21   0  20  18  19  121    1
g            31  14  33  15   3    0  104

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.204255
b                  0  0.456221
c                  2  0.209239
d                  1  0.166667
e                  1  0.154639
f                  6  0.599010
g                  3  0.497608

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.456221
1               d  0.166667
2               c  0.209239
3               g  0.497608
4               c  0.193252
5               a  0.204255
6               f  0.599010

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.204255
0                     b  0.456221
2                     c  0.209239
1                     d  0.166667
4                     e  0.150888
6                     f  0.599010
3                     g  0.497608
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_8M_embeddings
Similarity.Euclidean_Clustering.Spectral
ARI = 0.2320
NMI = 0.3399
Jaccard macro (true → best cluster) = 0.3784
Jaccard macro (cluster → best true) = 0.3747
Jaccard macro (Hungarian-aligned pairs) = 0.3743
Mapping-based clustering accuracy = 0.4914

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.287   0.450 0.350      200
b      0.962   0.505 0.662      200
c      0.403   0.520 0.454      200
d      0.268   0.335 0.298      200
e      0.288   0.235 0.259      200
f      0.926   0.690 0.791      200
g      0.876   0.705 0.781      200

Contingency table (true x pred):
pred   0    1   2    3    4    5   6
true                                
a     34    0  90    8   52    4  12
b     14  101  30    1   10    8  36
c     45    0  33    0  104    0  18
d     67    0  73    0   42    5  13
e     68    0  65    2   17    1  47
f     12    0   9  138    3    2  36
g     10    4  14    0   30  141   1

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b    c   d   e    f    g
true                                       
a            90    0   52  34  12    8    4
b            30  101   10  14  36    1    8
c            33    0  104  45  18    0    0
d            73    0   42  67  13    0    5
e            65    0   17  68  47    2    1
f             9    0    3  12  36  138    2
g            14    4   30  10   1    0  141

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  2  0.212264
b                  1  0.495098
c                  4  0.293785
d                  0  0.174935
e                  0  0.178010
f                  3  0.654028
g                  5  0.640909

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.178010
1               b  0.495098
2               a  0.212264
3               f  0.654028
4               c  0.293785
5               g  0.640909
6               e  0.148734

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
2                     a  0.212264
1                     b  0.495098
4                     c  0.293785
0                     d  0.174935
6                     e  0.148734
3                     f  0.654028
5                     g  0.640909
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_8M_embeddings
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0669
NMI = 0.2772
Jaccard macro (true → best cluster) = 0.2610
Jaccard macro (cluster → best true) = 0.2332
Jaccard macro (Hungarian-aligned pairs) = 0.2067
Mapping-based clustering accuracy = 0.3343

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.188   0.860 0.308      200
b      0.780   0.515 0.620      200
c      0.395   0.385 0.390      200
d      0.067   0.005 0.009      200
e      0.000   0.000 0.000      200
f      1.000   0.125 0.222      200
g      0.968   0.450 0.614      200

Contingency table (true x pred):
pred    0   1   2    3   4   5   6
true                              
a       0   0   0  172  25   0   3
b     103   0   0   94   3   0   0
c       1   0   0  122  77   0   0
d       7   1   0  163  29   0   0
e       0   0   0  142  58   0   0
f       0  14  25  159   2   0   0
g      21   0   0   64   1  24  90

Contingency after mapping (true x pred_mapped):
pred_mapped    a    b   c   d   e   f   g
true                                     
a            172    0  25   0   0   0   3
b             94  103   3   0   0   0   0
c            122    1  77   0   0   0   0
d            163    7  29   1   0   0   0
e            142    0  58   0   0   0   0
f            159    0   2  14   0  25   0
g             64   21   1   0  24   0  90

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.182203
b                  0  0.449782
c                  4  0.242138
d                  3  0.171039
e                  4  0.172107
f                  3  0.166144
g                  6  0.443350

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.449782
1               f  0.069652
2               f  0.125000
3               a  0.182203
4               c  0.242138
5               g  0.120000
6               g  0.443350

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.182203
0                     b  0.449782
4                     c  0.242138
1                     d  0.004673
5                     e  0.000000
2                     f  0.125000
6                     g  0.443350
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_8M_embeddings
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.1610
NMI = 0.2803
Jaccard macro (true → best cluster) = 0.3268
Jaccard macro (cluster → best true) = 0.3323
Jaccard macro (Hungarian-aligned pairs) = 0.3263
Mapping-based clustering accuracy = 0.4371

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.262   0.480 0.339      200
b      0.853   0.495 0.627      200
c      0.314   0.385 0.346      200
d      0.258   0.320 0.286      200
e      0.270   0.255 0.262      200
f      0.984   0.605 0.749      200
g      0.920   0.520 0.665      200

Contingency table (true x pred):
pred   0   1   2    3   4   5    6
true                              
a      0  37  40    3  23  96    1
b     99  19  30    2   4  46    0
c      0  35  77    0  63  25    0
d      3  64  27    3  26  77    0
e      0  60  18    0  51  70    1
f      0  18  20    1  19  21  121
g     14  15  33  104   3  31    0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e    f    g
true                                     
a            96   0  40  37  23    1    3
b            46  99  30  19   4    0    2
c            25   0  77  35  63    0    0
d            77   3  27  64  26    0    3
e            70   0  18  60  51    1    0
f            21   0  20  18  19  121    1
g            31  14  33  15   3    0  104

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.204255
b                  0  0.456221
c                  2  0.209239
d                  1  0.166667
e                  1  0.154639
f                  6  0.599010
g                  3  0.497608

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.456221
1               d  0.166667
2               c  0.209239
3               g  0.497608
4               c  0.193252
5               a  0.204255
6               f  0.599010

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.204255
0                     b  0.456221
2                     c  0.209239
1                     d  0.166667
4                     e  0.150888
6                     f  0.599010
3                     g  0.497608
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_8M_embeddings
Similarity.Geodesic_Clustering.Spectral
ARI = 0.2528
NMI = 0.4401
Jaccard macro (true → best cluster) = 0.4420
Jaccard macro (cluster → best true) = 0.4328
Jaccard macro (Hungarian-aligned pairs) = 0.4328
Mapping-based clustering accuracy = 0.5479

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.324   0.220 0.262      200
b      0.920   0.575 0.708      200
c      0.689   0.575 0.627      200
d      0.248   0.740 0.372      200
e      0.786   0.220 0.344      200
f      0.987   0.760 0.859      200
g      0.898   0.745 0.814      200

Contingency table (true x pred):
pred    0    1    2   3    4   5    6
true                                 
a       0  141    6   2    6  44    1
b     115   76    2   3    1   3    0
c       1   48    0   3  115  33    0
d       7  148    3   4   18  20    0
e       0  122    6  44   27   0    1
f       0   40    0   0    0   8  152
g       2   21  149   0    0  28    0

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b    c    d   e    f    g
true                                        
a            44    0    6  141   2    1    6
b             3  115    1   76   3    0    2
c            33    1  115   48   3    0    0
d            20    7   18  148   4    0    3
e             0    0   27  122  44    1    6
f             8    0    0   40   0  152    0
g            28    2    0   21   0    0  149

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.215267
b                  0  0.547619
c                  4  0.456349
d                  1  0.228395
e                  3  0.207547
f                  6  0.752475
g                  2  0.686636

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.547619
1               d  0.228395
2               g  0.686636
3               e  0.207547
4               c  0.456349
5               a  0.150685
6               f  0.752475

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.150685
0                     b  0.547619
4                     c  0.456349
1                     d  0.228395
3                     e  0.207547
6                     f  0.752475
2                     g  0.686636
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_35M_embeddings
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0184
NMI = 0.1252
Jaccard macro (true → best cluster) = 0.1901
Jaccard macro (cluster → best true) = 0.1112
Jaccard macro (Hungarian-aligned pairs) = 0.1084
Mapping-based clustering accuracy = 0.2257

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.000   0.000 0.000      200
b      1.000   0.440 0.611      200
c      0.288   0.180 0.222      200
d      1.000   0.010 0.020      200
e      0.158   0.920 0.269      200
f      0.375   0.030 0.056      200
g      0.000   0.000 0.000      200

Contingency table (true x pred):
pred    0  1   2  3  4   5  6
true                         
a     176  2  22  0  0   0  0
b     107  0   5  0  0  88  0
c     155  7  36  0  2   0  0
d     178  1  18  1  0   0  2
e     184  0  16  0  0   0  0
f     182  6  12  0  0   0  0
g     184  0  16  0  0   0  0

Contingency after mapping (true x pred_mapped):
pred_mapped  a   b   c  d    e  f  g
true                                
a            0   0  22  0  176  2  0
b            0  88   5  0  107  0  0
c            0   0  36  0  155  7  2
d            1   0  18  2  178  1  0
e            0   0  16  0  184  0  0
f            0   0  12  0  182  6  0
g            0   0  16  0  184  0  0

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  0  0.147899
b                  5  0.440000
c                  0  0.127993
d                  0  0.149832
e                  0  0.155668
f                  0  0.153716
g                  0  0.155668

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.155668
1               c  0.033493
2               c  0.124567
3               d  0.005000
4               c  0.010000
5               b  0.440000
6               d  0.010000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.000000
5                     b  0.440000
2                     c  0.124567
6                     d  0.010000
0                     e  0.155668
1                     f  0.028571
4                     g  0.000000
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_35M_embeddings
Similarity.Cosine_Clustering.Kmeans
ARI = 0.1646
NMI = 0.3267
Jaccard macro (true → best cluster) = 0.3210
Jaccard macro (cluster → best true) = 0.3390
Jaccard macro (Hungarian-aligned pairs) = 0.2864
Mapping-based clustering accuracy = 0.3936

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.260   0.480 0.337      200
b      1.000   0.450 0.621      200
c      0.350   0.560 0.431      200
d      0.187   0.285 0.226      200
e      0.000   0.000 0.000      200
f      0.980   0.500 0.662      200
g      0.897   0.480 0.625      200

Contingency table (true x pred):
pred   0   1    2   3    4   5   6
true                              
a      3  96   41   5    1  54   0
b     17  33   16   5    0  39  90
c      0  18  112   0    0  70   0
d     10  90   42   1    0  57   0
e      0  73   80   0    1  46   0
f      0  35   28   0  100  37   0
g     77  24    1  96    0   2   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c   d   e    f   g
true                                     
a            96   0   41  54   3    1   5
b            33  90   16  39  17    0   5
c            18   0  112  70   0    0   0
d            90   0   42  57  10    0   1
e            73   0   80  46   0    1   0
f            35   0   28  37   0  100   0
g            24   0    1   2  77    0  96

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.202960
b                  6  0.450000
c                  2  0.274510
d                  1  0.187891
e                  2  0.181818
f                  4  0.495050
g                  3  0.454976

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.334783
1               a  0.202960
2               c  0.274510
3               g  0.454976
4               f  0.495050
5               c  0.160920
6               b  0.450000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.202960
6                     b  0.450000
2                     c  0.274510
5                     d  0.127232
0                     e  0.000000
4                     f  0.495050
3                     g  0.454976
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_35M_embeddings
Similarity.Cosine_Clustering.Spectral
ARI = 0.1748
NMI = 0.2737
Jaccard macro (true → best cluster) = 0.3022
Jaccard macro (cluster → best true) = 0.2925
Jaccard macro (Hungarian-aligned pairs) = 0.2770
Mapping-based clustering accuracy = 0.4029

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.203   0.120 0.151      200
b      0.961   0.490 0.649      200
c      0.373   0.410 0.390      200
d      0.193   0.160 0.175      200
e      0.291   0.185 0.226      200
f      0.281   0.655 0.393      200
g      0.800   0.800 0.800      200

Contingency table (true x pred):
pred    0   1   2   3   4    5   6
true                              
a      10  21  28  24   0  105  12
b      16  17   7   3  98   35  24
c       0  82  50  34   1   18  15
d      14  41  32  14   2   84  13
e       0  55  39   4   0   65  37
f       0   0   7  36   0  131  26
g     160   4   3   3   1   29   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e    f    g
true                                     
a            24   0  21  28  12  105   10
b             3  98  17   7  24   35   16
c            34   1  82  50  15   18    0
d            14   2  41  32  13   84   14
e             4   0  55  39  37   65    0
f            36   0   0   7  26  131    0
g             3   1   4   3   0   29  160

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.186833
b                  4  0.480392
c                  1  0.242604
d                  5  0.144082
e                  1  0.150685
f                  5  0.244403
g                  0  0.666667

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.666667
1               c  0.242604
2               c  0.158228
3               f  0.127660
4               b  0.480392
5               f  0.244403
6               e  0.127586

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.081633
4                     b  0.480392
1                     c  0.242604
2                     d  0.095808
6                     e  0.127586
5                     f  0.244403
0                     g  0.666667
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_35M_embeddings
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0500
NMI = 0.1263
Jaccard macro (true → best cluster) = 0.2012
Jaccard macro (cluster → best true) = 0.1487
Jaccard macro (Hungarian-aligned pairs) = 0.1405
Mapping-based clustering accuracy = 0.2679

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.111   0.010 0.018      200
b      1.000   0.435 0.606      200
c      0.249   0.345 0.289      200
d      1.000   0.005 0.010      200
e      0.180   0.425 0.253      200
f      0.238   0.645 0.348      200
g      1.000   0.010 0.020      200

Contingency table (true x pred):
pred   0    1   2  3  4  5   6
true                          
a     33  105  60  0  0  2   0
b     20   38  55  0  0  0  87
c     69   25  97  0  0  9   0
d     40   96  62  0  1  1   0
e     40   75  85  0  0  0   0
f     18  129  47  0  0  6   0
g     57   74  67  2  0  0   0

Contingency after mapping (true x pred_mapped):
pred_mapped  a   b   c  d   e    f  g
true                                 
a            2   0  33  0  60  105  0
b            0  87  20  0  55   38  0
c            9   0  69  0  97   25  0
d            1   0  40  1  62   96  0
e            0   0  40  0  85   75  0
f            6   0  18  0  47  129  0
g            0   0  57  0  67   74  2

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.164835
b                  6  0.435000
c                  0  0.169118
d                  1  0.148607
e                  2  0.144558
f                  1  0.210440
g                  0  0.135714

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.169118
1               f  0.210440
2               c  0.168403
3               g  0.010000
4               d  0.005000
5               c  0.043062
6               b  0.435000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.009259
6                     b  0.435000
0                     c  0.169118
4                     d  0.005000
2                     e  0.144558
1                     f  0.210440
3                     g  0.010000
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_35M_embeddings
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.1646
NMI = 0.3267
Jaccard macro (true → best cluster) = 0.3210
Jaccard macro (cluster → best true) = 0.3390
Jaccard macro (Hungarian-aligned pairs) = 0.2864
Mapping-based clustering accuracy = 0.3936

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.260   0.480 0.337      200
b      1.000   0.450 0.621      200
c      0.350   0.560 0.431      200
d      0.187   0.285 0.226      200
e      0.000   0.000 0.000      200
f      0.980   0.500 0.662      200
g      0.897   0.480 0.625      200

Contingency table (true x pred):
pred   0   1    2   3    4   5   6
true                              
a      3  96   41   5    1  54   0
b     17  33   16   5    0  39  90
c      0  18  112   0    0  70   0
d     10  90   42   1    0  57   0
e      0  73   80   0    1  46   0
f      0  35   28   0  100  37   0
g     77  24    1  96    0   2   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c   d   e    f   g
true                                     
a            96   0   41  54   3    1   5
b            33  90   16  39  17    0   5
c            18   0  112  70   0    0   0
d            90   0   42  57  10    0   1
e            73   0   80  46   0    1   0
f            35   0   28  37   0  100   0
g            24   0    1   2  77    0  96

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.202960
b                  6  0.450000
c                  2  0.274510
d                  1  0.187891
e                  2  0.181818
f                  4  0.495050
g                  3  0.454976

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.334783
1               a  0.202960
2               c  0.274510
3               g  0.454976
4               f  0.495050
5               c  0.160920
6               b  0.450000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.202960
6                     b  0.450000
2                     c  0.274510
5                     d  0.127232
0                     e  0.000000
4                     f  0.495050
3                     g  0.454976
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_35M_embeddings
Similarity.Euclidean_Clustering.Spectral
ARI = 0.1794
NMI = 0.2677
Jaccard macro (true → best cluster) = 0.2996
Jaccard macro (cluster → best true) = 0.2970
Jaccard macro (Hungarian-aligned pairs) = 0.2828
Mapping-based clustering accuracy = 0.3893

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.235   0.410 0.299      200
b      0.979   0.460 0.626      200
c      0.396   0.325 0.357      200
d      0.189   0.245 0.214      200
e      0.233   0.225 0.229      200
f      0.315   0.235 0.269      200
g      0.859   0.825 0.842      200

Contingency table (true x pred):
pred    0   1   2   3   4   5   6
true                             
a       5  82  46   0  27  13  27
b      17  18  26  92  10  27  10
c       0  13  69   0  65  13  40
d       5  71  49   2  32  11  30
e       0  49  62   0   8  36  45
f       0  98   1   0  17  47  37
g     165  18   6   0   5   2   4

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            82   0  27  46  27  13    5
b            18  92  10  26  10  27   17
c            13   0  65  69  40  13    0
d            71   2  32  49  30  11    5
e            49   0   8  62  45  36    0
f            98   0  17   1  37  47    0
g            18   0   5   6   4   2  165

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.175589
b                  3  0.455446
c                  4  0.217391
d                  1  0.148536
e                  2  0.156171
f                  1  0.217295
g                  0  0.726872

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.726872
1               f  0.217295
2               c  0.176923
3               b  0.455446
4               c  0.217391
5               f  0.155629
6               e  0.129310

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.175589
3                     b  0.455446
4                     c  0.217391
2                     d  0.119512
6                     e  0.129310
5                     f  0.155629
0                     g  0.726872
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_35M_embeddings
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0948
NMI = 0.2574
Jaccard macro (true → best cluster) = 0.2411
Jaccard macro (cluster → best true) = 0.2209
Jaccard macro (Hungarian-aligned pairs) = 0.1773
Mapping-based clustering accuracy = 0.3307

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.223   0.710 0.339      200
b      0.685   0.510 0.585      200
c      0.313   0.750 0.442      200
d      0.062   0.005 0.009      200
e      0.000   0.000 0.000      200
f      1.000   0.085 0.157      200
g      0.944   0.255 0.402      200

Contingency table (true x pred):
pred    0    1   2    3   4   5   6
true                               
a     142   58   0    0   0   0   0
b      59   36   0  102   0   0   3
c      50  150   0    0   0   0   0
d     112   79   1    8   0   0   0
e      87  113   0    0   0   0   0
f     129   39  15    0   0  17   0
g      59    4   0   39  47   0  51

Contingency after mapping (true x pred_mapped):
pred_mapped    a    b    c   d   e   f   g
true                                      
a            142    0   58   0   0   0   0
b             59  102   36   0   0   0   3
c             50    0  150   0   0   0   0
d            112    8   79   1   0   0   0
e             87    0  113   0   0   0   0
f            129    0   39  15   0  17   0
g             59   39    4   0  47   0  51

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  0  0.204023
b                  3  0.412955
c                  1  0.283554
d                  0  0.154270
e                  1  0.199647
f                  0  0.181946
g                  6  0.251232

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               a  0.204023
1               c  0.283554
2               f  0.074627
3               b  0.412955
4               g  0.235000
5               f  0.085000
6               g  0.251232

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
0                     a  0.204023
3                     b  0.412955
1                     c  0.283554
2                     d  0.004651
4                     e  0.000000
5                     f  0.085000
6                     g  0.251232
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_35M_embeddings
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.1646
NMI = 0.3267
Jaccard macro (true → best cluster) = 0.3210
Jaccard macro (cluster → best true) = 0.3390
Jaccard macro (Hungarian-aligned pairs) = 0.2864
Mapping-based clustering accuracy = 0.3936

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.260   0.480 0.337      200
b      1.000   0.450 0.621      200
c      0.350   0.560 0.431      200
d      0.187   0.285 0.226      200
e      0.000   0.000 0.000      200
f      0.980   0.500 0.662      200
g      0.897   0.480 0.625      200

Contingency table (true x pred):
pred   0   1    2   3    4   5   6
true                              
a      3  96   41   5    1  54   0
b     17  33   16   5    0  39  90
c      0  18  112   0    0  70   0
d     10  90   42   1    0  57   0
e      0  73   80   0    1  46   0
f      0  35   28   0  100  37   0
g     77  24    1  96    0   2   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c   d   e    f   g
true                                     
a            96   0   41  54   3    1   5
b            33  90   16  39  17    0   5
c            18   0  112  70   0    0   0
d            90   0   42  57  10    0   1
e            73   0   80  46   0    1   0
f            35   0   28  37   0  100   0
g            24   0    1   2  77    0  96

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.202960
b                  6  0.450000
c                  2  0.274510
d                  1  0.187891
e                  2  0.181818
f                  4  0.495050
g                  3  0.454976

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.334783
1               a  0.202960
2               c  0.274510
3               g  0.454976
4               f  0.495050
5               c  0.160920
6               b  0.450000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.202960
6                     b  0.450000
2                     c  0.274510
5                     d  0.127232
0                     e  0.000000
4                     f  0.495050
3                     g  0.454976
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_35M_embeddings
Similarity.Geodesic_Clustering.Spectral
ARI = 0.2095
NMI = 0.3707
Jaccard macro (true → best cluster) = 0.3604
Jaccard macro (cluster → best true) = 0.3723
Jaccard macro (Hungarian-aligned pairs) = 0.3407
Mapping-based clustering accuracy = 0.4643

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.245   0.505 0.330      200
b      0.956   0.540 0.690      200
c      0.373   0.765 0.502      200
d      0.132   0.080 0.100      200
e      0.449   0.220 0.295      200
f      0.993   0.670 0.800      200
g      0.847   0.470 0.605      200

Contingency table (true x pred):
pred   0    1    2    3   4    5   6
true                                
a     17    0   74    0   2  101   6
b     12    0   28  108   4   38  10
c      6    0  153    1  14   26   0
d     16    0   72    4  10   98   0
e      1    1   79    0  44   75   0
f      0  134    2    0  24   39   1
g     69    0    2    0   0   35  94

Contingency after mapping (true x pred_mapped):
pred_mapped    a    b    c   d   e    f   g
true                                       
a            101    0   74  17   2    0   6
b             38  108   28  12   4    0  10
c             26    1  153   6  14    0   0
d             98    4   72  16  10    0   0
e             75    0   79   1  44    1   0
f             39    0    2   0  24  134   1
g             35    0    2  69   0    0  94

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.197652
b                  3  0.526829
c                  2  0.334792
d                  5  0.190661
e                  4  0.173228
f                  1  0.666667
g                  6  0.433180

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.273810
1               f  0.666667
2               c  0.334792
3               b  0.526829
4               e  0.173228
5               a  0.197652
6               g  0.433180

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.197652
3                     b  0.526829
2                     c  0.334792
0                     d  0.052459
4                     e  0.173228
1                     f  0.666667
6                     g  0.433180
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
esm2_150M_embeddings
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0159
NMI = 0.1224
Jaccard macro (true → best cluster) = 0.1895
Jaccard macro (cluster → best true) = 0.0924
Jaccard macro (Hungarian-aligned pairs) = 0.0917
Mapping-based clustering accuracy = 0.2129

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.000   0.000 0.000      200
b      1.000   0.420 0.592      200
c      0.257   0.045 0.077      200
d      0.500   0.005 0.010      200
e      0.157   1.000 0.272      200
f      0.750   0.015 0.029      200
g      0.333   0.005 0.010      200

Contingency table (true x pred):
pred   0    1  2  3  4  5  6
true                        
a      0  194  0  0  0  0  6
b     84  113  0  0  0  0  3
c      0  189  1  0  0  1  9
d      0  193  1  0  1  0  5
e      0  200  0  0  0  0  0
f      0  189  0  0  1  3  7
g      0  193  0  1  1  0  5

Contingency after mapping (true x pred_mapped):
pred_mapped  a   b  c  d    e  f  g
true                               
a            0   0  6  0  194  0  0
b            0  84  3  0  113  0  0
c            0   0  9  1  189  1  0
d            0   0  5  1  193  0  1
e            0   0  0  0  200  0  0
f            0   0  7  0  189  3  1
g            1   0  5  0  193  0  1

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.151919
b                  0  0.420000
c                  1  0.147426
d                  1  0.151017
e                  1  0.157356
f                  1  0.147426
g                  1  0.151017

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.420000
1               e  0.157356
2               c  0.004975
3               g  0.005000
4               d  0.004950
5               f  0.014925
6               c  0.039823

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.000000
0                     b  0.420000
6                     c  0.039823
2                     d  0.004975
1                     e  0.157356
5                     f  0.014925
4                     g  0.004950
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
esm2_150M_embeddings
Similarity.Cosine_Clustering.Kmeans
ARI = 0.1380
NMI = 0.2347
Jaccard macro (true → best cluster) = 0.2771
Jaccard macro (cluster → best true) = 0.2789
Jaccard macro (Hungarian-aligned pairs) = 0.2696
Mapping-based clustering accuracy = 0.3829

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.228   0.315 0.265      200
b      0.989   0.440 0.609      200
c      0.356   0.235 0.283      200
d      0.210   0.360 0.265      200
e      0.387   0.205 0.268      200
f      0.302   0.440 0.358      200
g      0.840   0.685 0.755      200

Contingency table (true x pred):
pred   0   1   2   3   4    5   6
true                             
a      0  19  44  67   5    2  63
b     88   9  20  25  12   17  29
c      0  47   4  97  15    0  37
d      1  17  53  72  10    7  40
e      0  12  42  63  41    0  42
f      0  19  88  17  23    0  53
g      0   9  40   2   0  137  12

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            63   0  19  67   5  44    2
b            29  88   9  25  12  20   17
c            37   0  47  97  15   4    0
d            40   1  17  72  10  53    7
e            42   0  12  63  41  42    0
f            53   0  19  17  23  88    0
g            12   0   9   2   0  40  137

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  6  0.152542
b                  0  0.437811
c                  3  0.217489
d                  3  0.152866
e                  4  0.154717
f                  2  0.218362
g                  5  0.606195

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.437811
1               c  0.164912
2               f  0.218362
3               c  0.217489
4               e  0.154717
5               g  0.606195
6               a  0.152542

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.152542
0                     b  0.437811
1                     c  0.164912
3                     d  0.152866
4                     e  0.154717
2                     f  0.218362
5                     g  0.606195
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
esm2_150M_embeddings
Similarity.Cosine_Clustering.Spectral
ARI = 0.1713
NMI = 0.2509
Jaccard macro (true → best cluster) = 0.2773
Jaccard macro (cluster → best true) = 0.2840
Jaccard macro (Hungarian-aligned pairs) = 0.2708
Mapping-based clustering accuracy = 0.3957

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.241   0.100 0.141      200
b      0.958   0.460 0.622      200
c      0.319   0.420 0.363      200
d      0.208   0.290 0.242      200
e      0.253   0.245 0.249      200
f      0.336   0.450 0.385      200
g      0.742   0.805 0.772      200

Contingency table (true x pred):
pred   0   1   2    3   4   5   6
true                             
a     42  52  16   20   0  50  20
b     15  24  30   21  92  13   5
c      5  76  23    1   0  84  11
d     51  58  14   13   3  46  15
e     46  59  49    0   0  43   3
f     90   3  60    1   0  25  21
g     19   7   2  161   1   2   8

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            20   0  50  52  16  42   20
b             5  92  13  24  30  15   21
c            11   0  84  76  23   5    1
d            15   3  46  58  14  51   13
e             3   0  43  59  49  46    0
f            21   0  25   3  60  90    1
g             8   1   2   7   2  19  161

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.121780
b                  4  0.450980
c                  5  0.221636
d                  1  0.137767
e                  2  0.142029
f                  0  0.238095
g                  3  0.628906

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               f  0.238095
1               c  0.188586
2               f  0.179641
3               g  0.628906
4               b  0.450980
5               c  0.221636
6               f  0.080153

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.076046
4                     b  0.450980
5                     c  0.221636
1                     d  0.137767
2                     e  0.142029
0                     f  0.238095
3                     g  0.628906
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
esm2_150M_embeddings
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0468
NMI = 0.1413
Jaccard macro (true → best cluster) = 0.2121
Jaccard macro (cluster → best true) = 0.1379
Jaccard macro (Hungarian-aligned pairs) = 0.1285
Mapping-based clustering accuracy = 0.2671

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.138   0.065 0.088      200
b      1.000   0.420 0.592      200
c      0.201   0.825 0.324      200
d      0.200   0.005 0.010      200
e      0.000   0.000 0.000      200
f      0.277   0.545 0.368      200
g      0.500   0.010 0.020      200

Contingency table (true x pred):
pred    0    1   2  3  4   5  6
true                           
a      52  135  13  0  0   0  0
b      23   89   4  0  0  84  0
c       7  165  26  1  0   0  1
d      57  128  13  1  1   0  0
e      49  138  13  0  0   0  0
f     109   67  20  3  1   0  0
g      96   97   5  0  2   0  0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c  d  e    f  g
true                                  
a            13   0  135  0  0   52  0
b             4  84   89  0  0   23  0
c            26   0  165  1  1    7  0
d            13   0  128  1  0   57  1
e            13   0  138  0  0   49  0
f            20   0   67  3  0  109  1
g             5   0   97  0  0   96  2

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  1  0.152715
b                  5  0.420000
c                  1  0.193208
d                  1  0.143659
e                  1  0.156640
f                  0  0.225207
g                  0  0.193159

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               f  0.225207
1               c  0.193208
2               c  0.097015
3               f  0.014851
4               g  0.009901
5               b  0.420000
6               c  0.005000

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
2                     a  0.046263
5                     b  0.420000
1                     c  0.193208
3                     d  0.004902
6                     e  0.000000
0                     f  0.225207
4                     g  0.009901
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
esm2_150M_embeddings
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.1380
NMI = 0.2347
Jaccard macro (true → best cluster) = 0.2771
Jaccard macro (cluster → best true) = 0.2789
Jaccard macro (Hungarian-aligned pairs) = 0.2696
Mapping-based clustering accuracy = 0.3829

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.228   0.315 0.265      200
b      0.989   0.440 0.609      200
c      0.356   0.235 0.283      200
d      0.210   0.360 0.265      200
e      0.387   0.205 0.268      200
f      0.302   0.440 0.358      200
g      0.840   0.685 0.755      200

Contingency table (true x pred):
pred   0   1   2   3   4    5   6
true                             
a      0  19  44  67   5    2  63
b     88   9  20  25  12   17  29
c      0  47   4  97  15    0  37
d      1  17  53  72  10    7  40
e      0  12  42  63  41    0  42
f      0  19  88  17  23    0  53
g      0   9  40   2   0  137  12

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            63   0  19  67   5  44    2
b            29  88   9  25  12  20   17
c            37   0  47  97  15   4    0
d            40   1  17  72  10  53    7
e            42   0  12  63  41  42    0
f            53   0  19  17  23  88    0
g            12   0   9   2   0  40  137

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  6  0.152542
b                  0  0.437811
c                  3  0.217489
d                  3  0.152866
e                  4  0.154717
f                  2  0.218362
g                  5  0.606195

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.437811
1               c  0.164912
2               f  0.218362
3               c  0.217489
4               e  0.154717
5               g  0.606195
6               a  0.152542

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.152542
0                     b  0.437811
1                     c  0.164912
3                     d  0.152866
4                     e  0.154717
2                     f  0.218362
5                     g  0.606195
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
esm2_150M_embeddings
Similarity.Euclidean_Clustering.Spectral
ARI = 0.2040
NMI = 0.2799
Jaccard macro (true → best cluster) = 0.3235
Jaccard macro (cluster → best true) = 0.3221
Jaccard macro (Hungarian-aligned pairs) = 0.3221
Mapping-based clustering accuracy = 0.4500

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.267   0.435 0.331      200
b      0.969   0.465 0.628      200
c      0.354   0.375 0.364      200
d      0.257   0.260 0.259      200
e      0.273   0.205 0.234      200
f      0.546   0.565 0.555      200
g      0.816   0.845 0.830      200

Contingency table (true x pred):
pred   0   1    2   3    4   5   6
true                              
a     87  10    9   0   20  43  31
b     25  31   19  93    7  13  12
c     73  23    0   1   23   5  75
d     72  13   10   2   17  52  34
e     58  41    0   0   25  43  33
f      6  30    0   0  113  31  20
g      5   2  169   0    2  15   7

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e    f    g
true                                     
a            87   0  31  43  10   20    9
b            25  93  12  13  31    7   19
c            73   1  75   5  23   23    0
d            72   2  34  52  13   17   10
e            58   0  33  43  41   25    0
f             6   0  20  31  30  113    0
g             5   0   7  15   2    2  169

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  0  0.198178
b                  3  0.458128
c                  6  0.222552
d                  0  0.158590
e                  1  0.132686
f                  4  0.384354
g                  2  0.710084

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               a  0.198178
1               e  0.132686
2               g  0.710084
3               b  0.458128
4               f  0.384354
5               d  0.148571
6               c  0.222552

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
0                     a  0.198178
3                     b  0.458128
6                     c  0.222552
5                     d  0.148571
1                     e  0.132686
4                     f  0.384354
2                     g  0.710084
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
esm2_150M_embeddings
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0927
NMI = 0.2470
Jaccard macro (true → best cluster) = 0.2443
Jaccard macro (cluster → best true) = 0.2375
Jaccard macro (Hungarian-aligned pairs) = 0.1793
Mapping-based clustering accuracy = 0.3200

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.129   0.055 0.077      200
b      1.000   0.415 0.587      200
c      0.233   0.860 0.367      200
d      0.400   0.010 0.020      200
e      0.000   0.000 0.000      200
f      0.331   0.570 0.419      200
g      0.767   0.330 0.462      200

Contingency table (true x pred):
pred   0    1   2  3   4    5   6
true                             
a      0   54  11  0   0  134   1
b     12   25   3  0  83   77   0
c      1    9  18  0   0  172   0
d      7   57  10  2   0  124   0
e      0   51   2  0   0  147   0
f      0  114  38  1   0   47   0
g     66   34   3  2   0   36  59

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b    c  d   e    f   g
true                                    
a            11   0  134  0   1   54   0
b             3  83   77  0   0   25  12
c            18   0  172  0   0    9   1
d            10   0  124  2   0   57   7
e             2   0  147  0   0   51   0
f            38   0   47  1   0  114   0
g             3   0   36  2  59   34  66

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.166874
b                  4  0.415000
c                  5  0.224837
d                  5  0.152522
e                  5  0.186076
f                  1  0.265116
g                  0  0.300000

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.300000
1               f  0.265116
2               f  0.153846
3               d  0.009852
4               b  0.415000
5               c  0.224837
6               g  0.293532

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
2                     a  0.040146
4                     b  0.415000
5                     c  0.224837
3                     d  0.009852
6                     e  0.000000
1                     f  0.265116
0                     g  0.300000
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
esm2_150M_embeddings
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.1380
NMI = 0.2347
Jaccard macro (true → best cluster) = 0.2771
Jaccard macro (cluster → best true) = 0.2789
Jaccard macro (Hungarian-aligned pairs) = 0.2696
Mapping-based clustering accuracy = 0.3829

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.228   0.315 0.265      200
b      0.989   0.440 0.609      200
c      0.356   0.235 0.283      200
d      0.210   0.360 0.265      200
e      0.387   0.205 0.268      200
f      0.302   0.440 0.358      200
g      0.840   0.685 0.755      200

Contingency table (true x pred):
pred   0   1   2   3   4    5   6
true                             
a      0  19  44  67   5    2  63
b     88   9  20  25  12   17  29
c      0  47   4  97  15    0  37
d      1  17  53  72  10    7  40
e      0  12  42  63  41    0  42
f      0  19  88  17  23    0  53
g      0   9  40   2   0  137  12

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            63   0  19  67   5  44    2
b            29  88   9  25  12  20   17
c            37   0  47  97  15   4    0
d            40   1  17  72  10  53    7
e            42   0  12  63  41  42    0
f            53   0  19  17  23  88    0
g            12   0   9   2   0  40  137

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  6  0.152542
b                  0  0.437811
c                  3  0.217489
d                  3  0.152866
e                  4  0.154717
f                  2  0.218362
g                  5  0.606195

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.437811
1               c  0.164912
2               f  0.218362
3               c  0.217489
4               e  0.154717
5               g  0.606195
6               a  0.152542

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.152542
0                     b  0.437811
1                     c  0.164912
3                     d  0.152866
4                     e  0.154717
2                     f  0.218362
5                     g  0.606195
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
esm2_150M_embeddings
Similarity.Geodesic_Clustering.Spectral
ARI = 0.1913
NMI = 0.3092
Jaccard macro (true → best cluster) = 0.3421
Jaccard macro (cluster → best true) = 0.3498
Jaccard macro (Hungarian-aligned pairs) = 0.3418
Mapping-based clustering accuracy = 0.4600

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.292   0.465 0.359      200
b      0.871   0.505 0.639      200
c      0.399   0.615 0.484      200
d      0.234   0.280 0.255      200
e      0.240   0.215 0.227      200
f      0.992   0.625 0.767      200
g      0.904   0.515 0.656      200

Contingency table (true x pred):
pred    0    1   2    3   4    5   6
true                                
a      46    3  93    0   7    0  51
b      16    6  30    0  21  101  26
c     123    0  54    0  13    1   9
d      57    1  67    1  11    7  56
e      56    1  47    0  43    6  47
f       6    0  16  125  25    0  28
g       4  103  11    0  59    1  22

Contingency after mapping (true x pred_mapped):
pred_mapped   a    b    c   d   e    f    g
true                                       
a            93    0   46  51   7    0    3
b            30  101   16  26  21    0    6
c            54    1  123   9  13    0    0
d            67    7   57  56  11    1    1
e            47    6   56  47  43    0    1
f            16    0    6  28  25  125    0
g            11    1    4  22  59    0  103

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  2  0.218824
b                  5  0.469767
c                  0  0.319481
d                  2  0.148559
e                  4  0.127976
f                  3  0.621891
g                  1  0.488152

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.319481
1               g  0.488152
2               a  0.218824
3               f  0.621891
4               g  0.184375
5               b  0.469767
6               d  0.146214

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
2                     a  0.218824
5                     b  0.469767
0                     c  0.319481
6                     d  0.146214
4                     e  0.127976
3                     f  0.621891
1                     g  0.488152
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
prot_bert_embeddings
Similarity.Cosine_Clustering.Hierarchical
ARI = 0.0132
NMI = 0.0567
Jaccard macro (true → best cluster) = 0.1400
Jaccard macro (cluster → best true) = 0.0789
Jaccard macro (Hungarian-aligned pairs) = 0.0768
Mapping-based clustering accuracy = 0.2129

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.000   0.000 0.000      200
b      0.254   0.240 0.247      200
c      0.247   0.185 0.211      200
d      0.211   0.020 0.037      200
e      0.350   0.070 0.117      200
f      0.250   0.005 0.010      200
g      0.195   0.970 0.324      200

Contingency table (true x pred):
pred   0  1   2  3    4  5   6
true                          
a      0  0  17  0  158  1  24
b      0  0   7  0  140  5  48
c     11  2  37  0  126  4  20
d      4  1  18  0  147  4  26
e     14  0  36  1  121  4  24
f     11  1  34  0  111  1  42
g      0  0   1  0  194  0   5

Contingency after mapping (true x pred_mapped):
pred_mapped  a   b   c  d   e  f    g
true                                 
a            0  24  17  1   0  0  158
b            0  48   7  5   0  0  140
c            0  20  37  4  11  2  126
d            0  26  18  4   4  1  147
e            1  24  36  4  14  0  121
f            0  42  34  1  11  1  111
g            0   5   1  0   0  0  194

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  4  0.152069
b                  6  0.140762
c                  2  0.118211
d                  4  0.140000
e                  2  0.114650
f                  6  0.121037
g                  4  0.193420

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               e  0.061947
1               c  0.009901
2               c  0.118211
3               e  0.005000
4               g  0.193420
5               b  0.023364
6               b  0.140762

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.000000
6                     b  0.140762
2                     c  0.118211
5                     d  0.018605
0                     e  0.061947
1                     f  0.004926
4                     g  0.193420
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Hierarchical.png
prot_bert_embeddings
Similarity.Cosine_Clustering.Kmeans
ARI = 0.0787
NMI = 0.1470
Jaccard macro (true → best cluster) = 0.1944
Jaccard macro (cluster → best true) = 0.2099
Jaccard macro (Hungarian-aligned pairs) = 0.1891
Mapping-based clustering accuracy = 0.2943

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.198   0.260 0.225      200
b      0.364   0.390 0.377      200
c      0.206   0.350 0.260      200
d      0.181   0.160 0.170      200
e      0.312   0.250 0.278      200
f      0.219   0.140 0.171      200
g      0.850   0.510 0.637      200

Contingency table (true x pred):
pred    0   1   2   3   4   5   6
true                             
a       5  12  41  20   9  61  52
b       6   6  78  19   7  49  35
c       0  34   9   6  37  70  44
d       7  16  26  32  21  54  44
e       0  31  14  12  50  55  38
f       0  28  34  21  36  41  40
g     102   1  12  67   0   9   9

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            52  41  61  20   9  12    5
b            35  78  49  19   7   6    6
c            44   9  70   6  37  34    0
d            44  26  54  32  21  16    7
e            38  14  55  12  50  31    0
f            40  34  41  21  36  28    0
g             9  12   9  67   0   1  102

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.127615
b                  2  0.232143
c                  5  0.149254
d                  5  0.111340
e                  4  0.161290
f                  4  0.111111
g                  0  0.467890

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.467890
1               c  0.115646
2               b  0.232143
3               g  0.216129
4               e  0.161290
5               c  0.149254
6               a  0.126829

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.126829
2                     b  0.232143
5                     c  0.149254
3                     d  0.092754
4                     e  0.161290
1                     f  0.093333
0                     g  0.467890
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Kmeans.png
prot_bert_embeddings
Similarity.Cosine_Clustering.Spectral
ARI = 0.0812
NMI = 0.1285
Jaccard macro (true → best cluster) = 0.1957
Jaccard macro (cluster → best true) = 0.1858
Jaccard macro (Hungarian-aligned pairs) = 0.1809
Mapping-based clustering accuracy = 0.3143

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.263   0.300 0.280      200
b      0.609   0.460 0.524      200
c      0.271   0.160 0.201      200
d      0.214   0.075 0.111      200
e      0.232   0.195 0.212      200
f      0.258   0.340 0.293      200
g      0.334   0.670 0.446      200

Contingency table (true x pred):
pred   0    1   2   3   4   5   6
true                             
a     31   56   9   4  33  60   7
b     13   52   6  92  12  22   3
c     63   39  32   3  36  14  13
d     38   63  14   5  27  38  15
e     47   35  31   8  39  17  23
f     68   22  24   4  17  56   9
g      4  134   2  35   4  21   0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            60   4   9   7  33  31   56
b            22  92   6   3  12  13   52
c            14   3  32  13  36  63   39
d            38   5  14  15  27  38   63
e            17   8  31  23  39  47   35
f            56   4  24   9  17  68   22
g            21  35   2   0   4   4  134

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.163043
b                  3  0.355212
c                  0  0.157107
d                  1  0.117100
e                  4  0.118541
f                  0  0.171717
g                  1  0.286938

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               f  0.171717
1               g  0.286938
2               c  0.111888
3               b  0.355212
4               e  0.118541
5               a  0.163043
6               e  0.093117

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
5                     a  0.163043
3                     b  0.355212
2                     c  0.111888
6                     d  0.058824
4                     e  0.118541
0                     f  0.171717
1                     g  0.286938
[saved] ./data/confusion_matrix_Similarity.Cosine_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Cosine_Clustering.Spectral.png
prot_bert_embeddings
Similarity.Euclidean_Clustering.Hierarchical
ARI = 0.0349
NMI = 0.0690
Jaccard macro (true → best cluster) = 0.1444
Jaccard macro (cluster → best true) = 0.1281
Jaccard macro (Hungarian-aligned pairs) = 0.1089
Mapping-based clustering accuracy = 0.2257

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.155   0.255 0.193      200
b      0.222   0.375 0.279      200
c      0.400   0.010 0.020      200
d      0.177   0.140 0.156      200
e      0.266   0.235 0.249      200
f      0.353   0.030 0.055      200
g      0.284   0.535 0.371      200

Contingency table (true x pred):
pred   0   1    2   3  4   5  6
true                           
a     51  17   54  19  0  59  0
b     57   8   46  14  0  75  0
c     51  44   38   5  2  56  4
d     50  20   54  28  1  46  1
e     54  47   36  12  1  44  6
f     54  40   42  19  1  38  6
g     11   1  107  61  0  20  0

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b  c   d   e  f    g
true                                  
a            51  59  0  19  17  0   54
b            57  75  0  14   8  0   46
c            51  56  2   5  44  4   38
d            50  46  1  28  20  1   54
e            54  44  1  12  47  6   36
f            54  38  1  19  40  6   42
g            11  20  0  61   1  0  107

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.123173
b                  5  0.161987
c                  1  0.132132
d                  0  0.104603
e                  1  0.142424
f                  1  0.118694
g                  2  0.227660

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               b  0.121019
1               e  0.142424
2               g  0.227660
3               g  0.205387
4               c  0.009852
5               b  0.161987
6               e  0.028436

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
0                     a  0.106918
5                     b  0.161987
4                     c  0.009852
3                     d  0.084848
1                     e  0.142424
6                     f  0.028436
2                     g  0.227660
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Hierarchical.png
prot_bert_embeddings
Similarity.Euclidean_Clustering.Kmeans
ARI = 0.0787
NMI = 0.1470
Jaccard macro (true → best cluster) = 0.1944
Jaccard macro (cluster → best true) = 0.2099
Jaccard macro (Hungarian-aligned pairs) = 0.1891
Mapping-based clustering accuracy = 0.2943

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.198   0.260 0.225      200
b      0.364   0.390 0.377      200
c      0.206   0.350 0.260      200
d      0.181   0.160 0.170      200
e      0.312   0.250 0.278      200
f      0.219   0.140 0.171      200
g      0.850   0.510 0.637      200

Contingency table (true x pred):
pred    0   1   2   3   4   5   6
true                             
a       5  12  41  20   9  61  52
b       6   6  78  19   7  49  35
c       0  34   9   6  37  70  44
d       7  16  26  32  21  54  44
e       0  31  14  12  50  55  38
f       0  28  34  21  36  41  40
g     102   1  12  67   0   9   9

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            52  41  61  20   9  12    5
b            35  78  49  19   7   6    6
c            44   9  70   6  37  34    0
d            44  26  54  32  21  16    7
e            38  14  55  12  50  31    0
f            40  34  41  21  36  28    0
g             9  12   9  67   0   1  102

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.127615
b                  2  0.232143
c                  5  0.149254
d                  5  0.111340
e                  4  0.161290
f                  4  0.111111
g                  0  0.467890

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.467890
1               c  0.115646
2               b  0.232143
3               g  0.216129
4               e  0.161290
5               c  0.149254
6               a  0.126829

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.126829
2                     b  0.232143
5                     c  0.149254
3                     d  0.092754
4                     e  0.161290
1                     f  0.093333
0                     g  0.467890
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Kmeans.png
prot_bert_embeddings
Similarity.Euclidean_Clustering.Spectral
ARI = 0.0888
NMI = 0.1514
Jaccard macro (true → best cluster) = 0.1963
Jaccard macro (cluster → best true) = 0.1807
Jaccard macro (Hungarian-aligned pairs) = 0.1719
Mapping-based clustering accuracy = 0.2893

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.198   0.285 0.234      200
b      0.465   0.460 0.462      200
c      0.254   0.175 0.207      200
d      0.170   0.155 0.162      200
e      0.295   0.260 0.277      200
f      0.304   0.375 0.336      200
g      0.368   0.315 0.340      200

Contingency table (true x pred):
pred   0   1   2   3   4   5   6
true                            
a     34  57  21  58  14  15   1
b     12  37  18  23  11   7  92
c     46  52   5  21  41  35   0
d     31  49  31  39  25  17   8
e     38  44  11  20  52  33   2
f     17  25  22  75  33  28   0
g      4  24  63  11   0   3  95

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f   g
true                                   
a            57   1  15  34  14  58  21
b            37  92   7  12  11  23  18
c            52   0  35  46  41  21   5
d            49   8  17  31  25  39  31
e            44   2  33  38  52  20  11
f            25   0  28  17  33  75  22
g            24  95   3   4   0  11  63

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.149100
b                  6  0.300654
c                  0  0.136905
d                  1  0.111617
e                  4  0.160494
f                  3  0.201613
g                  6  0.313531

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               c  0.136905
1               a  0.132251
2               g  0.204545
3               f  0.201613
4               e  0.160494
5               c  0.115512
6               g  0.313531

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
1                     a  0.132251
6                     b  0.300654
5                     c  0.115512
0                     d  0.088319
4                     e  0.160494
3                     f  0.201613
2                     g  0.204545
[saved] ./data/confusion_matrix_Similarity.Euclidean_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Euclidean_Clustering.Spectral.png
prot_bert_embeddings
Similarity.Geodesic_Clustering.Hierarchical
ARI = 0.0892
NMI = 0.1819
Jaccard macro (true → best cluster) = 0.2170
Jaccard macro (cluster → best true) = 0.2124
Jaccard macro (Hungarian-aligned pairs) = 0.1917
Mapping-based clustering accuracy = 0.3079

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.198   0.400 0.264      200
b      0.978   0.440 0.607      200
c      0.206   0.350 0.260      200
d      0.220   0.145 0.175      200
e      0.280   0.230 0.253      200
f      0.000   0.000 0.000      200
g      0.488   0.590 0.534      200

Contingency table (true x pred):
pred   0    1   2   3   4   5   6
true                             
a     80   30  58  13   0  19   0
b     32   38  21   5  88  16   0
c     74   10  70  41   0   5   0
d     70   25  55  19   1  29   1
e     67   11  64  46   0  12   0
f     64   10  67  39   1  19   0
g     18  118   4   1   0  32  27

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            80   0  58  19  13   0   30
b            32  88  21  16   5   0   38
c            74   0  70   5  41   0   10
d            70   1  55  29  19   1   25
e            67   0  64  12  46   0   11
f            64   1  67  19  39   0   10
g            18   0   4  32   1  27  118

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  0  0.152381
b                  4  0.435644
c                  2  0.149254
d                  0  0.130841
e                  3  0.144654
f                  2  0.141949
g                  1  0.364198

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               a  0.152381
1               g  0.364198
2               c  0.149254
3               e  0.144654
4               b  0.435644
5               g  0.106667
6               g  0.134328

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
0                     a  0.152381
4                     b  0.435644
2                     c  0.149254
5                     d  0.095710
3                     e  0.144654
6                     f  0.000000
1                     g  0.364198
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Hierarchical.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Hierarchical.png
prot_bert_embeddings
Similarity.Geodesic_Clustering.Kmeans
ARI = 0.0787
NMI = 0.1470
Jaccard macro (true → best cluster) = 0.1944
Jaccard macro (cluster → best true) = 0.2099
Jaccard macro (Hungarian-aligned pairs) = 0.1891
Mapping-based clustering accuracy = 0.2943

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.198   0.260 0.225      200
b      0.364   0.390 0.377      200
c      0.206   0.350 0.260      200
d      0.181   0.160 0.170      200
e      0.312   0.250 0.278      200
f      0.219   0.140 0.171      200
g      0.850   0.510 0.637      200

Contingency table (true x pred):
pred    0   1   2   3   4   5   6
true                             
a       5  12  41  20   9  61  52
b       6   6  78  19   7  49  35
c       0  34   9   6  37  70  44
d       7  16  26  32  21  54  44
e       0  31  14  12  50  55  38
f       0  28  34  21  36  41  40
g     102   1  12  67   0   9   9

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            52  41  61  20   9  12    5
b            35  78  49  19   7   6    6
c            44   9  70   6  37  34    0
d            44  26  54  32  21  16    7
e            38  14  55  12  50  31    0
f            40  34  41  21  36  28    0
g             9  12   9  67   0   1  102

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  5  0.127615
b                  2  0.232143
c                  5  0.149254
d                  5  0.111340
e                  4  0.161290
f                  4  0.111111
g                  0  0.467890

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.467890
1               c  0.115646
2               b  0.232143
3               g  0.216129
4               e  0.161290
5               c  0.149254
6               a  0.126829

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
6                     a  0.126829
2                     b  0.232143
5                     c  0.149254
3                     d  0.092754
4                     e  0.161290
1                     f  0.093333
0                     g  0.467890
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Kmeans.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Kmeans.png
prot_bert_embeddings
Similarity.Geodesic_Clustering.Spectral
ARI = 0.1200
NMI = 0.1983
Jaccard macro (true → best cluster) = 0.2565
Jaccard macro (cluster → best true) = 0.2509
Jaccard macro (Hungarian-aligned pairs) = 0.2390
Mapping-based clustering accuracy = 0.3529

Per-class metrics (after mapping):
   precision  recall    f1  support
a      0.201   0.375 0.261      200
b      0.852   0.460 0.597      200
c      0.233   0.170 0.197      200
d      0.185   0.155 0.168      200
e      0.302   0.320 0.311      200
f      0.349   0.405 0.375      200
g      0.731   0.585 0.650      200

Contingency table (true x pred):
pred   0   1   2   3   4   5    6
true                             
a     21  54  14  75   2  21   13
b     22  16   8  38  92   9   15
c      6  18  34  78   1  62    1
d     31  33  19  73   5  27   12
e     12  13  35  69   5  64    2
f     24  81  34  29   3  29    0
g     52  17   2  12   0   0  117

Contingency after mapping (true x pred_mapped):
pred_mapped   a   b   c   d   e   f    g
true                                    
a            75   2  14  21  21  54   13
b            38  92   8  22   9  16   15
c            78   1  34   6  62  18    1
d            73   5  19  31  27  33   12
e            69   5  35  12  64  13    2
f            29   3  34  24  29  81    0
g            12   0   2  52   0  17  117

Best predicted cluster for each true class (by Jaccard):
   best_pred_cluster   jaccard
a                  3  0.150301
b                  4  0.425926
c                  5  0.177143
d                  3  0.145709
e                  5  0.183908
f                  1  0.230769
g                  6  0.481481

Best true class for each predicted cluster (by Jaccard):
  best_true_class   jaccard
0               g  0.164557
1               f  0.230769
2               e  0.112540
3               c  0.157258
4               b  0.425926
5               e  0.183908
6               g  0.481481

Hungarian alignment: Jaccard for each matched (pred_cluster → true_class) pair:
             true_class   jaccard
pred_cluster                     
3                     a  0.150301
4                     b  0.425926
2                     c  0.108974
0                     d  0.091988
5                     e  0.183908
1                     f  0.230769
6                     g  0.481481
[saved] ./data/confusion_matrix_Similarity.Geodesic_Clustering.Spectral.png
[saved] ./data/pairwise_jaccard_Similarity.Geodesic_Clustering.Spectral.png
